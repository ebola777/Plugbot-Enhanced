define("plugbot/controllers/module",["angular"],function(t){return t.module("app.controllers",[])}),define("plugbot/controllers/MainCtrl",["plugbot/controllers/module"],function(t){t.controller("MainCtrl",["$scope","Settings","SiteApi",function(t,n,e){var i=n.read().main;t.items=[{id:"autoWoot",text:"Auto Woot",click:function(t){e.autoWoot(t)}},{id:"autoJoin",text:"Auto Join",click:function(t){e.autoJoin(t)}}],t.isEnabled=function(t){return i[t.id]},t.switchEnabled=function(t){var e=!i[t.id];t.click&&t.click(e),i[t.id]=e,n.save()},t.handleButtonClick=function(){return"toggle"},_.each(t.items,function(t){t.click(i[t.id])})}])}),define("plugbot/controllers/SettingsCtrl",["plugbot/controllers/module"],function(t){t.controller("SettingsCtrl",["$scope","$window","Settings",function(t,n,e){t.items=[{text:"Reset Settings",click:function(){n.confirm("Reset Settings?\nPlease Reload the Page Immediately after Resetting.")&&e.reset()}}],t.handleButtonClick=function(){return"hide"}}])}),define("plugbot/controllers/index",["plugbot/controllers/MainCtrl","plugbot/controllers/SettingsCtrl"],_.identity),define("plugbot/directives/module",["angular"],function(t){return t.module("app.directives",[])}),define("plugbot/directives/draggable",["plugbot/directives/module","angular"],function(t,n){t.directive("draggable",["$document","$window","DomGeometry","Settings",function(t,e,i,o){return{restrict:"A",scope:{dragGrid:"&"},controller:["$scope",function(t){t.settings=o.read(),t.saveSettings=function(){o.save()}}],link:function(o,a,r){function l(){var t=C.iframe,n=t.css("pointer-events");t.css("pointer-events","none"),k.originalPointerEvents=n}function d(){var t=C.iframe;t.css("pointer-events",k.originalPointerEvents)}function s(){C.id&&k.currentPosition&&(I[C.id]=k.currentPosition,o.saveSettings())}function c(t){a.css("z-index",t)}function u(t,n){var e=n.outerWidth(),i=n.outerHeight();return{left:t.x,top:t.y,right:t.x+e,bottom:t.y+i,width:e,height:i}}function g(t){var n,e,o,r=C.containment,l={x:t.x,y:t.y};return C.grid&&(l.x-=l.x%C.grid[0],l.y-=l.y%C.grid[1]),_.each(C.snap,function(t){var n=i.getSnap(t,u(l,a),C.snapMode,C.snapTolerance);(n.x||n.y)&&(l.x+=n.x,l.y+=n.y)}),r.length&&(n=u(l,a),e=i.isContain(r,n),e.x&&e.y||(o=i.getRestraint(r,n),e.x||(l.x=o.left),e.y||(l.y=o.top))),l}function p(t){var n=!0,e=u(t,a),o=C.containment;return o.length&&(n=i.isContain(o,e)),n&&_.each(C.elemNoOverlap,function(t){n&&(n=!i.isIntersect(t,e))}),n}function f(t){k.currentPosition=t,a.css({left:t.x,top:t.y})}function m(t){var n=g(t);p(n)&&f(n)}function h(){o.$apply(function(){var t,n,e;C.keepZoom&&(t={width:R.width(),height:R.height()},n={width:t.width/k.originalWindowSize.width,height:t.height/k.originalWindowSize.height},e={x:k.currentPosition.x*n.width,y:k.currentPosition.y*n.height},p(e)&&f(e),k.originalWindowSize=t)})}function v(){o.$apply(function(){var t=k.currentMouseOffset,n={x:R.scrollLeft()-S.x,y:R.scrollTop()-S.y},e={x:w.x+t.x+n.x,y:w.y+t.y+n.y};k.currentScrollOffset=n,m(e)})}function b(t){var n=k.currentScrollOffset,e={x:t.clientX-y.x,y:t.clientY-y.y},i={x:w.x+e.x+n.x,y:w.y+e.y+n.y};return k.currentMouseOffset=e,m(i),!1}function x(){c(k.originalZIndex),d(),s(),R.unbind("scroll",v),t.unbind("mousemove",b),t.unbind("mouseup",x)}var w,y,S,C,k,I=o.settings.window,R=n.element(e),$=a.find(r.dragHandle)||a;a.css({position:"absolute"}),C={id:r.dragId,zIndex:r.dragZIndex,containment:n.element(r.dragContainment),containmentTolerance:r.dragContainmentTolerance,iframe:n.element(r.dragIframeFix),grid:o.dragGrid(),snap:n.element(r.dragSnap),snapMode:r.dragSnapMode,snapTolerance:r.dragSnapTolerance||8,elemNoOverlap:n.element(r.dragNoOverlap),keepZoom:r.dragKeepZoom},k={originalWindowSize:{width:R.width(),height:R.height()}},I[C.id]&&p(I[C.id])&&f(I[C.id]),R.bind("resize",h),$.bind("mousedown",function(e){return w={x:a.prop("offsetLeft"),y:a.prop("offsetTop")},y={x:e.clientX,y:e.clientY},S={x:R.scrollLeft(),y:R.scrollTop()},_.extend(C,{containment:n.element(r.dragContainment),iframe:n.element(r.dragIframeFix),snap:n.element(r.dragSnap),elemNoOverlap:n.element(r.dragNoOverlap)}),_.extend(k,{currentMouseOffset:{x:0,y:0},currentScrollOffset:{x:0,y:0},currentPosition:void 0,originalZIndex:a.css("z-index"),originalPointerEvents:void 0}),c(C.zIndex),l(),R.bind("scroll",v),t.bind("mousemove",b),t.bind("mouseup",x),!1}),a.on("$destroy",function(){R.unbind("resize",h)})}}}])}),define("plugbot/directives/window",["plugbot/directives/module","angular"],function(t,n){t.directive("window",function(){return{restrict:"A",link:function(t,e,i){function o(t,i){var o=n.element(t.data("window-toggle"));o.length?o[i]():e[i]()}function a(e){t.$apply(function(){var i,a=n.element(e.target);t.handleButtonClick&&(i=t.handleButtonClick(a.data("window-id")),o(a,i))})}var r,l=e.find(".handle-buttons");i.window&&e[i.window](),l.length&&(r=l.children(),r.length&&r.bind("click",a)),e.on("$destroy",function(){r.unbind("click",a)})}}})}),define("plugbot/directives/index",["plugbot/directives/draggable","plugbot/directives/window"],_.identity),define("plugbot/services/module",["angular"],function(t){return t.module("app.services",[])}),define("plugbot/services/utils/DomGeometry",["plugbot/services/module","angular"],function(t,n){t.factory("DomGeometry",["$window",function(t){return{isContainRect:function(t,n){var e={x:!1,y:!1};return t.left-n.left<=0&&n.right-t.right<=0&&(e.x=!0),t.top-n.top<=0&&n.bottom-t.bottom<=0&&(e.y=!0),e},isIntersectRect:function(t,n){return t.left-n.right<0&&n.left-t.right<0&&t.top-n.bottom<0&&n.top-t.bottom<0},isContain:function(t,n){var e=this.getBoundingRect(t),i=this.getBoundingRect(n);return this.isContainRect(e,i)},isIntersect:function(t,n){var e=this.getBoundingRect(t),i=this.getBoundingRect(n);return this.isIntersectRect(e,i)},getSnap:function(t,n,e,i){var o,a,r=this.getBoundingRect(t),l=this.getBoundingRect(n),d=["left","right"],s=["top","bottom"],c=[],u={x:0,y:0};for(("inner"===e||"both"===e)&&c.push([0,0],[1,1]),("outer"===e||"both"===e)&&c.push([0,1],[1,0]),o=0;o<c.length;o+=1)a=r[d[c[o][0]]]-l[d[c[o][1]]],Math.abs(a)<=i&&r.top<=l.bottom&&l.top<=r.bottom&&(u.x+=a),a=r[s[c[o][0]]]-l[s[c[o][1]]],Math.abs(a)<=i&&r.left<=l.right&&l.left<=r.right&&(u.y+=a);return u},getRestraint:function(t,n){var e=this.getBoundingRect(t),i=this.getBoundingRect(n),o=this.isContainRect(e,i),a=i;return o.x||(i.left<e.left?(a.left=e.left,a.right=e.left+i.width):(a.right=e.right,a.left=e.right-i.width)),o.y||(i.top<e.top?(a.top=e.top,a.bottom=e.top+i.height):(a.bottom=e.bottom,a.top=e.bottom-i.height)),a},offsetRect:function(t,n){n=_.clone(n),_.defaults(n,{x:0,y:0}),t.left+=n.x,t.right+=n.x,t.top+=n.y,t.bottom+=n.y},getBoundingRect:function(e){var i,o=n.element(t),a=["left","right","top","bottom","width","height"],r={x:o.scrollLeft(),y:o.scrollTop()};return e instanceof n.element?(i=_.pick(e[0].getBoundingClientRect(),a),this.offsetRect(i,r)):e instanceof HTMLElement?(i=_.pick(e.getBoundingClientRect(),a),this.offsetRect(i,r)):i=e,i}}}])}),define("plugbot/services/Export",["plugbot/services/module","angular"],function(t,n){t.factory("Export",["$window","Settings",function(t,e){t.plugbot={dev:{getSiteHighestZIndex:function(){var t=n.element("#audience, #dj-booth, #playback-container, #dj-button, #vote, .app-right"),e={element:null,zIndex:-1};return _.each(t,function(t){var i=n.element(t).css("z-index");i>e.zIndex&&(e={element:t,zIndex:i})}),e}},resetSettings:function(){e.reset()}}}])}),define("plugbot/services/DomInjection",["plugbot/services/module","angular"],function(t,n){t.factory("DomInjection",["$templateCache",function(t){var e=n.element("#app");e.append(t.get("main.tpl.html")),e.append(t.get("settings.tpl.html"))}])}),define("plugbot/services/Settings",["plugbot/services/module"],function(t){t.factory("Settings",["$window",function(t){var n,e="plugbotEnhanced",i=t.localStorage,o={main:{autoWoot:!0,autoJoin:!1},window:{main:{x:70,y:85},settings:{x:80,y:100}}};return{read:function(){var t;return n?t=n:(t=i[e]?JSON.parse(i[e]):this._clone(),n=t),t},save:function(){this._debounceSave()},reset:function(){delete i[e]},_debounceSave:_.debounce(function(){i[e]=JSON.stringify(n)},1e3),_clone:function(){return JSON.parse(JSON.stringify(o))}}}])}),define("plugbot/services/SiteApi",["plugbot/services/module","angular"],function(t,n){t.factory("SiteApi",["$interval","$window",function(t,e){var i,o,a=e.API,r=n.element("#woot");return{woot:function(){var n=this;this.stopWoot(),i=t(function(){var t=a.getUser().vote;0===t?r.click():n.stopWoot()},1e3)},join:function(){var n=this;this.stopJoin(),o=t(function(){var t=a.djJoin();t||n.stopJoin()},1e3)},stopWoot:function(){t.cancel(i)},stopJoin:function(){t.cancel(o)},autoWoot:function(t){t?(a.on(a.ADVANCE,this.woot,this),this.woot()):(a.off(a.ADVANCE,this.woot),this.stopWoot())},autoJoin:function(t){t?(a.on(a.WAIT_LIST_UPDATE,this.join,this),this.join()):(a.off(a.WAIT_LIST_UPDATE,this.join),this.stopJoin())},destroy:function(){this.autoWoot(!1),this.autoJoin(!1)}}}])}),define("plugbot/services/index",["plugbot/services/utils/DomGeometry","plugbot/services/Export","plugbot/services/DomInjection","plugbot/services/Settings","plugbot/services/SiteApi"],_.identity),angular.module("app.views",["main.tpl.html","settings.tpl.html"]),angular.module("main.tpl.html",[]).run(["$templateCache",function(t){t.put("main.tpl.html",'<div class="plugbot-window plugbot-main"\n     data-window\n     data-draggable\n     data-drag-id="main"\n     data-drag-z-index="1000000"\n     data-drag-containment="#app"\n     data-drag-iframe-fix="#yt-frame"\n     data-drag-handle=".handle"\n     data-drag-grid="[4, 4]"\n     data-drag-snap=".app-header, #audience, #dj-booth, #playback-container, #dj-button, #vote, .app-right, #footer"\n     data-drag-snap-mode="outer"\n     data-drag-snap-tolerance="8"\n     data-drag-no-overlap=".app-header, #footer"\n     data-drag-keep-zoom="true"\n     data-ng-controller="MainCtrl">\n    <div class="handle">\n        <span class="title">Plugbot</span>\n        <span class="handle-buttons">\n            <i class="icon icon-settings-white" data-window-id="settings" data-window-toggle=".plugbot-settings"></i>\n        </span>\n    </div>\n    <div class="body">\n        <ul>\n            <li class="item"\n                data-ng-class="{ \'enabled\': isEnabled(item) }"\n                data-ng-repeat="item in items"\n                data-ng-click="switchEnabled(item)">{{item.text}}</li>\n        </ul>\n    </div>\n</div>\n')}]),angular.module("settings.tpl.html",[]).run(["$templateCache",function(t){t.put("settings.tpl.html",'<div class="plugbot-window plugbot-settings"\n     data-window="hide"\n     data-draggable\n     data-drag-id="settings"\n     data-drag-z-index="1000000"\n     data-drag-containment="#app"\n     data-drag-iframe-fix="#yt-frame"\n     data-drag-handle=".handle"\n     data-drag-grid="[8, 8]"\n     data-drag-snap="#app"\n     data-drag-snap-mode="inner"\n     data-drag-snap-tolerance="16"\n     data-drag-no-overlap=".app-header, #footer"\n     data-drag-keep-zoom="true"\n     data-ng-controller="SettingsCtrl">\n    <div class="handle">\n        <span class="title">Settings</span>\n        <span class="handle-buttons">\n            <i class="icon icon-dialog-close" data-window-id="close"></i>\n        </span>\n    </div>\n    <div class="body">\n        <ul>\n            <li class="item"\n                data-ng-repeat="item in items"\n                data-ng-click="item.click()">{{item.text}}</li>\n        </ul>\n    </div>\n</div>\n')}]),define("plugbot/views/index",function(){}),define("plugbot/app",["angular","plugbot/controllers/index","plugbot/directives/index","plugbot/services/index","plugbot/views/index"],function(t){var n=t.module("app",["app.controllers","app.directives","app.services","app.views"]);return n.run(["DomInjection","Export",_.identity]),n}),require(["angular"],function(t){require(["domReady!","plugbot/app"],function(){t.bootstrap(t.element("#app"),["app"])})}),define("main",function(){});