/*
 * Copyright (C) 2011 by Yehuda Katz
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */

// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>

/*!
 * Copyright (C) 2013 by Plug DJ, Inc.
 */

define("ac785/bc190/b96e1",[],function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};return n.extend=function(n){function o(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s in n)i[s]=typeof n[s]=="function"&&typeof r[s]=="function"&&t.test(n[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,n[s]):n[s];return o.prototype=i,o.prototype.constructor=o,o.extend=arguments.callee,o},n}),define("ac785/bc190/cd0b8",["underscore","backbone"],function(e,t){var n;return window._$context?(n=window._$context,delete window._$context,n):(n=e.clone(t.Events),n.dispatch=function(e){this.trigger(e.type,e)},window._$context=n,n)}),define("ac785/f6dac/e9726",[],function(){function t(e){this._map=[],this.adopt(e)}var e=function(e,t){this.key=e,this.value=t};return e.prototype.key=null,e.prototype.value=null,e.prototype.is=function(e){return this.key===e},e.prototype.toString=function(){return this.key.toString()+":"+this.value.toString()},t.prototype._map=null,t.prototype.adopt=function(e){if(e)if(e instanceof t)e.each(this.addItem,this);else if(typeof e=="object")for(var n in e)this.addItem(n,e[n]);return this},t.prototype.addItem=function(t,n){var r;for(var i=0,s=this._map.length;i<s;i++){r=this._map[i];if(r.is(t))return r.value=n}return this._map.push(new e(t,n)),n},t.prototype.contains=function(e){for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];if(r.is(e))return!0}return!1},t.prototype.getItem=function(e){for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];if(r.is(e))return r.value}return null},t.prototype.removeItem=function(e){for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];if(r.is(e)){this._map.splice(t,1);break}}},t.prototype.removeAll=function(){this._map.length=0},t.prototype.count=t.prototype.length=function(){return this._map.length},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(e){if(e instanceof t)return this._map=e._map.slice(),this;throw new Error("Source must be a Dictionary object")},t.prototype.each=function(e,t){for(var n=0,r=this._map.length;n<r;n++){var i=this._map[n];e.call(t,i.value,i.key,n,this)}},t.prototype.sort=t.prototype.sortOnKeys=function(e){return typeof e!="function"&&(e=function(e,t){return e>t?1:t>e?-1:0}),this._map.sort(function(t,n){return e(t.key,n.key)}),this},t.prototype.sortOnValues=function(e){return typeof e!="function"&&(e=function(e,t){return e>t?1:t>e?-1:0}),this._map.sort(function(t,n){return e(t.value,n.value)}),this},t.prototype.map=function(e,n){var r=new t;for(var i=0,s=this._map.length;i<s;i++){var o=this._map[i];r.addItem(o.key,e.call(n,o.value,o.key,i,this))}return r},t.prototype.filter=function(e,n){var r=new t;for(var i=0,s=this._map.length;i<s;i++){var o=this._map[i],u=e.call(n,o.value,o.key,i,this);u&&r.addItem(o.key,o.value)}return r},t.prototype.keys=function(){var e=[];for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];e[t]=r.key}return e},t.prototype.values=function(){var e=[];for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];e[t]=r.value}return e},t.prototype.all=function(e,t){for(var n=0,r=this._map.length;n<r;n++){var i=this._map[n];if(!e.call(t,i.value,i.key,this))return!1}return!0},t.prototype.any=function(e,t){for(var n=0,r=this._map.length;n<r;n++){var i=this._map[n];if(e.call(t,i.value,i.key,this))return!0}return!1},t.prototype.subset=function(){var e=new t,n=Array.apply(null,arguments);for(var r=0,i=n.length;r<i;r++){var s=n[r];if(this.contains(s)){var o=this.getItem(s);o&&e.addItem(s,o)}}return e},t.prototype.toString=function(){var e=[];for(var t=0,n=this._map.length;t<n;t++){var r=this._map[t];e.push(r.toString())}return"{"+e.join(",")+"}"},t}),define("ac785/bc190/b8b17",["underscore","ac785/bc190/b96e1","ac785/f6dac/e9726","ac785/bc190/cd0b8"],function(e,t,n,r){var i=t.extend({init:function(){this.eventTypeMap={},this.commandClassMap=new n},mapEvent:function(t,n,i){t&&n&&i&&(this.eventTypeMap[t]||(this.eventTypeMap[t]=[]),e.contains(this.eventTypeMap[t],n)||(this.eventTypeMap[t].push(n),this.commandClassMap.addItem(n,i),this.eventTypeMap[t].length==1&&r.on(t,this.execute,this)))},unmapEvent:function(t,n,i){this.eventTypeMap[t]&&(this.eventTypeMap[t]=e.without(this.eventTypeMap[t],n),this.eventTypeMap[t].length==0&&(this.eventTypeMap[t]=undefined,this.commandClassMap.removeItem(n,i),r.off(t,this.execute,this)))},execute:function(t){var n=this;this.eventTypeMap[t.type]&&e.each(this.eventTypeMap[t.type],function(e){t instanceof n.commandClassMap.getItem(e)&&(new e(t)).execute()})}});return new i}),define("ac785/bc190/d22bb",["ac785/bc190/b96e1","ac785/bc190/cd0b8"],function(e,t){var n=e.extend({init:function(e){this.event=e},dispatch:function(e){t.dispatch(e)},trigger:function(){t.trigger.apply(t,arguments)},execute:function(){this.event=undefined,delete this.event}});return n}),function(){define("ac785/d94e0/b584a",["ac785/bc190/b96e1"],function(e){var t=e.extend({init:function(e){this.type=e}});return t.prototype.toString=function(){var e="";for(var t in this)t!="toString"&&t!="init"&&t!="constructor"&&t!="_super"&&t!="_name"&&(e+=t+"="+this[t]+", ");var n=this.__proto__;while(!n.constructor._name)n=n.__proto__;return"["+n.constructor._name+": "+e.substr(0,e.length-2)+"]"},t._name="Event",t})}(),define("ac785/d94e0/fb1a1",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r,i){this._super(e),this.title=t,this.message=n,this.action=r,this.forceAction=i}});return t._name="AlertEvent",t.ALERT="AlertEvent:alert",t.CONFIRM="AlertEvent:confirm",t}),define("ac785/d94e0/bd874",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.dialog=t}});return t._name="ShowDialogEvent",t.SHOW="ShowDialogEvent:show",t}),function(){var e={};(function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var n=Object.prototype.toString,r="[object Function]",i="[object Object]";e.registerHelper=function(t,r,s){if(n.call(t)===i){if(s||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else s&&(r.not=s),this.helpers[t]=r},e.registerPartial=function(t,r){n.call(t)===i?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(arguments.length===2)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var s=i.inverse||function(){},o=i.fn,u=n.call(t);return u===r&&(t=t.call(this)),t===!0?o(this):t===!1||t==null?s(this):u==="[object Array]"?t.length>0?e.helpers.each(t,i):s(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,n){if(e.logger.level<=t){var r=e.logger.methodMap[t];typeof console!="undefined"&&console[r]&&console[r].call(console,n)}}},e.log=function(t,n){e.logger.log(t,n)},e.registerHelper("each",function(t,i){var s=i.fn,o=i.inverse,u=0,a="",f,l=n.call(t);l===r&&(t=t.call(this)),i.data&&(f=e.createFrame(i.data));if(t&&typeof t=="object")if(t instanceof Array)for(var c=t.length;u<c;u++)f&&(f.index=u),a+=s(t[u],{data:f});else for(var h in t)t.hasOwnProperty(h)&&(f&&(f.key=h),a+=s(t[h],{data:f}),u++);return u===0&&(a=o(this)),a}),e.registerHelper("if",function(t,i){var s=n.call(t);return s===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn})}),e.registerHelper("with",function(t,i){var s=n.call(t);s===r&&(t=t.call(this));if(!e.Utils.isEmpty(t))return i.fn(t)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)});var s=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=new i.ProgramNode([],o[a]);break;case 3:this.$=new i.ProgramNode(o[a-2],o[a]);break;case 4:this.$=new i.ProgramNode(o[a-1],[]);break;case 5:this.$=new i.ProgramNode(o[a]);break;case 6:this.$=new i.ProgramNode([],[]);break;case 7:this.$=new i.ProgramNode([]);break;case 8:this.$=[o[a]];break;case 9:o[a-1].push(o[a]),this.$=o[a-1];break;case 10:this.$=new i.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 11:this.$=new i.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 12:this.$=o[a];break;case 13:this.$=o[a];break;case 14:this.$=new i.ContentNode(o[a]);break;case 15:this.$=new i.CommentNode(o[a]);break;case 16:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 17:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 18:this.$=o[a-1];break;case 19:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],o[a-2][2]==="&");break;case 20:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],!0);break;case 21:this.$=new i.PartialNode(o[a-1]);break;case 22:this.$=new i.PartialNode(o[a-2],o[a-1]);break;case 23:break;case 24:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 25:this.$=[[o[a-1]].concat(o[a]),null];break;case 26:this.$=[[o[a-1]],o[a]];break;case 27:this.$=[[o[a]],null];break;case 28:this.$=[[o[a]],null];break;case 29:o[a-1].push(o[a]),this.$=o[a-1];break;case 30:this.$=[o[a]];break;case 31:this.$=o[a];break;case 32:this.$=new i.StringNode(o[a]);break;case 33:this.$=new i.IntegerNode(o[a]);break;case 34:this.$=new i.BooleanNode(o[a]);break;case 35:this.$=o[a];break;case 36:this.$=new i.HashNode(o[a]);break;case 37:o[a-1].push(o[a]),this.$=o[a-1];break;case 38:this.$=[o[a]];break;case 39:this.$=[o[a-2],o[a]];break;case 40:this.$=[o[a-2],new i.StringNode(o[a])];break;case 41:this.$=[o[a-2],new i.IntegerNode(o[a])];break;case 42:this.$=[o[a-2],new i.BooleanNode(o[a])];break;case 43:this.$=[o[a-2],o[a]];break;case 44:this.$=new i.PartialNameNode(o[a]);break;case 45:this.$=new i.PartialNameNode(new i.StringNode(o[a]));break;case 46:this.$=new i.PartialNameNode(new i.IntegerNode(o[a]));break;case 47:this.$=new i.DataNode(o[a]);break;case 48:this.$=new i.IdNode(o[a]);break;case 49:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 50:this.$=[{part:o[a]}]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:return n.yytext="\\",14;case 1:n.yytext.slice(-1)!=="\\"&&this.begin("mu"),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1),this.begin("emu"));if(n.yytext)return 14;break;case 2:return 14;case 3:return n.yytext.slice(-1)!=="\\"&&this.popState(),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1)),14;case 4:return n.yytext=n.yytext.substr(0,n.yyleng-4),this.popState(),15;case 5:return 25;case 6:return 16;case 7:return 20;case 8:return 19;case 9:return 19;case 10:return 23;case 11:return 22;case 12:this.popState(),this.begin("com");break;case 13:return n.yytext=n.yytext.substr(3,n.yyleng-5),this.popState(),15;case 14:return 22;case 15:return 37;case 16:return 36;case 17:return 36;case 18:return 40;case 19:break;case 20:return this.popState(),24;case 21:return this.popState(),18;case 22:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\"/g,'"'),31;case 23:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\'/g,"'"),31;case 24:return 38;case 25:return 33;case 26:return 33;case 27:return 32;case 28:return 36;case 29:return n.yytext=n.yytext.substr(1,n.yyleng-2),36;case 30:return"INVALID";case 31:return 5}},e.rules=[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},emu:{rules:[3],inclusive:!1},com:{rules:[4],inclusive:!1},INITIAL:{rules:[0,1,2,31],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();e.Parser=s,e.parse=function(t){return t.constructor===e.AST.ProgramNode?t:(e.Parser.yy=e.AST,e.Parser.parse(t))},function(){e.AST={},e.AST.ProgramNode=function(t,n){this.type="program",this.statements=t,n&&(this.inverse=new e.AST.ProgramNode(n))},e.AST.MustacheNode=function(e,t,n){this.type="mustache",this.escaped=!n,this.hash=t;var r=this.id=e[0],i=this.params=e.slice(1),s=this.eligibleHelper=r.isSimple;this.isHelper=s&&(i.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.partialName=e,this.context=t},e.AST.BlockNode=function(t,n,r,i){var s=function(t,n){if(t.original!==n.original)throw new e.Exception(t.original+" doesn't match "+n.original)};s(t.id,i),this.type="block",this.mustache=t,this.program=n,this.inverse=r,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(t){this.type="ID";var n="",r=[],i=0;for(var s=0,o=t.length;s<o;s++){var u=t[s].part;n+=(t[s].separator||"")+u;if(u===".."||u==="."||u==="this"){if(r.length>0)throw new e.Exception("Invalid path: "+n);u===".."?i++:this.isScoped=!0}else r.push(u)}this.original=n,this.parts=r,this.string=r.join("."),this.depth=i,this.isSimple=t.length===1&&!this.isScoped&&i===0,this.stringModeValue=this.string},e.AST.PartialNameNode=function(e){this.type="PARTIAL_NAME",this.name=e.original},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.original=this.string=this.stringModeValue=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"},e.AST.CommentNode=function(e){this.type="comment",this.comment=e}}();var o=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(e){var t=Error.prototype.constructor.apply(this,arguments);for(var n=0;n<o.length;n++)this[o[n]]=t[o[n]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=/[&<>"'`]/g,i=/[&<>"'`]/,s=function(e){return t[e]||"&amp;"};e.Utils={extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():t==null||t===!1?"":(t=t.toString(),i.test(t)?t.replace(r,s):t)},isEmpty:function(e){return!e&&e!==0?!0:n.call(e)==="[object Array]"&&e.length===0?!0:!1}}}();var u=e.Compiler=function(){},a=e.JavaScriptCompiler=function(){};u.prototype={compiler:u,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||r.args.length!==i.args.length)return!1;for(var s=0;s<r.args.length;s++)if(r.args[s]!==i.args[s])return!1}t=this.children.length;if(e.children.length!==t)return!1;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t=e.statements,n;this.opcodes=[];for(var r=0,i=t.length;r<i;r++)n=t[r],this[n.type](n);return this.isSimple=i===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=this.classifyMustache(t);i==="helper"?this.helperMustache(t,n,r):i==="simple"?(this.simpleMustache(t),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.options.stringParams?(r.depth&&this.addDepth(r.depth),this.opcode("getContext",r.depth||0),this.opcode("pushStringParam",r.stringModeValue,r.type)):this.accept(r),this.opcode("assignToHash",n[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,n=this.classifyMustache(e);n==="simple"?this.simpleMustache(e):n==="helper"?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i,s)},simpleMustache:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,n){var r=this.setupFullMustacheParams(e,t,n),i=e.id.parts[0];if(this.options.knownHelpers[i])this.opcode("invokeKnownHelper",r.length,i);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+i);this.opcode("invokeHelper",r.length,i)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(t){this.options.data=!0;if(t.id.isScoped||t.id.depth)throw new e.Exception("Scoped data references are not supported: "+t.original);this.opcode("lookupData");var n=t.id.parts;for(var r=0,i=n.length;r<i;r++)this.opcode("lookup",n[r])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifyMustache:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type)):this[n.type](n)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}};var f=function(e){this.value=e};a.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":a.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,n,r,i){this.environment=t,this.options=n||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!r,this.context=r||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,n);var s=t.opcodes,o;this.i=0;for(p=s.length;this.i<p;this.i++)o=s[this.i],o.opcode==="DECLARE"?this[o.name]=o.value:this[o.opcode].apply(this,o.args);return this.createFunctionContext(i)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(n=n+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var n=this.stackVars.concat(this.registers.list);n.length>0&&(this.source[1]=this.source[1]+", "+n.join(", "));if(!this.isChild)for(var r in this.context.aliases)this.context.aliases.hasOwnProperty(r)&&(this.source[1]=this.source[1]+", "+r+"="+this.context.aliases[r]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");var i=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var s=0,o=this.environment.depths.list.length;s<o;s++)i.push("depth"+this.environment.depths.list[s]);var u=this.mergeSource();if(!this.isChild){var a=e.COMPILER_REVISION,f=e.REVISION_CHANGES[a];u="this.compilerInfo = ["+a+",'"+f+"'];\n"+u}if(t)return i.push(u),Function.apply(this,i);var l="function "+(this.name||"")+"("+i.join(",")+") {\n  "+u+"}";return e.log(e.logger.DEBUG,l+"\n\n"),l},mergeSource:function(){var e="",n;for(var r=0,i=this.source.length;r<i;r++){var s=this.source[r];s.appendToBuffer?n?n=n+"\n    + "+s.content:n=s.content:(n&&(e+="buffer += "+n+";\n  ",n=t),e+=s+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){this.flushInline();var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.push("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),typeof e=="string"?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=t,this.options.stringParams&&(this.register("hashContexts","{"+e.contexts.join(",")+"}"),this.register("hashTypes","{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(e,t,!0),r=this.nameLookup("depth"+this.lastContext,t,"context");this.push(n.name+" || "+r),this.replaceStack(function(e){return e+" ? "+e+".call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var n=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();this.source.push("if ("+s+" = "+r+") { "+s+" = "+s+".call("+n.callParams+"); }"),this.source.push("else { "+s+" = "+i+"; "+s+" = typeof "+s+" === functionType ? "+s+".apply(depth0) : "+s+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n,r;this.options.stringParams&&(r=this.popStack(),n=this.popStack());var i=this.hash;n&&i.contexts.push("'"+e+"': "+n),r&&i.types.push("'"+e+"': "+r),i.values.push("'"+e+"': ("+t+")")},compiler:a,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context),this.context.environments[u]=r):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return(n.length===0?"self.program(":"self.programWithDepth(")+i.join(", ")+")"},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new f(e))},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.source.push(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t="",n=this.isInline(),r;if(n){var i=this.popStack(!0);if(i instanceof f)r=i.value;else{var s=this.stackSlot?this.topStackName():this.incrStack();t="("+this.push(s)+" = "+i+"),",r=this.topStack()}}else r=this.topStack();var o=e.call(this,r);return n?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+t+o+")")):(/^stack/.test(r)||(r=this.nextStack()),this.source.push(r+" = ("+t+o+");")),r},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];r instanceof f?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();return!e&&n instanceof f?n.value:(t||this.stackSlot--,n)},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,n=t[t.length-1];return!e&&n instanceof f?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,n){var r=[];this.setupParams(e,r,n);var i=this.nameLookup("helpers",t,"helper");return{params:r,name:i,callParams:["depth0"].concat(r).join(", "),helperMissingParams:n&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupParams:function(e,t,n){var r=[],i=[],s=[],o,u,a;r.push("hash:"+this.popStack()),u=this.popStack(),a=this.popStack();if(a||u)a||(this.context.aliases.self="this",a="self.noop"),u||(this.context.aliases.self="this",u="self.noop"),r.push("inverse:"+u),r.push("fn:"+a);for(var f=0;f<e;f++)o=this.popStack(),t.push(o),this.options.stringParams&&(s.push(this.popStack()),i.push(this.popStack()));return this.options.stringParams&&(r.push("contexts:["+i.join(",")+"]"),r.push("types:["+s.join(",")+"]"),r.push("hashContexts:hashContexts"),r.push("hashTypes:hashTypes")),this.options.data&&r.push("data:data"),r="{"+r.join(",")+"}",n?(this.register("options",r),t.push("options")):t.push(r),t.join(", ")}};var l="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),c=a.RESERVED_WORDS={};for(var h=0,p=l.length;h<p;h++)c[l[h]]=!0;a.isValidJavaScriptVariableName=function(e){return!a.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},e.precompile=function(t,n){if(t==null||typeof t!="string"&&t.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);n=n||{},"data"in n||(n.data=!0);var r=e.parse(t),i=(new u).compile(r,n);return(new a).compile(i,n)},e.compile=function(n,r){function s(){var i=e.parse(n),s=(new u).compile(i,r),o=(new a).compile(s,r,t,!0);return e.template(o)}if(n==null||typeof n!="string"&&n.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+n);r=r||{},"data"in r||(r.data=!0);var i;return function(e,t){return i||(i=s()),i.call(this,e,t)}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?i=e.VM.program(t,n,r):i||(i=this.programs[t]=e.VM.program(t,n)),i},merge:function(t,n){var r=t||n;return t&&n&&(r={},e.Utils.extend(r,n),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,i){i=i||{};var s=t.call(n,e,r,i.helpers,i.partials,i.data),o=n.compilerInfo||[],u=o[0]||1,a=e.COMPILER_REVISION;if(u!==a){if(u<a){var f=e.REVISION_CHANGES[a],l=e.REVISION_CHANGES[u];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+f+") or downgrade your runtime to an older version ("+l+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return s}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i},program:function(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(n,r,i,s,o,u){var a={helpers:s,partials:o,data:u};if(n===t)throw new e.Exception("The partial "+r+" could not be found");if(n instanceof Function)return n(i,a);if(!e.compile)throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode");return o[r]=e.compile(n,{data:u!==t}),o[r](i,a)}},e.template=e.VM.template})(e),define("handlebars",[],function(){return e})}(),define("hbs!template/dialogs/DialogCancel",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="button cancel">\n    <span>',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\n</div>",s});return t.registerPartial("template_dialogs_DialogCancel",n),n}),define("hbs!template/dialogs/DialogCheckBox",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){return'checked="yes"'}function c(e,t){return'disabled="disabled"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="dialog-checkbox-container dialog-checkbox-container-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\r\n    <label for="dialog-checkbox-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'">',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+'</label>\r\n    <input id="dialog-checkbox-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'" type="checkbox" name="',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="checkbox" ',o=n["if"].call(t,t.checked,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.disabled,{hash:{},inverse:f.noop,fn:f.program(3,c,i)});if(o||o===0)s+=o;return s+="/>\r\n</div>",s});return t.registerPartial("template_dialogs_DialogCheckBox",n),n}),define("hbs!template/dialogs/DialogHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="dialog-frame">\r\n    <span class="title">',(o=n.title)?o=o.call(t,{hash:{}}):(o=t.title,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <i class="icon icon-dialog-close"></i>\r\n</div>',s});return t.registerPartial("template_dialogs_DialogHeader",n),n}),define("hbs!template/dialogs/DialogInputContainer",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="dialog-input-container">\r\n    <span class="dialog-input-label">',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <div class="dialog-input-background">\r\n        <input type="text" maxlength="',(o=n.maxlength)?o=o.call(t,{hash:{}}):(o=t.maxlength,o=typeof o===u?o.apply(t):o),s+=a(o)+'" placeholder="',(o=n.placeholder)?o=o.call(t,{hash:{}}):(o=t.placeholder,o=typeof o===u?o.apply(t):o),s+=a(o)+'" name="',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'" value="',(o=n.value)?o=o.call(t,{hash:{}}):(o=t.value,o=typeof o===u?o.apply(t):o),s+=a(o)+'"/>\r\n    </div>\r\n</div>',s});return t.registerPartial("template_dialogs_DialogInputContainer",n),n}),define("hbs!template/dialogs/DialogMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){return'disabled="disabled"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="dialog-menu-container dialog-menu-container-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\r\n    <label for="dialog-menu-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'">',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+'</label>\r\n    <select id="dialog-menu-',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'" ',o=n["if"].call(t,t.disabled,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;return s+="></select>\r\n</div>",s});return t.registerPartial("template_dialogs_DialogMenu",n),n}),define("hbs!template/dialogs/DialogMenuOption",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){return'selected="selected"'}function c(e,t){var r="",i;return r+='value="',(i=n.value)?i=i.call(e,{hash:{}}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;s+="<option ",o=n["if"].call(t,t.selected,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.value,{hash:{},inverse:f.noop,fn:f.program(3,c,i)});if(o||o===0)s+=o;return s+=">",(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+"</option>",s});return t.registerPartial("template_dialogs_DialogMenuOption",n),n}),define("hbs!template/dialogs/DialogSubmit",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="button submit">\n    <span>',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\n</div>",s});return t.registerPartial("template_dialogs_DialogSubmit",n),n}),define("hbs!template/dialogs/DialogTextArea",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="dialog-text-area-container">\r\n    <span class="dialog-text-area-label">',(o=n.label)?o=o.call(t,{hash:{}}):(o=t.label,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <textarea rows="',(o=n.rows)?o=o.call(t,{hash:{}}):(o=t.rows,o=typeof o===u?o.apply(t):o),s+=a(o)+'" cols="',(o=n.cols)?o=o.call(t,{hash:{}}):(o=t.cols,o=typeof o===u?o.apply(t):o),s+=a(o)+'" maxlength="',(o=n.maxlength)?o=o.call(t,{hash:{}}):(o=t.maxlength,o=typeof o===u?o.apply(t):o),s+=a(o)+'">',(o=n.value)?o=o.call(t,{hash:{}}):(o=t.value,o=typeof o===u?o.apply(t):o),s+=a(o)+"</textarea>\r\n</div>",s});return t.registerPartial("template_dialogs_DialogTextArea",n),n}),define("ac785/f6dac/ffe62",["jquery","underscore","backbone"],function(e,t,n){var r=t.clone(n.Events);return r.currentDialog=undefined,r.$window=e(window),r.PLAYLIST_OFFSET=150,r.MIN_WIDTH=1150,r.MIN_HEIGHT=638,r.CHAT_WIDTH=345,r.BAR_HEIGHT=54,r.BAR_WIDTH=r.CHAT_WIDTH+r.BAR_HEIGHT,r.resize=function(e){this.on("resize",e),this.onResize(undefined)},r.onResize=function(e){this.trigger("resize",r.getSize())},r.getSize=function(){var e=Math.max(r.MIN_WIDTH,r.$window.width()),t=Math.max(r.MIN_HEIGHT,r.$window.height()),n=t-r.BAR_HEIGHT-800;return n>r.BAR_HEIGHT&&(n=t-r.BAR_HEIGHT-800+Math.min(n,100)),{width:e,height:t,availWidth:e-r.CHAT_WIDTH,barHeight:r.BAR_HEIGHT,barWidth:e-r.BAR_WIDTH,bgTop:Math.min(r.BAR_HEIGHT,n)}},e(window).resize(t.bind(r.onResize,r)),r}),define("ac785/f6dac/ae2d1",["ac785/bc190/b96e1"],function(e){var t={relationship:function(e,t){if(e.get("relationship")>t.get("relationship"))return 1;if(e.get("relationship")<t.get("relationship"))return-1;var n=e.getTotalPoints(),r=t.getTotalPoints();return n>r?1:n<r?-1:0},username:function(e,t){return e.get("username").toLowerCase()>t.get("username").toLowerCase()?1:e.get("username").toLowerCase()<t.get("username").toLowerCase()?-1:0},permission:function(e,t){return e.get("permission")<t.get("permission")?1:e.get("permission")>t.get("permission")?-1:e.get("username").toLowerCase()>t.get("username").toLowerCase()?1:e.get("username").toLowerCase()<t.get("username").toLowerCase()?-1:0},lookup:function(e,t){return e.username.toLowerCase()>t.username.toLowerCase()?1:e.username.toLowerCase()<t.username.toLowerCase()?-1:0},timestamp:function(e){return-e.get("timestamp")}};return t}),define("ac785/ca252/bed74",["backbone","ac785/ca252/a1027","ac785/f6dac/ae2d1"],function(e,t,n){var r=e.Collection.extend({model:t,comparator:n.permission,initialize:function(){this.on("change:permission",this.onPermissionChange,this)},onPermissionChange:function(){this.sort()}});return new r}),define("ac785/f6dac/d4236",["ac785/bc190/b96e1","ac785/f6dac/ae2d1"],function(e,t){var n=e.extend({init:function(){this.hash={}},add:function(e){var t=e.get("username");this.remove(t);var n=t.charAt(0).toLowerCase();this.hash[n]||(this.hash[n]=[],this.hash[n].longest=0),this.hash[n].push({avatarID:e.get("avatarID"),username:t}),t.length>this.hash[n].longest&&(this.hash[n].longest=t.length)},remove:function(e){var t=e.charAt(0).toLowerCase();if(this.hash[t]){var n=this.hash[t].length;while(n--)this.hash[t][n].username==e&&(this.hash[t].splice(n,1),this.hash[t].length==0&&delete this.hash[t]);if(this.hash[t]){this.hash[t].longest=0,n=this.hash[t].length;while(n--)this.hash[t][n].username.length>this.hash[t].longest&&(this.hash[t].longest=this.hash[t][n].username.length)}}},lookup:function(e){var n=[],r=e.length;if(r>0&&r<24){var i=e.charAt(0).toLowerCase();if(this.hash[i]&&this.hash[i].length>0&&r<this.hash[i].longest){var s=this.hash[i].length;while(s--)this.hash[i][s].username.toLowerCase()!=e.toLowerCase()&&this.hash[i][s].username.toLowerCase().indexOf(e.toLowerCase())==0&&n.push(this.hash[i][s])}}return n.length=Math.min(n.length,10),n.sort(t.lookup),n}});return new n}),define("ac785/ca252/c512b",["backbone","ac785/ca252/bed74","ac785/f6dac/d4236"],function(e,t,n){var r=e.Model.extend({defaults:{admins:{},ambassadors:{},staff:{},boothCycle:undefined,boothLocked:undefined,custom:undefined,lounge:undefined,description:"",historyID:undefined,name:"",ownerID:"",ownerName:"",users:{},extraUsers:{},votes:{},curates:{},welcome:"",joined:!1,joinTime:Date.now()},getUserByID:function(e){return this.get("users")[e]||this.get("extraUsers")[e]},addUser:function(e,r){var i=e.get("id");if(!this.getUserByID(i)){var s=0;this.get("admins")[i]?s=10:this.get("ambassadors")[i]?s=this.get("ambassadors")[i]:this.get("ownerID")===i?s=5:this.get("staff")[i]&&(s=this.get("staff")[i]),e.set("permission",s),r?this.get("extraUsers")[i]=e:(this.get("users")[i]=e,t.add(e),n.add(e))}},removeUser:function(e){this.getUserByID(e)&&(n.remove(this.getUserByID(e).get("username")),t.remove(this.getUserByID(e)),this.get("users")[e]=undefined,delete this.get("users")[e])},updateStaff:function(e,t){t==0?(this.get("staff")[e.id]=undefined,delete this.get("staff")[e.id]):this.get("staff")[e.id]=t;var n=this.getUserByID(e.id);n&&n.get("permission")<6&&n.set("permission",t),t==5&&this.set({ownerID:e.id,ownerName:e.username})}});return new r}),define("lang/Lang",[],function(){var e=window.Lang;return window.Lang=undefined,delete window.Lang,e}),define("ac785/ca252/a1027",["underscore","backbone","ac785/ca252/c512b","lang/Lang"],function(e,t,n,r){var i=t.Model.extend({defaults:{id:"",username:"",avatarID:"",language:"en",curatorPoints:0,dateJoined:undefined,djPoints:0,listenerPoints:0,fans:0,curated:!1,status:0,permission:0,priority:0,relationship:0,vote:0,wlIndex:undefined,uIndex:undefined,_position:{c:0,r:0}},initialize:function(){this.on("change:avatarID change:permission",this.checkStaffAvatar,this)},hasPermission:function(e){if(this.get("permission")==i.ADMIN)return!0;var t=n.get("staff")[this.get("id")];if(t&&t>=e)return!0;var r=n.get("ambassadors")[this.get("id")];return r?e<6?r-5>=e:r>=e:!1},getTotalPoints:function(){return this.get("djPoints")+this.get("listenerPoints")+this.get("curatorPoints")},checkStaffAvatar:function(){i.STAFF_AVATAR&&this.get("permission")>0&&this.get("permission")<5?this.get("avatarID")!=n.get("id")&&this.set("oldAvatarID",this.get("avatarID"),{silent:!0}).set("avatarID",n.get("id")):this.get("oldAvatarID")&&this.set("avatarID",this.get("oldAvatarID")).set("oldAvatarID",undefined,{silent:!0})}});return i.ADMIN=10,i.LEADER=9,i.AMBASSADOR=8,i.VOLUNTEER=7,i.HOST=5,i.COHOST=4,i.MANAGER=3,i.BOUNCER=2,i.DJ=1,i.NONE=0,i.STATUSES=[r.userStatus.available,r.userStatus.away,r.userStatus.working,r.userStatus.gaming,r.userStatus.idle],i.STAFF_AVATAR=!1,i}),define("ac785/ca252/fae6c",["ac785/ca252/a1027"],function(e){var t=e.extend({initialize:function(){this.set({followers:{},following:{}}),this._super()},parse:function(e){var t=e.followers.length;while(t--)this.addFollower(e.followers[t]);t=e.following.length;while(t--)this.addFollowing(e.following[t]);this.set(e.profile)},getRelationship:function(e){return this.get("followers")[e]&&this.get("following")[e]?3:this.get("following")[e]?2:this.get("followers")[e]?1:0},addFollower:function(e){this.get("followers")[e]=!0},addFollowing:function(e){this.get("following")[e]=!0},removeFollowing:function(e){this.get("following")[e]=undefined,delete this.get("following")[e]},addFriend:function(e){this.addFollower(e),this.addFollowing(e)}});return new t}),define("ac785/f6dac/afc91",["ac785/bc190/b96e1"],function(e){var t=e.extend({init:function(){this.MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"],this.SERVER_TIME=null,this.OFFSET=0},setServerTime:function(e){this.SERVER_TIME=e,this.OFFSET=this.SERVER_TIME.getTime()-(new Date).getTime()},yearsSince:function(e){return this.ServerDate().getFullYear()-e.getFullYear()},monthsSince:function(e){var t=this.ServerDate();return(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth())},daysSince:function(e){var t=this.ServerDate(),n=t.getTime(),r=e.getTime(),i=864e5,s=(n-r)/i,o=(n-r)%i/i;return o>0&&o*i>this.secondsSinceMidnight(t)*1e3&&s++,~~s},hoursSince:function(e){return~~((this.ServerDate().getTime()-e.getTime())/36e5)},minutesSince:function(e){return~~((this.ServerDate().getTime()-e.getTime())/6e4)},secondsSince:function(e){return~~((this.ServerDate().getTime()-e.getTime())/1e3)},monthName:function(e,t){var n=this.MONTHS[e.getMonth()];return t?n:n.substr(0,3)},secondsSinceMidnight:function(e){var t=new Date(e.getTime());return this.midnight(t),~~((e.getTime()-t.getTime())/1e3)},midnight:function(e){e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)},minutesUntil:function(e){return~~((e.getTime()-this.ServerDate().getTime())/6e4)},millisecondsUntil:function(e){return e.getTime()-this.ServerDate().getTime()},ServerDate:function(){return new Date((new Date).getTime()+this.OFFSET)}});return new t}),define("ac785/f6dac/c1354",["ac785/bc190/b96e1"],function(e){var t=e.extend({init:function(){this.newSeed()},newSeed:function(){this.seed=~~(Math.random()*2147483646)},"double":function(){return this.gen()/2147483647},integer:function(e,t){return e-=.4999,t+=.4999,Math.round(e+(t-e)*this.double())},"float":function(e,t){return e+(t-e)*this.double()},gen:function(){return this.seed=this.seed*16807%2147483647}});return t}),define("ac785/f6dac/d17c3",["jquery","ac785/bc190/b96e1","ac785/ca252/fae6c","ac785/f6dac/afc91","ac785/f6dac/c1354","lang/Lang"],function(e,t,n,r,i,s){var o=t.extend({init:function(){this.Rndm=new i,this.$div=e("<div/>"),this.rxUser=/^[A-Za-z0-9_-]{3,24}$/},h2t:function(e){return this.$div.html(e).text()},commafy:function(e){return e=String(e),e.replace(/(^|[^\w.])(\d{4,})/g,function(e,t,n){return t+n.replace(/\d(?=(?:\d\d\d)+(?!\d))/g,"$&,")})},formatTime:_.memoize(function(e){if(isNaN(e))return"0:00";e=Math.ceil(e);var t,n,r=String(~~(e/60/60));r!="0"?(t=String(~~(e/60)-Number(r)*60),n=!0):t=String(~~(e/60)),t.length==1&&(t=(n?"0":"")+t);var i=String(e%60);return i.length==1&&(i="0"+i),r=="0"?t+":"+i:r+":"+t+":"+i}),formatTimeLeading:_.memoize(function(e){if(isNaN(e))return"00:00";e=Math.ceil(e);var t,n=String(~~(e/60/60));n!="0"?t=String(~~(e/60)-Number(n)*60):t=String(~~(e/60)),t.length==1&&(t="0"+t);var r=String(e%60);return r.length==1&&(r="0"+r),n=="0"?t+":"+r:n+":"+t+":"+r}),getSecondsElapsed:function(e){return!e||e=="0"?0:r.secondsSince(new Date(Number(e.substr(0,e.indexOf(",")))))},toHex:function(e){var t=e.toString(16).toUpperCase();return"0x"+String("00000000").substr(0,8-t.length)+t},convertNumberStringToUnixDateString:function(e){var t=e.split(","),n=new Date(Number(t[0])),r=t[1]||"0";r.length==10&&(r=r.substr(4));var i=String(n.getMonth()+1);i.length==1&&(i="0"+i);var s=String(n.getDate());s.length==1&&(s="0"+s);var o=String(n.getHours());o.length==1&&(o="0"+o);var u=String(n.getMinutes());u.length==1&&(u="0"+u);var a=String(n.getSeconds());return a.length==1&&(a="0"+a),i!="NaN"&&s!="NaN"&&o!="NaN"&&u!="NaN"&&a!="NaN"?n.getFullYear()+"-"+i+"-"+s+" "+o+":"+u+":"+a+"."+r:"0"},convertUnixDateStringToNumberString:function(e){try{if(e){var t=new Date(e.substr(0,4),Number(e.substr(5,2))-1,e.substr(8,2),e.substr(11,2),e.substr(14,2),e.substr(17,2)),n=String(t.getTime()),r="000000",i=e.substr(20,6);return r=r.substr(i.length,6)+i,n+",0000"+r}}catch(s){console.log("ConvertUnixDate",s)}return"0"},convertUnixDateStringToDate:function(e){return e?new Date(e.substr(0,4),Number(e.substr(5,2))-1,e.substr(8,2),e.substr(11,2),e.substr(14,2),e.substr(17,2)):null},convertDateToNumberString:function(e){if(!e)return"0";var t=String(e.getMonth()+1);t.length==1&&(t="0"+t);var n=String(e.getDate());n.length==1&&(n="0"+n);var r=String(e.getHours());r.length==1&&(r="0"+r);var i=String(e.getMinutes());i.length==1&&(i="0"+i);var s=String(e.getSeconds());return s.length==1&&(s="0"+s),e.getFullYear()+"-"+t+"-"+n+" "+r+":"+i+":"+s+".000000"},getSimpleTimestamp:function(){return this.convertDateToNumberString(new Date).split(".").shift().split(" ").pop()},getChatTimestamp:function(e){var t=new Date,n=t.getHours(),r=String(t.getMinutes());r.length==1&&(r="0"+r);var i;if(e)n<10&&(n="0"+n),i=n+":"+r;else{var s="am";n>12?(n-=12,s="pm"):n==0&&(n=12),i=n+":"+r+s}return i},convertChatTimestamp:function(e,t){var n=e.indexOf("am")>-1||e.indexOf("pm")>-1,r;if(t=="24"&&n)return r=e.split(":")[0],e.indexOf("pm")>-1&&(r=parseInt(r)+12),r+":"+e.substr(0,e.length-2).split(":")[1];if(t=="12"&&!n){r=parseInt(e.split(":")[0]);var i="am";return r>12&&(i="pm",r-=12),r+":"+e.split(":")[1]+i}return e},convertTimestampToReadableDate:function(e,t){if(!e)return"";var i=Number(e.split(",")[0]),o=new Date(i),u=r.monthsSince(o),a=r.daysSince(o),f="",l=n.get("language")!="ja"&&n.get("language").indexOf("zh")==-1?" ":"";if(u>1||u==1&&a>=30)return u>1?f=s.history.months:f=s.history.month,f=u+l+f,t?s.history.ago.split("%TIME%").join(f):f;var c=r.hoursSince(o);if(a>1||a==1&&c>=24)return a>1?f=s.history.days:f=s.history.day,f=a+l+f,t?s.history.ago.split("%TIME%").join(f):f;var h=r.minutesSince(o);if(c>1||c==1&&h>=60)return c>1?f=s.history.hours:f=s.history.hour,f=c+l+f,t?s.history.ago.split("%TIME%").join(f):f;var p=Math.max(r.secondsSince(o),0);return h>1||h==1&&p>=60?(h>1?f=s.history.minutes:f=s.history.minute,f=h+l+f,t?s.history.ago.split("%TIME%").join(f):f):(p>1?f=s.history.seconds:f=s.history.second,f=p+l+f,t?s.history.ago.split("%TIME%").join(f):f)},convertNumberStringToMDY:function(e,t){var n=e?this.convertUnixDateStringToDate(e):new Date(2011,1,29),r=n.getUTCMonth()+1,i=n.getUTCDate(),s=n.getUTCFullYear();return t.split("MM").join(r).split("DD").join(i).split("YYYY").join(s)},validateIncomingURL:function(e){if(e){var t;return e.indexOf("youtube.com")>-1&&e.indexOf("v=")>-1?t=this.cleanYouTubeURL(e):e.indexOf("youtu.be")>-1?t=this.cleanYouTubeURL("http://www.youtube.com/watch?v="+e.split("/").pop()):e.indexOf("soundcloud.com")>-1&&(t=e),t?t.indexOf("#")==-1?t:String(t.split("#")[0]):null}return null},cleanYouTubeURL:function(e){return e.replace(/(.+?)[\#\!|\?].*?v=(.+?)(\&.*|\Z)/,"$1?v=$2")},cleanString:function(e){return e.replace(/[\u25c4]/g,"")},cleanTypedString:function(e){return e.split("<").join("&lt;").split(">").join("&gt;")},authorTitle:function(e){if(e){var t="",n=e,r=e.indexOf(" - ");if(r>-1)t=e.substr(0,r),n=e.substr(r+3);else{r=e.indexOf("-");if(r>-1)t=e.substr(0,r),n=e.substr(r+1);else{r=e.indexOf(' "');if(r>-1){var i=e.indexOf('"',r+2);i>-1&&(t=e.substr(0,r),n=e.substring(r+2,i))}}}return t=this.cleanString(t),n=this.cleanString(n),{author:t,title:n}}return{author:null,title:null}},clone:function(e){var t={};for(var n in e)t[n]=e[n];return t},deserializeModified:function(e){e.modified=this.convertUnixDateStringToNumberString(e.modified)},deserializeHistoryItem:function(e){e.timestamp=this.convertUnixDateStringToNumberString(e.timestamp),e.cid=e.id},serializeMediaItems:function(e){var t=[],n=e.length,r={};for(var i=0;i<n;++i)e[i].get("id").indexOf(":")>-1?r[e[i].get("id")]||(r[e[i].get("id")]=!0,t.push(e[i].get("id"))):t.push({id:0,format:e[i].get("format"),cid:e[i].get("cid"),author:e[i].get("author"),title:e[i].get("title"),image:e[i].get("image"),duration:e[i].get("duration")});return t},quadEaseOut:function(e,t,n,r){return e/=r,-n*e*(e-2)+t},quadEaseIn:function(e,t,n,r){return e/=r,n*e*e+t},randomizeArray:function(e){var t=[].concat(e);this.Rndm.newSeed();try{var n=t.length-1,r=n+1;while(--r){var i=this.Rndm.integer(0,r+1);i>n&&(i=n);var s=t[r],o=t[i];t[r]=o,t[i]=s}return t}catch(u){return this.randomizeArray(e)}},hexToRGB:_.memoize(function(e){e[0]=="#"&&(e=e.substr(1));if(e.length==3){var t=e;e="",t=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(t).slice(1);for(var n=0;n<3;n++)e+=t[n]+t[n]}var r=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(e).slice(1);return{red:parseInt(r[0],16),green:parseInt(r[1],16),blue:parseInt(r[2],16)}}),pointWithinRect:function(e,t){return this._pointWithinRect(e.x,e.y,t.x,t.y,t.w,t.h)},_pointWithinRect:function(e,t,n,r,i,s){return e>=n&&t>=r&&e<n+i&&t<=r+s},forceRefresh:function(){window.location.reload()},getParameterByName:function(e){var t=(new RegExp("[\\?&]"+e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)")).exec(window.location.search);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))},isValidUsername:function(e){return this.rxUser.test(e)}});return new o}),define("ac785/abf10/d9a0c/fbb95",["jquery","underscore","backbone","hbs!template/dialogs/DialogCancel","hbs!template/dialogs/DialogCheckBox","hbs!template/dialogs/DialogHeader","hbs!template/dialogs/DialogInputContainer","hbs!template/dialogs/DialogMenu","hbs!template/dialogs/DialogMenuOption","hbs!template/dialogs/DialogSubmit","hbs!template/dialogs/DialogTextArea","ac785/bc190/cd0b8","ac785/f6dac/ffe62","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=n.View.extend({initialize:function(){this.onKeyDownBinding=t.bind(this.onKeyDownHandler,this),this.resizeBind=t.bind(this.onResize,this),this.closeBind=t.bind(this.close,this)},dispatch:function(e){c.dispatch(e)},submit:function(){},onKeyDownHandler:function(e){var t;if(!e)return!0;t=e.which||e.keyCode;if(this.importing)return!0;if(t==13){if(!this.onKeyEnter(e))return!1}else{if(t==27)return this.onKeyEscape(e);this.onKeyCustom(e)}return!0},onKeyEnter:function(e){return e.preventDefault(),this.submit(),!1},onKeyEscape:function(e){return e.stopPropagation(),e.preventDefault(),this.close(),!1},onKeyCustom:function(e){},getHeader:function(n){var r=e(s({title:n}));return r.find(".icon-dialog-close").click(t.bind(this.close,this)),r},getBody:function(){return e("<div/>").addClass("dialog-body")},getButtons:function(t,n){var r=e("<div/>").addClass("dialog-frame");return n&&r.append(this.getCancelButton()),t&&r.append(this.getSubmitButton(t)),r},getCancelButton:function(){return e(r({label:d.dialog.cancel})).click(t.bind(this.close,this))},getSubmitButton:function(n){return e(f({label:n})).click(t.bind(this.submit,this))},getInputField:function(t,n,r,i,s,u){var a=e(o({name:t,label:n,placeholder:r,value:i,maxlength:s,disabled:u}));return a.find("input").keydown(this.onKeyDownBinding),a},getTextArea:function(t,n,r,i,s,o){var u=e(l({name:t,label:n,value:r,rows:i,cols:s,maxlength:o}));return u.find("textarea").keyup(function(){var t=parseInt(e(this).attr("maxlength"));e(this).val().length>t&&e(this).val(e(this).val().substr(0,e(this).attr("maxlength")))}),u},getCheckBox:function(t,n,r,s){return e(i({label:t,name:n,checked:r,disabled:s}))},getMenu:function(t,n,r,i,s){var o="",f=r.length;for(var l=0;l<f;++l)r[l].hasOwnProperty("label")?o+=a({selected:i==r[l].value,value:r[l].value,label:r[l].label}):o+=a({selected:i==r[l],label:r[l]});var c=e(u({label:t,name:n,disabled:s}));return c.find("select").append(o),c},getMessage:function(e){return'<span class="message">'+e+"</span>"},show:function(){e(document).on("keydown",this.onKeyDownBinding),e(".modal-background").on("click",this.closeBind),h.currentDialog=this,h.resize(this.resizeBind)},close:function(){e(".modal-background").off("click",this.closeBind),e(document).off("keydown",this.onKeyDownBinding),this.onKeyDownBinding=undefined,h.currentDialog=undefined,h.off("resize",this.resizeBind),this.$el.empty(),this.trigger("close")},remove:function(){this._super(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},render:function(){return this.show(),this},onResize:function(e){e=e||h.getSize(),this.$el.css("left",(e.width-this.$el.width())/2).css("top",(e.height-this.$el.height())/2)}});return v}),define("ac785/abf10/d9a0c/f65e3",["underscore","ac785/d94e0/b584a","ac785/abf10/d9a0c/fbb95","lang/Lang"],function(e,t,n,r){var i=n.extend({id:"dialog-alert",className:"dialog",render:function(){return this.$el.append(this.getHeader(this.options.title||r.dialog.alert)).append(this.getBody().append(this.getMessage(this.options.message))).append(this.getButtons(r.dialog.ok)),e.defer(e.bind(this.adjustTop,this)),this._super()},adjustTop:function(){this.$(".dialog-body .message").css("top",(this.$(".dialog-body").height()-this.$(".dialog-body .message").height())/2)},submit:function(){this.doAction(),this.close()},doAction:function(){this.options.action&&(this.options.action instanceof t?this.dispatch(this.options.action):e.isFunction(this.options.action)&&this.options.action(),this.options.forceAction=!1)},close:function(){this.options.forceAction&&this.doAction(),this.options.message=undefined,this.options.action=undefined,this.options.title=undefined,this.options.forceAction=undefined,this._super()},onKeyEnter:function(e){return e.preventDefault(),this.submit(),!1}});return i}),define("ac785/abf10/d9a0c/ada1c",["underscore","ac785/d94e0/b584a","ac785/abf10/d9a0c/fbb95"],function(e,t,n){var r=n.extend({id:"dialog-confirm",className:"dialog destructive",render:function(){return this.$el.append(this.getHeader(this.options.title)).append(this.getBody().append(this.getMessage(this.options.message))).append(this.getButtons(this.options.title,!0)),e.defer(e.bind(this.adjustTop,this)),this._super()},adjustTop:function(){this.$(".dialog-body .message").css("top",(this.$(".dialog-body").height()-this.$(".dialog-body .message").height())/2)},submit:function(){this.doAction(),this.close()},doAction:function(){this.options.action&&(this.options.action instanceof t?this.dispatch(this.options.action):e.isFunction(this.options.action)&&this.options.action())},close:function(){this.options.message=undefined,this.options.action=undefined,this.options.title=undefined,this._super()}});return r}),define("ac785/b1ca1/ef8bb",["ac785/bc190/d22bb","ac785/d94e0/fb1a1","ac785/d94e0/bd874","ac785/abf10/d9a0c/f65e3","ac785/abf10/d9a0c/ada1c"],function(e,t,n,r,i){var s=e.extend({execute:function(){this.event.type===t.ALERT?this.dispatch(new n(n.SHOW,new r({title:this.event.title,message:this.event.message,action:this.event.action,forceAction:this.event.forceAction}))):this.event.type===t.CONFIRM&&this.dispatch(new n(n.SHOW,new i({title:this.event.title,message:this.event.message,action:this.event.action}))),this._super()}});return s}),define("ac785/bc190/fea39",["ac785/bc190/d22bb","ac785/f6dac/e9726"],function(e,t){var n=e.extend({init:function(e){this._super(e),n.commands.addItem(this,!0)},finish:function(){this.event=undefined,delete this.event,n.commands.removeItem(this)}});return n.commands=new t,n}),define("ac785/ca252/d46ba",["backbone"],function(e){var t=e.Model.extend({defaults:{id:undefined,selected:!1,available:!1,required:0}});return t}),define("ac785/ca252/a9a95",["underscore","backbone","ac785/ca252/d46ba","ac785/ca252/fae6c","ac785/ca252/a1027"],function(e,t,n,r,i){var s=t.Collection.extend({model:n,initialize:function(){this.audience={w:150,h:150,sw:1650},this.booth={w:150,h:205,sw:1650},this.dj={w:170,h:220,sw:1870},this.__generate();var t={};this.each(function(e){t[e.get("id")]=!0}),this.valid=t,this.valid.su01=!0,this.valid.su02=!0,this.valid.tastycat=!0,this.valid.tastycat02=!0,this.availBind=e.bind(this.onCheckAvailable,this),r.on("change:listenerPoints change:curatorPoints change:djPoints",this.onPointsChange,this),this.userPoints=0},onPointsChange:function(e){var t=r.getTotalPoints();if(this.userPoints!==t||!e)this.userPoints=t,this.updateAvailable()},updateAvailable:function(){this.each(this.availBind)},onCheckAvailable:function(e){e.set("available",r.hasPermission(i.AMBASSADOR)||this.userPoints>=e.get("required"))},setSelected:function(e){var t=this.find(function(e){return e.get("selected")}),n=this.find(function(t){return t.get("id")==e});n&&n.get("available")?(t&&t.get("id")!=n.get("id")&&t.set("selected",!1),n.set("selected",!0),r.set("avatarID",e)):r.hasPermission(i.ADMIN)&&(t&&t.set("selected",!1),r.set("avatarID",e))},__generate:function(){var e={required:0},t={required:100},r={required:300},i={required:700},s={required:1500},o={required:3e3},u={required:7e3},a={required:15e3};e.avatars=["animal08","animal05","animal06","animal02","animal09"],t.avatars=["animal01","animal10","animal11","animal14","animal13"],r.avatars=["monster01","monster04","monster02","monster05","monster03"],i.avatars=["animal12","animal03","animal04","animal07"],s.avatars=["lucha01","lucha02","lucha04","lucha07","lucha08","lucha05","lucha03","lucha06"],o.avatars=["space01","space02","space03","space06"],u.avatars=["space04","space05"],a.avatars=["warrior01","warrior02","warrior03","warrior04"];var f=[e,t,r,i,s,o,u,a],l=f.length,c=[];for(var h=0;h<l;h++){var p=f[h],d=p.avatars.length;for(var v=0;v<d;v++)c.push(new n({id:p.avatars[v],required:p.required}))}this.reset(c)}});return new s}),define("ac785/c3562/d4511",[],function(){var e=function(e){this.url=e,this.url.charAt(this.url.length-1)!="/"&&(this.url+="/")};return e.prototype.execute=function(e,t){var n=Array.prototype.slice.call(arguments).slice(2);$.ajax({url:this.url+e.replace(/\//g,"_"),type:"POST",data:JSON.stringify({service:e,body:n}),async:this.async,dataType:"json",contentType:"application/json",success:function(e,n,r){if(e.status==999){if(!t){console.log("RPC returned a fault status but there was no responder",e);return}t.onFault(e.body);return}if(!t)return;t.onResult({status:e.status,data:e.body})},error:function(e,n,r){console.log(e),console.log(n),console.log(r);if(!t)return;t.onStatusError(e.status)}})},new e("/_/gateway/")}),define("ac785/e734f/cae73",["underscore","ac785/bc190/b96e1"],function(e,t){var n=t.extend({init:function(){this.queue=[],this.count=0,this.timeoutID=0,this.startTime=0},reset:function(){var e=this.queue.length;while(e--)this.queue[e].queueCallback=undefined;this.queue=[],clearTimeout(this.timeoutID)},add:function(e){return this.addToQueue(e),++this.count},addToQueue:function(t){this.queue.length==0&&e.delay(e.bind(this.onDelayComplete,this),10),this.queue.push(t)},onDelayComplete:function(){var t=this.queue[0];t.queueCallback=e.bind(this.onServiceComplete,this),t.execute()},onServiceComplete:function(){var t=this.queue.shift();this.queue.length>0&&e.delay(e.bind(this.onDelayComplete,this),10)}});return new n}),define("ac785/e734f/b669d",["ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/e734f/cae73"],function(e,t,n,r){var i=e.extend({init:function(e){this.successCallback=undefined,this.errorCallback=undefined,this.queueCallback=undefined,e?this._id=r.add(this):this.execute()},execute:function(){},parse:function(e){},onResult:function(e){this.parse(e),this.cleanup()},onFault:function(e){this.onStatusError(15);var t="";for(var n in e)t+=n+" = "+e[n]+"\n";window.location.href.indexOf("pepper.plug.dj")>-1&&alert("Server Error! "+t),console.log("Server Error ==> ",e),console.log(t),this.cleanup()},onStatusError:function(e){console.error("onStatusError ==> ",e),this.errorCallback!=undefined&&this.errorCallback(e)},cleanup:function(){this.errorCallback=undefined,this.successCallback=undefined,this.queueCallback!=undefined&&this.queueCallback(),this.queueCallback=undefined},dispatch:function(e){t.dispatch(e)},trigger:function(){t.trigger.apply(t,arguments)},alert:function(e,r,i,s){t.dispatch(new n(n.ALERT,e,r,i,s))}});return i}),define("ac785/e734f/ea1d8/a971b",["ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(e){this.avatarID=e,this._super(!0)},execute:function(){e.execute("user.set_avatar",this,this.avatarID)},parse:function(e){e.status==0?this.successCallback!=null&&this.successCallback(this.avatarID):e.status==2?this.successCallback!=null&&this.successCallback(-1):this.onStatusError(e.status)}});return n}),define("ac785/f6dac/bf313",["ac785/bc190/b96e1"],function(e){var t=e.extend({init:function(){this.enabled=window.location.href.indexOf("http://plug.dj")==0},event:function(e,t,n,r,i){this.enabled&&_gaq.push(["_trackEvent",e,t,n,r,i])},page:function(e){this.enabled&&_gaq.push(["_trackPageview","/"+e+"/"])}});return new t}),define("ac785/b1ca1/a5a33",["underscore","ac785/bc190/fea39","ac785/ca252/a9a95","ac785/ca252/fae6c","ac785/e734f/ea1d8/a971b","ac785/d94e0/fb1a1","ac785/f6dac/bf313"],function(e,t,n,r,i,s,o){var u=t.extend({execute:function(){if(r.get("avatarID")!=this.event.avatarID){var t=new i(this.event.avatarID);t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.finish,this),o.event("Avatar","Select",this.event.avatarID)}else this.finish()},onResponse:function(e){e!=-1?n.setSelected(this.event.avatarID):this.trigger("notify","icon-chat-system",Lang.alerts.notEnoughPoints),this.finish()}});return u}),define("ac785/d94e0/a461e",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.avatarID=t}});return t._name="AvatarChangeEvent",t.CHANGE="AvatarChangeEvent:change",t}),define("ac785/b1ca1/fa883",["underscore","ac785/bc190/d22bb","ac785/bc190/cd0b8"],function(e,t,n){var r=t.extend({execute:function(){this.event.path&&require([this.event.path],function(){e.delay(function(){n.trigger("custom:load")},100)})}});return r}),define("ac785/d94e0/a781b",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.path=t}});return t._name="CustomRoomEvent",t.CUSTOM="CustomRoomEvent:custom",t}),define("ac785/d94e0/c672e",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="DJEvent",t.JOIN="DJEvent:join",t.LEAVE="DJEvent:leave",t.SKIP="DJEvent:skip",t}),define("ac785/d94e0/a045f",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.id=t}});return t._name="RoomJoinEvent",t.JOIN="RoomJoinEvent:join",t}),define("ac785/d94e0/bc747",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.id=t}});return t._name="RoomStateEvent",t.UPDATE="RoomStateEvent:update",t}),define("ac785/d94e0/bad16",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.data=t}});return t._name="ChatFacadeEvent",t.CLEAR="ChatFacadeEvent:clear",t.EMOJI="ChatFacadeEvent:emoji",t.MENTIONS="ChatFacadeEvent:mentions",t.SOUND="ChatFacadeEvent:sound",t.RECEIVE="ChatFacadeEvent:receive",t.DELETE="ChatFacadeEvent:delete",t.TIMESTAMP="ChatFacadeEvent:timestamp",t}),define("ac785/d94e0/e089a",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r){this._super(e),this.id=t,this.value=n,this.option=r}});return t._name="ModerateEvent",t.ADD_DJ="ModerateEvent:adddj",t.CHAT_DELETE="ModerateEvent:chatdelete",t.SKIP="ModerateEvent:skip",t.BAN="ModerateEvent:ban",t.PERMISSION="ModerateEvent:permission",t.REMOVE_DJ="ModerateEvent:removedj",t.UNBAN="ModerateEvent:unban",t}),define("ac785/d94e0/ac2bb",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r){this._super(e),this.username=t,this.status=n,this.language=r}});return t._name="UserProfileUpdateEvent",t.UPDATE="UserProfileUpdateEvent:update",t}),define("ac785/ab6db/d29cb",[],function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",compressToBase64:function(e){var t="",n,r,i,s,o,u,a,f=0;e=this.compress(e);while(f<e.length*2)f%2==0?(n=e.charCodeAt(f/2)>>8,r=e.charCodeAt(f/2)&255,f/2+1<e.length?i=e.charCodeAt(f/2+1)>>8:i=NaN):(n=e.charCodeAt((f-1)/2)&255,(f+1)/2<e.length?(r=e.charCodeAt((f+1)/2)>>8,i=e.charCodeAt((f+1)/2)&255):r=i=NaN),f+=3,s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a);return t},decompressFromBase64:function(e){var t="",n=0,r,i,s,o,u,a,f,l,c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length)u=this._keyStr.indexOf(e.charAt(c++)),a=this._keyStr.indexOf(e.charAt(c++)),f=this._keyStr.indexOf(e.charAt(c++)),l=this._keyStr.indexOf(e.charAt(c++)),i=u<<2|a>>4,s=(a&15)<<4|f>>2,o=(f&3)<<6|l,n%2==0?(r=i<<8,flush=!0,f!=64&&(t+=String.fromCharCode(r|s),flush=!1),l!=64&&(r=o<<8,flush=!0)):(t+=String.fromCharCode(r|i),flush=!1,f!=64&&(r=s<<8,flush=!0),l!=64&&(t+=String.fromCharCode(r|o),flush=!1)),n+=3;return this.decompress(t)},compressToUTF16:function(e){var t="",n,r,i,s=0;e=this.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=String.fromCharCode((r>>1)+32),i=(r&1)<<14;break;case 1:t+=String.fromCharCode(i+(r>>2)+32),i=(r&3)<<13;break;case 2:t+=String.fromCharCode(i+(r>>3)+32),i=(r&7)<<12;break;case 3:t+=String.fromCharCode(i+(r>>4)+32),i=(r&15)<<11;break;case 4:t+=String.fromCharCode(i+(r>>5)+32),i=(r&31)<<10;break;case 5:t+=String.fromCharCode(i+(r>>6)+32),i=(r&63)<<9;break;case 6:t+=String.fromCharCode(i+(r>>7)+32),i=(r&127)<<8;break;case 7:t+=String.fromCharCode(i+(r>>8)+32),i=(r&255)<<7;break;case 8:t+=String.fromCharCode(i+(r>>9)+32),i=(r&511)<<6;break;case 9:t+=String.fromCharCode(i+(r>>10)+32),i=(r&1023)<<5;break;case 10:t+=String.fromCharCode(i+(r>>11)+32),i=(r&2047)<<4;break;case 11:t+=String.fromCharCode(i+(r>>12)+32),i=(r&4095)<<3;break;case 12:t+=String.fromCharCode(i+(r>>13)+32),i=(r&8191)<<2;break;case 13:t+=String.fromCharCode(i+(r>>14)+32),i=(r&16383)<<1;break;case 14:t+=String.fromCharCode(i+(r>>15)+32,(r&32767)+32),s=0}}return t+String.fromCharCode(i+32)},decompressFromUTF16:function(e){var t="",n,r,i=0,s=0;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=String.fromCharCode(n|r>>14),n=(r&16383)<<2;break;case 2:t+=String.fromCharCode(n|r>>13),n=(r&8191)<<3;break;case 3:t+=String.fromCharCode(n|r>>12),n=(r&4095)<<4;break;case 4:t+=String.fromCharCode(n|r>>11),n=(r&2047)<<5;break;case 5:t+=String.fromCharCode(n|r>>10),n=(r&1023)<<6;break;case 6:t+=String.fromCharCode(n|r>>9),n=(r&511)<<7;break;case 7:t+=String.fromCharCode(n|r>>8),n=(r&255)<<8;break;case 8:t+=String.fromCharCode(n|r>>7),n=(r&127)<<9;break;case 9:t+=String.fromCharCode(n|r>>6),n=(r&63)<<10;break;case 10:t+=String.fromCharCode(n|r>>5),n=(r&31)<<11;break;case 11:t+=String.fromCharCode(n|r>>4),n=(r&15)<<12;break;case 12:t+=String.fromCharCode(n|r>>3),n=(r&7)<<13;break;case 13:t+=String.fromCharCode(n|r>>2),n=(r&3)<<14;break;case 14:t+=String.fromCharCode(n|r>>1),n=(r&1)<<15;break;case 15:t+=String.fromCharCode(n|r),i=0}s++}return this.decompress(t)},compress:function(e){var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h="",p=0,d=0,v;for(v=0;v<e.length;v+=1){s=e.charAt(v),r.hasOwnProperty(s)||(r[s]=f++,i[s]=!0),o=u+s;if(r.hasOwnProperty(o))u=o;else{if(i.hasOwnProperty(u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++)p<<=1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++;n=u.charCodeAt(0);for(t=0;t<8;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}else{n=1;for(t=0;t<l;t++)p=p<<1|n,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n=0;n=u.charCodeAt(0);for(t=0;t<16;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}a--,a==0&&(a=Math.pow(2,l),l++),delete i[u]}else{n=r[u];for(t=0;t<l;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}a--,a==0&&(a=Math.pow(2,l),l++),r[o]=f++,u=String(s)}}if(u!==""){if(i.hasOwnProperty(u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++)p<<=1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++;n=u.charCodeAt(0);for(t=0;t<8;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}else{n=1;for(t=0;t<l;t++)p=p<<1|n,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n=0;n=u.charCodeAt(0);for(t=0;t<16;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}a--,a==0&&(a=Math.pow(2,l),l++),delete i[u]}else{n=r[u];for(t=0;t<l;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1}a--,a==0&&(a=Math.pow(2,l),l++)}n=2;for(t=0;t<l;t++)p=p<<1|n&1,d==15?(d=0,h+=String.fromCharCode(p),p=0):d++,n>>=1;for(;;){p<<=1;if(d==15){h+=String.fromCharCode(p);break}d++}return h},decompress:function(e){var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=0,m,g={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1)t[a]=a;l=0,h=Math.pow(2,2),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;switch(n=l){case 0:l=0,h=Math.pow(2,8),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;d=String.fromCharCode(l);break;case 1:l=0,h=Math.pow(2,16),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;d=String.fromCharCode(l);break;case 2:return""}t[3]=d,f=u=d;for(;;){l=0,h=Math.pow(2,s),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;switch(d=l){case 0:if(v++>1e4)return"Error";l=0,h=Math.pow(2,8),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;t[i++]=String.fromCharCode(l),d=i-1,r--;break;case 1:l=0,h=Math.pow(2,16),p=1;while(p!=h)c=g.val&g.position,g.position>>=1,g.position==0&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),l|=(c>0?1:0)*p,p<<=1;t[i++]=String.fromCharCode(l),d=i-1,r--;break;case 2:return u}r==0&&(r=Math.pow(2,s),s++);if(t[d])o=t[d];else{if(d!==i)return null;o=f+f.charAt(0)}u+=o,t[i++]=f+o.charAt(0),r--,f=o,r==0&&(r=Math.pow(2,s),s++)}return u}};return e}),define("ac785/ab6db/a4893",["underscore","ac785/bc190/b96e1","ac785/ab6db/d29cb"],function(e,t,n){var r=t.extend({pending:{},clear:function(){localStorage.clear()},setItem:function(t,n,r){r?this._save(t,n):(this.pending[t]&&clearInterval(this.pending[t]),this.pending[t]=e.delay(e.bind(this._save,this),1e3,t,n))},getItem:function(e){var t=localStorage.getItem(e);if(!t)return null;var r=n.decompressFromUTF16(t);return r},_save:function(e,t){if(t){var r=n.compressToUTF16(t);localStorage.setItem(e,r),clearInterval(this.pending[e]),this.pending[e]=undefined}}});return new r}),define("ac785/ab6db/ffb2a",["ac785/bc190/b96e1","ac785/ab6db/a4893"],function(e,t){var n=e.extend({init:function(){t.getItem(n.SETTINGS)?(this.media=JSON.parse(t.getItem("media")),this.playlist=JSON.parse(t.getItem("playlist")),this.lastModTime=JSON.parse(t.getItem("lastModTime")),this.settings=JSON.parse(t.getItem(n.SETTINGS))):this.reset()},reset:function(){var e;t.getItem(n.SETTINGS)?e=JSON.parse(t.getItem(n.SETTINGS)):e=this.defaultSettings(),t.clear(),t.setItem("media",JSON.stringify({}),!0),t.setItem("playlist",JSON.stringify({}),!0),t.setItem("lastModTime",JSON.stringify({}),!0),t.setItem(n.SETTINGS,JSON.stringify(e),!0),this.media={},this.playlist={},this.lastModTime={},this.init()},ready:function(e){e=n.VERSION+":"+e,t.getItem("dbv")!=e&&(this.reset(),t.setItem("dbv",e))},saveSettings:function(){t.setItem(n.SETTINGS,JSON.stringify(this.settings))},getMediaPlaylists:function(e){var t=[];for(var n in this.playlist)for(var r in this.playlist[n].items){var i=this.media[this.playlist[n].items[r]];i&&i.cid==e&&t.push({id:this.playlist[n].id,name:this.playlist[n].name})}return t},defaultSettings:function(){return{volume:50,chatSound:!0,chatTranslation:!0,avatarcap:200,streamDisabled:!1,chatTS:12,emoji:!0,rollovers:!0,djFX:!0,dancing:!0,bgAnim:!0,djAnnounce:!0,fanJoin:!0,score:!0,tooltips:!0}}});return n.VERSION="09813",n.SETTINGS="s01",new n}),define("ac785/ca252/ec425",["underscore","backbone","ac785/bc190/cd0b8","ac785/ab6db/ffb2a","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s){var o=t.Model.extend({defaults:{media:undefined,mediaStartTime:undefined,playlistID:undefined,historyID:undefined,volume:r.settings.volume,lastVolume:r.settings.volume,streamDisabled:r.settings.streamDisabled,duration:0,elapsed:0,remaining:0,muted:!1,durationChecked:!1,restricted:undefined,ytDuration:0},initialize:function(){this.updateIntervalID=0,this.updateElapsedBind=e.bind(this.updateElapsed,this),this.on("change:media",this.onMediaChange,this).on("change:mediaStartTime",this.onStartTimeChange,this).on("change:elapsed",this.onElapsedChange,this).on("change:volume",this.onVolumeChange,this).on("change:streamDisabled",this.onStreamChange,this)},onMediaChange:function(){this.get("media")?this.get("restricted")||(this.set("duration",this.get("media").get("duration")),this.set({durationChecked:this.get("media").get("format")==2}),this.updateIntervalID==0&&(this.updateIntervalID=setInterval(this.updateElapsedBind,500))):(this.set({duration:0,durationChecked:!1,ytDuration:0}),clearInterval(this.updateIntervalID),this.updateIntervalID=0)},onStartTimeChange:function(){this.set("elapsed",i.getSecondsElapsed(this.get("mediaStartTime")))},onElapsedChange:function(){this.set("remaining",this.get("duration")-this.get("elapsed")).get("remaining")<0&&(clearInterval(this.updateIntervalID),this.updateIntervalID=0)},updateElapsed:function(){this.set("elapsed",i.getSecondsElapsed(this.get("mediaStartTime")))},onVolumeChange:function(){this.set("muted",this.get("volume")==0)},onStreamChange:function(){r.settings.streamDisabled=this.get("streamDisabled"),r.saveSettings(),r.settings.streamDisabled?n.trigger("notify","icon-next-track",s.messages.streamDisabled):n.trigger("notify","icon-next-track",s.messages.streamEnabled)}});return new o}),define("ac785/f6dac/d0837",["jquery"],function(e){function i(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}var t={},n={">:(":"angry",">XD":"astonished",":DX":"bowtie","</3":"broken_heart",":$":"confused",X$:"confounded",":~(":"cry",":[":"disappointed",":~[":"disappointed_relieved",XO:"dizzy_face",":|":"expressionless","8|":"flushed",":(":"frowning",":#":"grimacing",":D":"grinning","<3":"heart","<3)":"heart_eyes","O:)":"innocent",":~)":"joy",":*":"kissing",":<3":"kissing_heart","X<3":"kissing_closed_eyes",XD:"laughing",":O":"open_mouth","Z:|":"sleeping",":)":"smiley",":/":"smirk",T_T:"sob",":P":"stuck_out_tongue","X-P":"stuck_out_tongue_closed_eyes",";P":"stuck_out_tongue_winking_eye","B-)":"sunglasses","~:(":"sweat","~:)":"sweat_smile",XC:"tired_face",">:/":"unamused",";)":"wink"},r={100:"1f4af",1234:"1f522","-1":"1f44e","+1":"1f44d","8ball":"1f3b1",abcd:"1f521",abc:"1f524",ab:"1f18e",accept:"1f251",aerial_tramway:"1f6a1",airplane:"2708",alarm_clock:"23f0",alien:"1f47d",ambulance:"1f691",anchor:"2693",angel:"1f47c",anger:"1f4a2",angry:"1f620",anguished:"1f627",ant:"1f41c",a:"1f170",apple:"1f34e",aquarius:"2652",aries:"2648",arrow_backward:"25c0",arrow_double_down:"23ec",arrow_double_up:"23eb",arrow_down:"2b07",arrow_down_small:"1f53d",arrow_forward:"25b6",arrow_heading_down:"2935",arrow_heading_up:"2934",arrow_left:"2b05",arrow_lower_left:"2199",arrow_lower_right:"2198",arrow_right_hook:"21aa",arrow_right:"27a1",arrows_clockwise:"1f503",arrows_counterclockwise:"1f504",arrow_up_down:"2195",arrow_upper_left:"2196",arrow_upper_right:"2197",arrow_up:"2b06",arrow_up_small:"1f53c",articulated_lorry:"1f69b",art:"1f3a8",astonished:"1f632",athletic_shoe:"1f45f",atm:"1f3e7",baby_bottle:"1f37c",baby_chick:"1f424",baby:"1f476",baby_symbol:"1f6bc",back:"1f519",baggage_claim:"1f6c4",balloon:"1f388",ballot_box_with_check:"2611",bamboo:"1f38d",banana:"1f34c",bangbang:"203c",bank:"1f3e6",barber:"1f488",bar_chart:"1f4ca",baseball:"26be",basketball:"1f3c0",bath:"1f6c0",bathtub:"1f6c1",battery:"1f50b",bear:"1f43b",bee:"1f41d",beer:"1f37a",beers:"1f37b",beetle:"1f41e",beginner:"1f530",bell:"1f514",bento:"1f371",bicyclist:"1f6b4",bike:"1f6b2",bikini:"1f459",bird:"1f426",birthday:"1f382",black_circle:"26ab",black_joker:"1f0cf",black_large_square:"2b1b",black_medium_small_square:"25fe",black_medium_square:"25fc",black_nib:"2712",black_small_square:"25aa",black_square_button:"1f532",blossom:"1f33c",blowfish:"1f421",blue_book:"1f4d8",blue_car:"1f699",blue_heart:"1f499",blush:"1f60a",boar:"1f417",boat:"26f5",bomb:"1f4a3",bookmark:"1f516",bookmark_tabs:"1f4d1",book:"1f4d6",books:"1f4da",boom:"1f4a5",boot:"1f462",bouquet:"1f490",bowling:"1f3b3",bow:"1f647",bowtie:"bowtie",boy:"1f466",b:"1f171",bread:"1f35e",bride_with_veil:"1f470",bridge_at_night:"1f309",briefcase:"1f4bc",broken_heart:"1f494",bug:"1f41b",bulb:"1f4a1",bullettrain_front:"1f685",bullettrain_side:"1f684",bus:"1f68c",busstop:"1f68f",bust_in_silhouette:"1f464",busts_in_silhouette:"1f465",cactus:"1f335",cake:"1f370",calendar:"1f4c6",calling:"1f4f2",camel:"1f42b",camera:"1f4f7",cancer:"264b",candy:"1f36c",capital_abcd:"1f520",capricorn:"2651",card_index:"1f4c7",carousel_horse:"1f3a0",car:"1f697",cat2:"1f408",cat:"1f431",cd:"1f4bf",chart:"1f4b9",chart_with_downwards_trend:"1f4c9",chart_with_upwards_trend:"1f4c8",checkered_flag:"1f3c1",cherries:"1f352",cherry_blossom:"1f338",chestnut:"1f330",chicken:"1f414",children_crossing:"1f6b8",chocolate_bar:"1f36b",christmas_tree:"1f384",church:"26ea",cinema:"1f3a6",circus_tent:"1f3aa",city_sunrise:"1f307",city_sunset:"1f306",clapper:"1f3ac",clap:"1f44f",clipboard:"1f4cb",clock1030:"1f565",clock10:"1f559",clock1130:"1f566",clock11:"1f55a",clock1230:"1f567",clock12:"1f55b",clock130:"1f55c",clock1:"1f550",clock230:"1f55d",clock2:"1f551",clock330:"1f55e",clock3:"1f552",clock430:"1f55f",clock4:"1f553",clock530:"1f560",clock5:"1f554",clock630:"1f561",clock6:"1f555",clock730:"1f562",clock7:"1f556",clock830:"1f563",clock8:"1f557",clock930:"1f564",clock9:"1f558",closed_book:"1f4d5",closed_lock_with_key:"1f510",closed_umbrella:"1f302",cloud:"2601",cl:"1f191",clubs:"2663",cn:"1f1e8-1f1f3",cocktail:"1f378",coffee:"2615",cold_sweat:"1f630",collision:"1f4a5",computer:"1f4bb",confetti_ball:"1f38a",confounded:"1f616",confused:"1f615",congratulations:"3297",construction:"1f6a7",construction_worker:"1f477",convenience_store:"1f3ea",cookie:"1f36a",cool:"1f192",cop:"1f46e",copyright:"00a9",corn:"1f33d",couplekiss:"1f48f",couple:"1f46b",couple_with_heart:"1f491",cow2:"1f404",cow:"1f42e",credit_card:"1f4b3",crescent_moon:"1f319",crocodile:"1f40a",crossed_flags:"1f38c",crown:"1f451",crying_cat_face:"1f63f",cry:"1f622",crystal_ball:"1f52e",cupid:"1f498",curly_loop:"27b0",currency_exchange:"1f4b1",curry:"1f35b",custard:"1f36e",customs:"1f6c3",cyclone:"1f300",dancer:"1f483",dancers:"1f46f",dango:"1f361",dart:"1f3af",dash:"1f4a8",date:"1f4c5",deciduous_tree:"1f333",department_store:"1f3ec",de:"1f1e9-1f1ea",diamond_shape_with_a_dot_inside:"1f4a0",diamonds:"2666",disappointed:"1f61e",disappointed_relieved:"1f625",dizzy_face:"1f635",dizzy:"1f4ab",dog2:"1f415",dog:"1f436",dollar:"1f4b5",dolls:"1f38e",dolphin:"1f42c",do_not_litter:"1f6af",door:"1f6aa",doughnut:"1f369",dragon_face:"1f432",dragon:"1f409",dress:"1f457",dromedary_camel:"1f42a",droplet:"1f4a7",dvd:"1f4c0",ear_of_rice:"1f33e",ear:"1f442",earth_africa:"1f30d",earth_americas:"1f30e",earth_asia:"1f30f",eggplant:"1f346",egg:"1f373",eight:"0038",eight_pointed_black_star:"2734",eight_spoked_asterisk:"2733",electric_plug:"1f50c",elephant:"1f418","e-mail":"1f4e7",email:"2709",end:"1f51a",envelope:"2709",envelope_with_arrow:"1f4e9",es:"1f1ea-1f1f8",european_castle:"1f3f0",european_post_office:"1f3e4",euro:"1f4b6",evergreen_tree:"1f332",exclamation:"2757",expressionless:"1f611",eyeglasses:"1f453",eyes:"1f440",facepunch:"1f44a",factory:"1f3ed",fallen_leaf:"1f342",family:"1f46a",fast_forward:"23e9",fax:"1f4e0",fearful:"1f628",feelsgood:"feelsgood",feet:"1f43e",ferris_wheel:"1f3a1",file_folder:"1f4c1",finnadie:"finnadie",fire_engine:"1f692",fire:"1f525",fireworks:"1f386",first_quarter_moon:"1f313",first_quarter_moon_with_face:"1f31b",fish_cake:"1f365",fishing_pole_and_fish:"1f3a3",fish:"1f41f",fist:"270a",five:"0035",flags:"1f38f",flashlight:"1f526",floppy_disk:"1f4be",flower_playing_cards:"1f3b4",flushed:"1f633",foggy:"1f301",football:"1f3c8",footprints:"1f463",fork_and_knife:"1f374",fountain:"26f2",four_leaf_clover:"1f340",four:"0034",free:"1f193",fried_shrimp:"1f364",fries:"1f35f",frog:"1f438",frowning:"1f626",fr:"1f1eb-1f1f7",fuelpump:"26fd",full_moon:"1f315",full_moon_with_face:"1f31d",game_die:"1f3b2",gb:"1f1ec-1f1e7",gemini:"264a",gem:"1f48e",ghost:"1f47b",gift_heart:"1f49d",gift:"1f381",girl:"1f467",globe_with_meridians:"1f310",goat:"1f410",goberserk:"goberserk",godmode:"godmode",golf:"26f3",grapes:"1f347",green_apple:"1f34f",green_book:"1f4d7",green_heart:"1f49a",grey_exclamation:"2755",grey_question:"2754",grimacing:"1f62c",grinning:"1f600",grin:"1f601",guardsman:"1f482",guitar:"1f3b8",gun:"1f52b",haircut:"1f487",hamburger:"1f354",hammer:"1f528",hamster:"1f439",handbag:"1f45c",hand:"270b",hankey:"1f4a9",hash:"0023",hatched_chick:"1f425",hatching_chick:"1f423",headphones:"1f3a7",hear_no_evil:"1f649",heartbeat:"1f493",heart_decoration:"1f49f",heart_eyes_cat:"1f63b",heart_eyes:"1f60d",heart:"2764",heartpulse:"1f497",hearts:"2665",heavy_check_mark:"2714",heavy_division_sign:"2797",heavy_dollar_sign:"1f4b2",heavy_exclamation_mark:"2757",heavy_minus_sign:"2796",heavy_multiplication_x:"2716",heavy_plus_sign:"2795",helicopter:"1f681",herb:"1f33f",hibiscus:"1f33a",high_brightness:"1f506",high_heel:"1f460",hocho:"1f52a",honeybee:"1f41d",honey_pot:"1f36f",horse:"1f434",horse_racing:"1f3c7",hospital:"1f3e5",hotel:"1f3e8",hotsprings:"2668",hourglass_flowing_sand:"23f3",hourglass:"231b",house:"1f3e0",house_with_garden:"1f3e1",hurtrealbad:"hurtrealbad",hushed:"1f62f",ice_cream:"1f368",icecream:"1f366",ideograph_advantage:"1f250",id:"1f194",imp:"1f47f",inbox_tray:"1f4e5",incoming_envelope:"1f4e8",information_desk_person:"1f481",information_source:"2139",innocent:"1f607",interrobang:"2049",iphone:"1f4f1",it:"1f1ee-1f1f9",izakaya_lantern:"1f3ee",jack_o_lantern:"1f383",japanese_castle:"1f3ef",japanese_goblin:"1f47a",japanese_ogre:"1f479",japan:"1f5fe",jeans:"1f456",joy_cat:"1f639",joy:"1f602",jp:"1f1ef-1f1f5",keycap_ten:"1f51f",key:"1f511",kimono:"1f458",kissing_cat:"1f63d",kissing_closed_eyes:"1f61a",kissing_heart:"1f618",kissing:"1f617",kissing_smiling_eyes:"1f619",kiss:"1f48b",koala:"1f428",koko:"1f201",kr:"1f1f0-1f1f7",lantern:"1f3ee",large_blue_circle:"1f535",large_blue_diamond:"1f537",large_orange_diamond:"1f536",last_quarter_moon:"1f317",last_quarter_moon_with_face:"1f31c",laughing:"1f606",leaves:"1f343",ledger:"1f4d2",left_luggage:"1f6c5",left_right_arrow:"2194",leftwards_arrow_with_hook:"21a9",lemon:"1f34b",leopard:"1f406",leo:"264c",libra:"264e",light_rail:"1f688",link:"1f517",lips:"1f444",lipstick:"1f484",lock:"1f512",lock_with_ink_pen:"1f50f",lollipop:"1f36d",loop:"27bf",loudspeaker:"1f4e2",love_hotel:"1f3e9",love_letter:"1f48c",low_brightness:"1f505",mag:"1f50d",mag_right:"1f50e",mahjong:"1f004",mailbox_closed:"1f4ea",mailbox:"1f4eb",mailbox_with_mail:"1f4ec",mailbox_with_no_mail:"1f4ed",man:"1f468",mans_shoe:"1f45e",man_with_gua_pi_mao:"1f472",man_with_turban:"1f473",maple_leaf:"1f341",mask:"1f637",massage:"1f486",meat_on_bone:"1f356",mega:"1f4e3",melon:"1f348",memo:"1f4dd",mens:"1f6b9",metal:"metal",metro:"1f687",microphone:"1f3a4",microscope:"1f52c",milky_way:"1f30c",minibus:"1f690",minidisc:"1f4bd",mobile_phone_off:"1f4f4",moneybag:"1f4b0",money_with_wings:"1f4b8",monkey_face:"1f435",monkey:"1f412",monorail:"1f69d",moon:"1f314",mortar_board:"1f393",mountain_bicyclist:"1f6b5",mountain_cableway:"1f6a0",mountain_railway:"1f69e",mount_fuji:"1f5fb",mouse2:"1f401",mouse:"1f42d",movie_camera:"1f3a5",moyai:"1f5ff",m:"24c2",muscle:"1f4aa",mushroom:"1f344",musical_keyboard:"1f3b9",musical_note:"1f3b5",musical_score:"1f3bc",mute:"1f507",nail_care:"1f485",name_badge:"1f4db",neckbeard:"neckbeard",necktie:"1f454",negative_squared_cross_mark:"274e",neutral_face:"1f610",new_moon:"1f311",new_moon_with_face:"1f31a","new":"1f195",newspaper:"1f4f0",ng:"1f196",nine:"0039",no_bell:"1f515",no_bicycles:"1f6b3",no_entry:"26d4",no_entry_sign:"1f6ab",no_good:"1f645",no_mobile_phones:"1f4f5",no_mouth:"1f636","non-potable_water":"1f6b1",no_pedestrians:"1f6b7",nose:"1f443",no_smoking:"1f6ad",notebook:"1f4d3",notebook_with_decorative_cover:"1f4d4",notes:"1f3b6",nut_and_bolt:"1f529",o2:"1f17e",ocean:"1f30a",octocat:"octocat",octopus:"1f419",oden:"1f362",office:"1f3e2",ok_hand:"1f44c",ok:"1f197",ok_woman:"1f646",older_man:"1f474",older_woman:"1f475",oncoming_automobile:"1f698",oncoming_bus:"1f68d",oncoming_police_car:"1f694",oncoming_taxi:"1f696",one:"0031",on:"1f51b",open_book:"1f4d6",open_file_folder:"1f4c2",open_hands:"1f450",open_mouth:"1f62e",ophiuchus:"26ce",o:"2b55",orange_book:"1f4d9",outbox_tray:"1f4e4",ox:"1f402","package":"1f4e6",page_facing_up:"1f4c4",pager:"1f4df",page_with_curl:"1f4c3",palm_tree:"1f334",panda_face:"1f43c",paperclip:"1f4ce",parking:"1f17f",part_alternation_mark:"303d",partly_sunny:"26c5",passport_control:"1f6c2",paw_prints:"1f43e",peach:"1f351",pear:"1f350",pencil2:"270f",pencil:"1f4dd",penguin:"1f427",pensive:"1f614",performing_arts:"1f3ad",persevere:"1f623",person_frowning:"1f64d",person_with_blond_hair:"1f471",person_with_pouting_face:"1f64e",phone:"260e",pig2:"1f416",pig_nose:"1f43d",pig:"1f437",pill:"1f48a",pineapple:"1f34d",pisces:"2653",pizza:"1f355",point_down:"1f447",point_left:"1f448",point_right:"1f449",point_up_2:"1f446",point_up:"261d",police_car:"1f693",poodle:"1f429",poop:"1f4a9",postal_horn:"1f4ef",postbox:"1f4ee",post_office:"1f3e3",potable_water:"1f6b0",pouch:"1f45d",poultry_leg:"1f357",pound:"1f4b7",pouting_cat:"1f63e",pray:"1f64f",princess:"1f478",punch:"1f44a",purple_heart:"1f49c",purse:"1f45b",pushpin:"1f4cc",put_litter_in_its_place:"1f6ae",question:"2753",rabbit2:"1f407",rabbit:"1f430",racehorse:"1f40e",radio_button:"1f518",radio:"1f4fb",rage1:"rage1",rage2:"rage2",rage3:"rage3",rage4:"rage4",rage:"1f621",railway_car:"1f683",rainbow:"1f308",raised_hand:"1f64b",raised_hands:"1f64c",raising_hand:"1f64b",ramen:"1f35c",ram:"1f40f",rat:"1f400",recycle:"267b",red_car:"1f697",red_circle:"1f534",registered:"00ae",relaxed:"263a",relieved:"1f60c",repeat_one:"1f502",repeat:"1f501",restroom:"1f6bb",revolving_hearts:"1f49e",rewind:"23ea",ribbon:"1f380",rice_ball:"1f359",rice_cracker:"1f358",rice:"1f35a",rice_scene:"1f391",ring:"1f48d",rocket:"1f680",roller_coaster:"1f3a2",rooster:"1f413",rose:"1f339",rotating_light:"1f6a8",round_pushpin:"1f4cd",rowboat:"1f6a3",rugby_football:"1f3c9",runner:"1f3c3",running:"1f3c3",running_shirt_with_sash:"1f3bd",ru:"1f1f7-1f1fa",sagittarius:"2650",sailboat:"26f5",sake:"1f376",sandal:"1f461",santa:"1f385",sa:"1f202",satellite:"1f4e1",satisfied:"1f606",saxophone:"1f3b7",school:"1f3eb",school_satchel:"1f392",scissors:"2702",scorpius:"264f",scream_cat:"1f640",scream:"1f631",scroll:"1f4dc",seat:"1f4ba",secret:"3299",seedling:"1f331",see_no_evil:"1f648",seven:"0037",shaved_ice:"1f367",sheep:"1f411",shell:"1f41a",shipit:"shipit",ship:"1f6a2",shirt:"1f455",shit:"1f4a9",shoe:"1f45e",shower:"1f6bf",signal_strength:"1f4f6",six:"0036",six_pointed_star:"1f52f",ski:"1f3bf",skull:"1f480",sleeping:"1f634",sleepy:"1f62a",slot_machine:"1f3b0",small_blue_diamond:"1f539",small_orange_diamond:"1f538",small_red_triangle_down:"1f53b",small_red_triangle:"1f53a",smile_cat:"1f638",smile:"1f604",smiley_cat:"1f63a",smiley:"1f603",smiling_imp:"1f608",smirk_cat:"1f63c",smirk:"1f60f",smoking:"1f6ac",snail:"1f40c",snake:"1f40d",snowboarder:"1f3c2",snowflake:"2744",snowman:"26c4",sob:"1f62d",soccer:"26bd",soon:"1f51c",sos:"1f198",sound:"1f509",space_invader:"1f47e",spades:"2660",spaghetti:"1f35d",sparkle:"2747",sparkler:"1f387",sparkles:"2728",sparkling_heart:"1f496",speaker:"1f50a",speak_no_evil:"1f64a",speech_balloon:"1f4ac",speedboat:"1f6a4",squirrel:"squirrel",star2:"1f31f",star:"2b50",stars:"1f303",station:"1f689",statue_of_liberty:"1f5fd",steam_locomotive:"1f682",stew:"1f372",straight_ruler:"1f4cf",strawberry:"1f353",stuck_out_tongue_closed_eyes:"1f61d",stuck_out_tongue:"1f61b",stuck_out_tongue_winking_eye:"1f61c",sunflower:"1f33b",sunglasses:"1f60e",sunny:"2600",sunrise_over_mountains:"1f304",sunrise:"1f305",sun_with_face:"1f31e",surfer:"1f3c4",sushi:"1f363",suspect:"suspect",suspension_railway:"1f69f",sweat_drops:"1f4a6",sweat:"1f613",sweat_smile:"1f605",sweet_potato:"1f360",swimmer:"1f3ca",symbols:"1f523",syringe:"1f489",tada:"1f389",tanabata_tree:"1f38b",tangerine:"1f34a",taurus:"2649",taxi:"1f695",tea:"1f375",telephone:"260e",telephone_receiver:"1f4de",telescope:"1f52d",tennis:"1f3be",tent:"26fa",thought_balloon:"1f4ad",three:"0033",thumbsdown:"1f44e",thumbsup:"1f44d",ticket:"1f3ab",tiger2:"1f405",tiger:"1f42f",tired_face:"1f62b",tm:"2122",toilet:"1f6bd",tokyo_tower:"1f5fc",tomato:"1f345",tongue:"1f445",tophat:"1f3a9",top:"1f51d",tractor:"1f69c",traffic_light:"1f6a5",train2:"1f686",train:"1f683",tram:"1f68a",triangular_flag_on_post:"1f6a9",triangular_ruler:"1f4d0",trident:"1f531",triumph:"1f624",trolleybus:"1f68e",trollface:"trollface",trophy:"1f3c6",tropical_drink:"1f379",tropical_fish:"1f420",truck:"1f69a",trumpet:"1f3ba",tshirt:"1f455",tulip:"1f337",turtle:"1f422",tv:"1f4fa",twisted_rightwards_arrows:"1f500",two_hearts:"1f495",two_men_holding_hands:"1f46c",two:"0032",two_women_holding_hands:"1f46d",u5272:"1f239",u5408:"1f234",u55b6:"1f23a",u6307:"1f22f",u6708:"1f237",u6709:"1f236",u6e80:"1f235",u7121:"1f21a",u7533:"1f238",u7981:"1f232",u7a7a:"1f233",uk:"1f1ec-1f1e7",umbrella:"2614",unamused:"1f612",underage:"1f51e",unlock:"1f513",up:"1f199",us:"1f1fa-1f1f8",vertical_traffic_light:"1f6a6",vhs:"1f4fc",vibration_mode:"1f4f3",video_camera:"1f4f9",video_game:"1f3ae",violin:"1f3bb",virgo:"264d",volcano:"1f30b",v:"270c",vs:"1f19a",walking:"1f6b6",waning_crescent_moon:"1f318",waning_gibbous_moon:"1f316",warning:"26a0",watch:"231a",water_buffalo:"1f403",watermelon:"1f349",wave:"1f44b",wavy_dash:"3030",waxing_crescent_moon:"1f312",waxing_gibbous_moon:"1f314",wc:"1f6be",weary:"1f629",wedding:"1f492",whale2:"1f40b",whale:"1f433",wheelchair:"267f",white_check_mark:"2705",white_circle:"26aa",white_flower:"1f4ae",white_large_square:"2b1c",white_medium_small_square:"25fd",white_medium_square:"25fb",white_small_square:"25ab",white_square_button:"1f533",wind_chime:"1f390",wine_glass:"1f377",wink:"1f609",wolf:"1f43a",woman:"1f469",womans_clothes:"1f45a",womans_hat:"1f452",womens:"1f6ba",worried:"1f61f",wrench:"1f527",x:"274c",yellow_heart:"1f49b",yen:"1f4b4",yum:"1f60b",zap:"26a1",zero:"0030",zzz:"1f4a4"},s=/:([^ :]+):/;return t.emojify=function(e){var t=!1;e.substr(0,6)=="&nbsp;"&&(t=!0,e=e.substr(6));for(var o in n)(function(t,n){t=t.replace("<","&lt;").replace(">","&gt;");var r=new RegExp("(\\s|^)("+i(t)+")(?=\\s|$)","g");e=e.replace(r,"$1:"+n+":")})(o,n[o]);var u=s.exec(e);while(u){var a=u[1].toLowerCase(),f="&colon;"+a+"&colon;";r[a]&&(f='<span class="emoji-glow"><span class="emoji emoji-'+r[a]+'"></span></span>'),e=e.substr(0,u.index)+f+e.substr(u.index+u[0].length),u=s.exec(e)}return(t?"&nbsp;":"")+e},t.map=r,t}),define("ac785/f6dac/c41ff",[],function(){var e={};return e.scThumbnail="/_/static/images/soundcloud_thumbnail.8d1e583.png",e.sfx="/_/static/swf/sfx.0131d41.swf",e.csspopout="/_/static/css/popout.8d4bd53.css",e.css_de="/_/static/css/lang/de.c9f4d3b.css",e.css_en="/_/static/css/lang/en.6de6866.css",e.css_es="/_/static/css/lang/es.41b8135.css",e.css_fr="/_/static/css/lang/fr.e39b898.css",e.css_ja="/_/static/css/lang/ja.e948786.css",e.css_ko="/_/static/css/lang/ko.52831c1.css",e.css_pt="/_/static/css/lang/pt.594056c.css",e.css_zh="/_/static/css/lang/zh.a0a936d.css",e}),define("ac785/f04be/c8b95",["jquery","underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/bad16","ac785/d94e0/e089a","ac785/d94e0/ac2bb","ac785/ca252/bed74","ac785/ca252/ec425","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/ca252/c512b","ac785/ab6db/ffb2a","ac785/f6dac/d0837","ac785/f6dac/c1354","ac785/f6dac/bf313","ac785/f6dac/d17c3","ac785/f6dac/c41ff","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){var w=n.extend({init:function(){this.initChatLanguages(),this.rateLimit=0,this.lastChat=0,this.floodCount=0,this.floodInterval=0,this.floodBind=t.bind(this.updateFloodCount,this),this.Rndm=new v,this.mentionsFilter=!1,this.urlRegex=/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,a.on("add remove",this.updateRateLimit,this).on("change:username",this.onUsernameChanged,this),r.on("chat:log",t.bind(this.log,this))},clear:function(){m.event("Chat","Clear"),r.dispatch(new s(s.CLEAR))},toggleEmoji:function(){p.settings.emoji=!p.settings.emoji,p.saveSettings(),this.onEmojiUpdate()},toggleChatSound:function(){p.settings.chatSound=!p.settings.chatSound,p.saveSettings(),this.onSoundUpdate()},toggleTimestamp:function(){p.settings.chatTS==12?p.settings.chatTS=24:p.settings.chatTS==24?p.settings.chatTS=!1:p.settings.chatTS=12,p.saveSettings(),this.onTimestampUpdate()},toggleMentions:function(){this.mentionsFilter=!this.mentionsFilter,r.dispatch(new s(s.MENTIONS,this.mentionsFilter))},updateRateLimit:function(){var e=a.length;l.hasPermission(c.DJ)?this.rateLimit=0:e>999?this.rateLimit=30:e>499?this.rateLimit=20:e>199?this.rateLimit=10:e>99?this.rateLimit=5:this.rateLimit=0},updateFloodCount:function(){--this.floodCount==0&&(clearInterval(this.floodInterval),this.floodInterval=0)},getTimeout:function(){var e=Date.now(),t=e-this.lastChat,n=this.floodCount>2?this.floodCount-2:0,r=Math.max(n,this.rateLimit)*1e3;return t>r?(this.lastChat=e,0):Math.max(1,~~((r-t)/1e3))},onUsernameChanged:function(t,n){var r=t.previous("username");r&&this.receive({type:"update",from:r,message:b.messages.changeName.split("%NAME%").join(e("<span/>").text(n).html()),language:l.get("language")})},onEmojiUpdate:function(){return r.dispatch(new s(s.EMOJI,p.settings.emoji)),this},onSoundUpdate:function(){return r.dispatch(new s(s.SOUND,p.settings.chatSound)),this},onTimestampUpdate:function(){return r.dispatch(new s(s.TIMESTAMP,p.settings.chatTS)),this},onMentionsUpdate:function(){return r.dispatch(new s(s.MENTIONS,this.mentionsFilter)),this},sendChat:function(e){if(!this.chatCommand(e)){var t={},n=!0,i=this.getTimeout();if(i==0){t.from=l.get("username"),t.fromID=l.get("id"),e.indexOf("/em")==0||e.indexOf("/me")==0?(t.type="emote",t.message=g.cleanTypedString(e.substr(3))):(t.type="message",t.message=g.cleanTypedString(e));if(t.message.indexOf("http://")==-1&&t.message.indexOf("https://")==-1||l.hasPermission(c.DJ)||Date.now()-h.get("joinTime")>6e5)t.chatID=t.fromID.substr(0,6)+this.Rndm.integer(0,4294967295).toString(16),r.trigger("chat:send",{message:e,chatID:t.chatID}),l.hasPermission(c.DJ)||(++this.floodCount,this.floodInterval||(this.floodInterval=setInterval(this.floodBind,1e3)))}else i==1?t.message=b.chat.limit1:t.message=b.chat.limit.split("%SECS%").join(String(i)),t.type="update",n=!1;return t.language=l.get("language"),this.onChatReceived(t),n}return!0},log:function(e,t){this.receive({type:t?"system":"update",message:g.cleanTypedString(e)})},onChatReceived:function(t){var n=t.message.indexOf("@"+l.get("username"))>-1;n&&t.type!="emote"&&(t.type="mention"),t.type=="log"&&(t.type="moderation");var i={type:t.type},s=!t.from||t.type!="message"&&t.type!="mention"?"":"&nbsp;";t.from&&(i.from={value:t.from,"class":"from"},t.fromID&&(h.get("admins")[t.fromID]?i.from.class="from admin":h.get("ambassadors")[t.fromID]?i.from.class="from ambassador":h.get("ownerID")==t.fromID?i.from.class="from staff":h.get("staff")[t.fromID]&&h.get("staff")[t.fromID]<5?h.get("staff")[t.fromID]>=2?i.from.class="from staff":h.get("staff")[t.fromID]==1&&(i.from.class="from dj"):t.fromID==l.get("id")?i.from.class="from you":i.from.class="from",h.get("admins")[t.fromID]?i.from.admin=!0:h.get("ambassadors")[t.fromID]?i.from.ambassador=!0:h.get("ownerID")==t.fromID?i.from.owner=!0:h.get("staff")[t.fromID]&&h.get("staff")[t.fromID]<5&&(i.from.staff=h.get("staff")[t.fromID]),i.from.id=t.fromID,i.from.clickable=!0,t.fromID!=l.get("id")&&(i.deletable=!1,!h.get("admins")[t.fromID]&&!h.get("ambassadors")[t.fromID]&&(l.hasPermission(c.VOLUNTEER)?i.deletable=!0:l.hasPermission(c.BOUNCER)&&(!h.get("staff")[t.fromID]||l.get("permission")>h.get("staff")[t.fromID])&&(i.deletable=!0))),i.chatID=t.chatID)),i.timestamp=g.getChatTimestamp(p.settings.chatTS==24),!p.settings.chatTranslation||!t.translated?i.text=s+this.parse(t.message):t.translated!=1?(i.text=s+this.parse(t.translated),i.lang={html:"<br/><em>["+this.languageMap[t.language]+"]</em>",title:e(this.parse(t.message,!0)).text()}):(i.text=s+this.parse(t.message),i.lang={html:"<br/><em>["+this.languageMap[t.language]+"]</em>",title:b.tooltips.couldNotTranslate}),p.settings.emoji&&(i.text=d.emojify(i.text)),i.showTimestamp=p.settings.chatTS,t.fromID&&n&&p.settings.chatSound&&(i.sound="mention"),r.trigger("chat:receive",i)},receive:function(t){t.language||(t.language=l.get("language")),(!t.chatID||e(".cid-"+t.chatID).length==0)&&this.onChatReceived(t)},parse:function(e,t){return e.indexOf("http")==-1?e:t?e.replace(this.urlRegex,function(e){return"[link]"}):e.replace(this.urlRegex,function(e){var t=e.indexOf("plug.dj/")>-1&&e.indexOf("/about")==-1&&e.indexOf("blog.")==-1&&e.indexOf("support.")==-1?"_self":"_blank";return'<a href="'+e+'" target="'+t+'">'+e+"</a>"})},deleteChat:function(e){e&&l.hasPermission(c.BOUNCER)&&r.dispatch(new o(o.CHAT_DELETE,e))},onChatDelete:function(e){r.dispatch(new s(s.DELETE,e))},chatCommand:function(e){var n;if(e.charAt(0)=="/"&&(e.indexOf("/emoji")==0||e.indexOf("/em")!=0&&e.indexOf("/me")!=0)){if(e=="/help"){var o={};return o.type="update",o.message=b.chat.help,this.receive(o),!0}if(e.indexOf("/em")==0||e.indexOf("/me")==0)return!1;if(e=="/afk")return r.dispatch(new u(u.UPDATE,undefined,1,undefined)),!0;if(e=="/back")return r.dispatch(new u(u.UPDATE,undefined,0,undefined)),!0;if(e.indexOf("/cap")==0){var a=parseInt(e.substr(4));return a>0&&a<201?(p.settings.avatarcap=a,p.saveSettings(),r.trigger("audience:redraw").trigger("notify","icon-user",b.messages.cap.split("%COUNT%").join(String(a)))):this.log("Cap must be between 1-200"),!0}if(e=="/cleanup")return p.reset(),r.dispatch(new i(i.ALERT,b.alerts.update,b.alerts.updateMessage,t.bind(g.forceRefresh,g),!0)),!0;if(e=="/clear")return r.dispatch(new s(s.CLEAR)),!0;if(l.hasPermission(c.ADMIN)&&e.indexOf("/audience ")==0){var a=parseInt(e.split(" ").pop());a>0?(r.trigger("audience:test",a),n="Adding "+a+" fake avatars to audience"):(r.trigger("audience:redraw"),n="Cleared fake avatars from audience")}if(n){var o={};o.type="update",o.message=n,this.receive(o)}else r.trigger("chat:command",e);return!0}return!1},initChatLanguages:function(){this.uiLanguages=[],this.uiLanguages.push({label:"Chinese ()",value:"zh"}),this.uiLanguages.push({label:"Deutsch",value:"de"}),this.uiLanguages.push({label:"English",value:"en"}),this.uiLanguages.push({label:"Espaol",value:"es"}),this.uiLanguages.push({label:"Franais",value:"fr"}),this.uiLanguages.push({label:"Japanese ()",value:"ja"}),this.uiLanguages.push({label:"Korean ()",value:"ko"}),this.uiLanguages.push({label:"Portugus",value:"pt"}),this.languageMap={},this.uiLanguageMap={};var e=this.uiLanguages.length;while(e--)this.languageMap[this.uiLanguages[e].value]=this.uiLanguages[e].label,this.uiLanguageMap[this.uiLanguages[e].value]=this.uiLanguages[e].label;this.uiLanguages.sort(this.sortLanguages)},sortLanguages:function(e,t){return e.label>t.label?1:e.label<t.label?-1:0}});return new w}),define("ac785/e734f/ac507/ac792",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.id=e,this._super()},execute:function(){t.execute("report.disconnect",this,this.id,navigator.platform,navigator.userAgent)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/ac507/af94a",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.id=e,this.time=t,this._super()},execute:function(){t.execute("report.reconnect",this,this.id,navigator.platform,navigator.userAgent,this.time)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/ca252/d3a07",["backbone","ac785/ca252/a1027"],function(e,t){var n=t.extend({defaults:{id:"",username:"",moderator:"",timestamp:undefined}});return n}),define("ac785/ca252/ccfb5",["backbone","ac785/ca252/d3a07"],function(e,t){var n=e.Collection.extend({model:t,comparator:function(e){return-e.get("timestamp")}});return new n}),define("ac785/ca252/f89d8",["backbone","ac785/bc190/cd0b8","ac785/ca252/a1027","ac785/ca252/fae6c"],function(e,t,n,r){var i=e.Collection.extend({model:n,initialize:function(){this._hash={},this.on("reset",this.onReset,this)},onReset:function(){var e={};this.each(function(t){e[t.get("id")]=t}),this._hash=e,this.length>0?this.currentDJ=this.at(0).get("id"):this.currentDJ=undefined,this.isTheUserInBooth=this._hash[r.get("id")]?!0:!1,this.isTheUserPlaying=this.currentDJ==r.get("id")},getDJByID:function(e){return this._hash[e]}});return new i}),define("ac785/ca252/d83c7",["backbone","ac785/ca252/f89d8","ac785/ca252/c512b","ac785/ca252/bed74"],function(e,t,n,r){var i=e.Model.extend({defaults:{positive:undefined,negative:undefined,curates:undefined},initialize:function(){this.listenerPoints={},this.djPoints=0,this.curatePoints=0},djAdvance:function(e){var i,s;e||(n.set("votes",{}),n.set("curates",{}),r.each(function(e){e.set({vote:0,curated:!1})})),s=n.get("votes"),this.listenerPoints={},this.djPoints=0,this.curatePoints=0;if(t.currentDJ){var o=n.get("curates");for(i in o)++this.curatePoints;for(i in s)if(i!=t.currentDJ){var u=n.getUserByID(i),a=s[i];if(u&&a==-1||a==1)this.listenerPoints[i]=1;a==1?++this.djPoints:u&&(this.listenerPoints[i]=0)}}this.set({curates:this.curatePoints}),this.tally()},tally:function(){var e=0,t=0,r=n.get("votes");for(var i in r)r[i]==1?++e:r[i]==-1&&++t;this.set({positive:e,negative:t})},earn:function(e){try{var r=n.getUserByID(t.currentDJ);if(e){for(var i in this.listenerPoints){var s=n.getUserByID(i);s&&this.listenerPoints[i]==1&&s.set("listenerPoints",s.get("listenerPoints")+1)}r&&r.set({djPoints:r.get("djPoints")+(this.djPoints||0),curatorPoints:r.get("curatorPoints")+(this.curatePoints||0)})}else r&&r.set("curatorPoints",r.get("curatorPoints")+(this.curatePoints||0))}catch(o){console.log("applyEarnedPoints error"),console.log(o)}},userLeave:function(e){var t=n.get("votes");t[e]&&(t[e]==1?(--this.djPoints,this.set({positive:this.djPoints})):t[e]==-1&&this.set({negative:this.get("negative")-1}),t[e]=undefined,delete t[e])},voteUpdate:function(e){var r=n.getUserByID(e.id),i=n.get("votes");e.id!=t.currentDJ&&(r&&(r.set("vote",e.vote),this.listenerPoints[e.id]=1),e.vote==1&&i[e.id]!=1?(++this.djPoints,this.set({positive:this.djPoints}),i[e.id]==-1&&this.set({negative:this.get("negative")-1})):e.vote==-1&&i[e.id]!=-1&&(i[e.id]==1&&(--this.djPoints,this.set({positive:this.djPoints})),this.set({negative:this.get("negative")+1})),i[e.id]=e.vote)},curateUpdate:function(e){var t=n.getUserByID(e.id);t&&(t.set("curated",!0),n.get("curates")[e.id]||(n.get("curates")[e.id]=!0,this.set({curates:++this.curatePoints})))}});return new i}),define("ac785/ca252/ab49c",["backbone","ac785/bc190/cd0b8","ac785/ca252/f89d8","ac785/ca252/a1027","ac785/ca252/fae6c"],function(e,t,n,r,i){var s=e.Collection.extend({model:r,comparator:"wlIndex",initialize:function(){n.on("reset",this.onReset,this),this.on("remove",this.onRemove,this).on("update",this.onUpdate,this)},isFull:function(){return this.length>=50},onReset:function(){var e=[];n.each(function(t,n){t.set("wlIndex",n-1,{silent:n===0}),n>0&&e.push(t)}),this.set(e).sort().trigger("update")},onRemove:function(e){e.set("wlIndex",undefined,{silent:!0})},onUpdate:function(){t.trigger("userPlaying:update")},getUserPosition:function(e){return e||(e=i),this.indexOf(e)}});return new s}),define("ac785/ca252/de5df",["backbone"],function(e){var t=e.Model.extend({defaults:{timestamp:undefined,user:undefined,media:undefined,room:undefined}});return t}),define("ac785/ca252/b276e",["underscore","backbone","ac785/ca252/d83c7","ac785/ca252/de5df","ac785/ca252/ec425","ac785/ca252/bed74"],function(e,t,n,r,i,s){var o=t.Collection.extend({model:r,initialize:function(){n.on("change",this.onPointsChange,this),s.on("add remove reset",this.onListenersChange,this)},onPointsChange:function(){if(this.length>0&&this.at(0).get("id")==i.get("historyID")){var e=this.at(0).get("room");e.positive=n.get("positive"),e.negative=n.get("negative"),e.curates=n.get("curates"),this.at(0).set("room",e).trigger("change")}},onListenersChange:function(){if(this.length>0&&this.at(0).get("id")==i.get("historyID")){var e=this.at(0).get("room");e.listeners=s.length-1,this.at(0).set("room",e).trigger("change")}},comparator:function(e){return-e.get("timestamp")}});return new o}),define("ac785/ca252/aeeec",["backbone"],function(e){var t=e.Model.extend({defaults:{id:"",cid:"",author:"",title:"",image:"",format:0,duration:0,modified:"0"},initialize:function(){this.unset("active",{silent:!0})}});return t}),define("ac785/ca252/deacc",["backbone","ac785/ca252/aeeec"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/ca252/a99f8",["backbone"],function(e){var t=e.Model.extend({defaults:{id:"",name:"",items:[],selected:!1,modified:"0",visible:!1,syncing:!1},initialize:function(){this.unset("active",{silent:!0})}});return t}),define("ac785/ca252/dba93",["backbone","ac785/ca252/aeeec"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/ca252/c0f8f",["underscore","backbone","ac785/ca252/a99f8","ac785/ca252/deacc","ac785/ca252/dba93","ac785/bc190/cd0b8"],function(e,t,n,r,i,s){var o=t.Collection.extend({model:n,initialize:function(){this.on("change:visible",this.onVisibleChange,this).on("change:items",this.onItemsChange,this).on("reset",this.onReset,this)},setVisible:function(e){var t=this.find(function(e){return e.get("visible")});return e?(t&&t.get("id")!=e.get("id")&&t.set("visible",!1),e.set("visible",!0)):t&&t.set("visible",!1),this},onVisibleChange:function(e,t){t&&this._modifyPMC(e,!1)},onItemsChange:function(e){var t=this.find(function(e){return e.get("visible")});t&&t.get("id")==e.get("id")&&this._modifyPMC(t,!0)},onReset:function(){var e=this.find(function(e){return e.get("selected")});e?this.setVisible(e):i.reset()},_modifyPMC:function(t,n){var s=t.get("items"),o=e.map(s,function(e){return r.get(e)});n?i.reset(o,{silent:!0}).trigger("update"):i.reset(o)},getSelectedID:function(){var e=this.find(function(e){return e.get("selected")});return e?e.get("id"):undefined},getVisibleID:function(){var e=this.find(function(e){return e.get("visible")});return e?e.get("id"):undefined},jumpToMedia:function(t,n){var r=this.get(t);if(r){this.setVisible(r);var i=r.get("items").indexOf(n);i>-1&&e.defer(function(){s.trigger("jumpto:index",i)})}return this},comparator:function(e){return e.get("name").toLowerCase()}});return new o}),define("ac785/ca252/bbd1e",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/a781b","ac785/f04be/c8b95","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/aeeec","ac785/ca252/ec425","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/f6dac/ae2d1","ac785/f6dac/d4236","ac785/f6dac/d17c3"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=t.extend({parse:function(e){f.set({id:e.id,name:e.name,description:e.description,welcome:e.welcome,custom:e.custom,lounge:e.lounge,ownerID:e.owner,ownerName:e.ownerName,staff:e.staff,boothLocked:e.boothLocked,boothCycle:e.boothCycle,joined:!0,joinTime:Date.now(),users:{},extraUsers:{}},{silent:!1}),this.parseAdmins(e.admins),this.parseAmbassadors(e.ambassadors),this.parseUsers(e.users),this.updateDJs(e.djs),this.parseVotes(e.votes),this.parseCurates(e.curates),this.updateRelationships(!0),a.set({mediaStartTime:d.convertUnixDateStringToNumberString(e.mediaStartTime),playlistID:e.playlistID,historyID:e.historyID,media:e.media?new u(e.media):undefined}),s.djAdvance(!0),n.trigger("djButton:update");if(e.custom){n.dispatch(new r(r.CUSTOM,e.custom));return}n.dispatch(new r(r.CUSTOM)),n.trigger("audience:draw",this.getAudience(!1))},parseState:function(e){f.set({id:e.id,name:e.name,description:e.description,welcome:e.welcome,custom:e.custom,lounge:e.lounge,ownerID:e.owner,ownerName:e.ownerName,staff:e.staff,boothLocked:e.boothLocked,boothCycle:e.boothCycle,joined:!0,joinTime:Date.now()});var t=!1;a.get("media")&&!e.media?t=!0:!a.get("media")&&e.media?t=!0:a.get("media")&&e.media&&(a.get("media").get("cid")!=e.media.cid||a.get("historyID")!=e.historyID)&&(t=!0),t?a.set({mediaStartTime:d.convertUnixDateStringToNumberString(e.mediaStartTime),playlistID:e.playlistID,historyID:e.historyID,media:new u(e.media)}):a.set({mediaStartTime:d.convertUnixDateStringToNumberString(e.mediaStartTime),playlistID:e.playlistID,historyID:e.historyID}),this.parseAdmins(e.admins),this.parseAmbassadors(e.ambassadors);var r=e.users.length,i={};while(r--)i[e.users[r].id]=e.users[r],this.userJoin(e.users[r]);var o=f.get("users");for(var l in o)i[l]?o[l].set(i[l]):this.userLeave(l);this.updateDJs(e.djs),this.parseVotes(e.votes),this.parseCurates(e.curates),this.updateRelationships(!0),s.djAdvance(!0),n.trigger("djButton:update")},parseUsers:function(e){f.addUser(l);var t=e.length;while(t--)this.getOrCreateUserModel(e[t])},updateDJs:function(e){var t=[],n=e.length;for(var r=0;r<n;++r)t.push(this.getOrCreateUserModel(e[r].user));o.length>0&&(t.length==0||t[0].get("id")!=o.at(0).get("id"))&&o.trigger("toAudience",o.at(0)),o.reset(t)},getOrCreateUserModel:function(e,t){var n=f.getUserByID(e.id);return n?f.get("extraUsers")[e.id]&&!t&&(f.addUser(n),f.get("extraUsers")[e.id]=undefined,delete f.get("extraUsers")[e.id]):(n=new c(e),f.addUser(n,t)),n},parseVotes:function(e){f.set({votes:e},{silent:!0});for(var t in e){var n=f.getUserByID(t);n&&n.set("vote",e[t])}},parseCurates:function(e){f.set({curates:e},{silent:!0});for(var t in e){var n=f.getUserByID(t);n&&n.set("curated",e[t])}},parseAdmins:function(e){var t=e.length,n={};while(t--)n[e[t]]=!0;f.set("admins",n,{silent:!0})},parseAmbassadors:function(e){f.set("ambassadors",e,{silent:!0})},updateRelationships:function(e){var t=f.get("users"),n=l.get("id");for(var r in t)if(r!=n){var i=t[r],s=i.get("relationship"),u=l.getRelationship(r);if(s!=u){var a;e||o.getDJByID(r)?a=!0:a=!(u==3&&s!=3||s==0&&u>0||s>0&&u==0),i.set("relationship",u,{silent:a})}}this.updatePriorities()},updatePriorities:function(){var e,t,n=[],r=[],i=[],s=[],o=f.get("users");for(var u in o){var a=o[u];u==l.get("id")?e=a:u==f.get("ownerID")&&!f.get("admins")[u]?t=a:f.get("admins")[u]?r.push(a):f.get("ambassadors")[u]?i.push(a):f.get("staff")[u]?s.push(a):n.push(a)}r.sort(h.relationship),i.sort(h.relationship),s.sort(h.relationship),n.sort(h.relationship),t&&r.push(t);var c=r.concat(i).concat(s).concat(n);c.unshift(e);var p=c.length;for(var d=0;d<p;++d)o[c[d].get("id")].set("priority",d,{silent:!0})},getAudience:function(e){var t=[],n=[],r,i=f.get("users");for(var s in i){var u=i[s];if(o.length==0||o.at(0).get("id")!=s)u==l?r=u:u.get("permission")>0?n.push(u):t.push(u)}return e?t.sort(h.username):t.sort(h.relationship),n.sort(h.permission),t=n.concat(t),r&&t.unshift(r),t},userJoin:function(e){var t=this.getOrCreateUserModel(e);this.updateRelationships(!0),n.trigger("user:join",t)},userLeave:function(e){n.trigger("user:leave",e),f.removeUser(e),s.userLeave(e)},userUpdate:function(e){var t=f.getUserByID(e.id);if(t){var n;e.username!=t.get("username")&&(p.remove(t.get("username")),n=!0),c.STAFF_AVATAR&&t.get("permission")>0&&t.get("permission")<5&&(e.oldAvatarID=e.avatarID,e.avatarID=f.get("id")),t.set(e),n&&(p.add(t),t.get("id")==f.get("ownerID")&&f.set("ownerName",t.get("username")))}}});return new v}),define("ac785/e734f/aa464/b32f7",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.userID=e,this.index=t,this._super()},execute:function(){t.execute("moderate.move_dj",this,this.userID,this.index)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/e9abd/b7cfa",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t,n){this.id=e,this.locked=t,this.clear=n,this._super()},execute:function(){t.execute("room.lock_booth",this,this.id,this.locked,this.clear)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/f6dac/f643f",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/c672e","ac785/d94e0/e089a","ac785/d94e0/ac2bb","ac785/f04be/c8b95","ac785/ca252/ccfb5","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/b276e","ac785/ca252/deacc","ac785/ca252/ec425","ac785/ca252/c0f8f","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/ca252/bed74","ac785/ca252/a1027","ac785/e734f/aa464/b32f7","ac785/e734f/e9abd/b7cfa","ac785/f6dac/ae2d1"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T=e.clone(t.Events);return T.CHAT="chat",T.USER_SKIP="userSkip",T.USER_JOIN="userJoin",T.USER_LEAVE="userLeave",T.USER_FAN="userFan",T.FRIEND_JOIN="friendJoin",T.FAN_JOIN="fanJoin",T.VOTE_UPDATE="voteUpdate",T.CURATE_UPDATE="curateUpdate",T.ROOM_SCORE_UPDATE="roomScoreUpdate",T.DJ_ADVANCE="djAdvance",T.DJ_UPDATE="djUpdate",T.VOTE_SKIP="voteSkip",T.MOD_SKIP="modSkip",T.WAIT_LIST_UPDATE="waitListUpdate",T.CHAT_COMMAND="chatCommand",T.HISTORY_UPDATE="historyUpdate",T.ROLE={},T.ROLE.NONE=w.NONE,T.ROLE.RESIDENTDJ=w.DJ,T.ROLE.BOUNCER=w.BOUNCER,T.ROLE.MANAGER=w.MANAGER,T.ROLE.COHOST=w.COHOST,T.ROLE.HOST=w.HOST,T.ROLE.AMBASSADOR=w.AMBASSADOR,T.ROLE.ADMIN=w.ADMIN,T.STATUS={},T.STATUS.AVAILABLE=0,T.STATUS.AFK=1,T.STATUS.WORKING=2,T.STATUS.GAMING=3,T.enabled=!1,T.getUsers=function(){return T.enabled?b.map(function(e){return e.toJSON()}):[]},T.getUser=function(e){if(T.enabled){e||(e=y.get("id"));var t=m.getUserByID(e);if(t)return t.toJSON()}return{}},T.getAudience=function(){return T.enabled?g.getAudience().map(function(e){return e.toJSON()}):[]},T.getDJ=function(){return T.enabled?l.length==0?undefined:l.at(0).toJSON():[]},T.getStaff=function(){var t=[];if(T.enabled){var n=m.get("staff");for(var r in n){var i=b.get(r);i&&t.push(i)}return t.sort(x.permission),e.map(t,function(e){return e.toJSON()})}return t},T.getAdmins=function(){var t=[];if(T.enabled){var n=m.get("admins");for(var r in n){var i=b.get(r);i&&t.push(i)}return t.sort(x.username),e.map(t,function(e){return e.toJSON()})}return t},T.getAmbassadors=function(){var t=[];if(T.enabled){var n=m.get("ambassadors");for(var r in n){var i=b.get(r);i&&t.push(i)}return t.sort(x.username),e.map(t,function(e){return e.toJSON()})}return t},T.getHost=function(){if(T.enabled){var e=m.getUserByID(m.get("ownerID"));return e?e.toJSON():undefined}return{}},T.getMedia=function(){if(T.enabled){var e=d.get("media");if(e)return e.toJSON()}return undefined},T.getTimeElapsed=function(){return T.enabled?d.get("elapsed"):0},T.getTimeRemaining=function(){return T.enabled?d.get("remaining"):0},T.getWaitList=function(){return T.enabled?c.map(function(e){return e.toJSON()}):[]},T.getRoomScore=function(){return T.enabled?f.toJSON():{}},T.getHistory=function(){if(T.enabled)return h.map(function(e){return{user:e.get("user"),media:e.get("media").toJSON(),room:e.get("room")}})},T.hasPermission=function(e,t){if(T.enabled&&!isNaN(parseInt(t))&&t>-1&&t<11){if(!e)return y.hasPermission(t);var n=m.getUserByID(e);if(n)return n.hasPermission(t)}return!1},T.setVolume=function(e){T.enabled&&d.set("volume",~~Math.min(100,Math.max(0,e)))},T.getVolume=function(){if(T.enabled)return d.get("volume")},T.getWaitListPosition=function(e){if(T.enabled){e||(e=y.get("id"));var t=m.getUserByID(e);if(t)return c.getUserPosition(t)}return-1},T.setStatus=function(e){T.enabled&&(e=Math.max(0,Math.min(3,e)),n.dispatch(new o(o.UPDATE,undefined,e)))},T.sendChat=function(e){T.enabled&&e&&e.length>0&&u.sendChat(e.substr(0,255))},T.chatLog=function(e,t){T.enabled&&e&&e.length>0&&u.log(e.substr(0,255),t)},T.djJoin=function(){if(T.enabled){if(m.get("boothLocked")&&!y.hasPermission(w.DJ))return 2;if(l.length==51)return 4;var e=v.find(function(e){return e.get("selected")});if(!e||e.get("items").length==0)return 3;n.dispatch(new i(i.JOIN))}return 0},T.djLeave=function(){T.enabled&&l.isTheUserInBooth&&n.dispatch(new i(i.LEAVE))},T.getNextMedia=function(){if(T.enabled){var e=v.find(function(e){return e.get("selected")});if(e&&e.get("items").length>0){var t=p.get(e.get("items")[0]);if(t){var n=t.get("cid"),r=h.find(function(e){return e.get("media").get("cid")==n});return{media:t.toJSON(),inHistory:r&&r.length>0}}}}return undefined},T.getBannedUsers=function(){if(T.enabled&&y.hasPermission(w.MANAGER)){var e=[];return a.each(function(t){e.push(t.toJSON())}),e}return undefined},T.moderateForceSkip=function(){T.enabled&&y.hasPermission(w.BOUNCER)&&n.dispatch(new s(s.SKIP,l.currentDJ,d.get("historyID")))},T.moderateAddDJ=function(e){T.enabled&&y.hasPermission(w.BOUNCER)&&e!=y.get("id")&&!l.getDJByID(e)&&(!m.get("boothLocked")||y.hasPermission(w.MANAGER))&&n.dispatch(new s(s.ADD_DJ,e))},T.moderateRemoveDJ=function(e){T.enabled&&y.hasPermission(w.BOUNCER)&&e!=y.get("id")&&(l.getDJByID(e)||c.getUserPosition()!=-1)&&(!m.get("boothLocked")||y.hasPermission(w.MANAGER))&&n.dispatch(new s(s.REMOVE_DJ,e))},T.moderateBanUser=function(e,t){if(T.enabled){var r=m.getUserByID(e);r&&y.hasPermission(w.BOUNCER)&&e!=y.get("id")&&r.get("permission")<y.get("permission")&&n.dispatch(new s(s.BAN,e,t))}},T.moderateUnbanUser=function(e){if(T.enabled){var t=m.getUserByID(e);t&&y.hasPermission(w.MANAGER)&&e!=y.get("id")&&t.get("permission")<y.get("permission")&&n.dispatch(new s(s.UNBAN,e))}},T.moderateDeleteChat=function(e){T.enabled&&e&&y.hasPermission(w.BOUNCER)&&n.dispatch(new s(s.CHAT_DELETE,e))},T.moderateSetRole=function(e,t){if(T.enabled){var r=m.getUserByID(e);r&&!isNaN(t)&&t>-1&&(t<5||y.get("permission")==10)&&y.get("permission")>r.get("permission")&&n.dispatch(new s(s.PERMISSION,e,t))}},T.moderateLockWaitList=function(e,t){T.enabled&&y.hasPermission(w.MANAGER)&&e!=m.get("boothLocked")&&new S(m.get("id"),e,t)},T.moderateMoveDJ=function(e,t){T.enabled&&y.hasPermission(w.MANAGER)&&t>0&&t<l.length&&l.getDJByID(e)&&new E(e,t)},T.dispatch=function(t,n){T.enabled&&e.delay(function(){T.trigger(t,n)},250)},n.on("chat:command",function(e){T.trigger(T.CHAT_COMMAND,e)}),h.on("reset",function(){T.dispatch(T.HISTORY_UPDATE,T.getHistory())}),f.on("change",function(){T.dispatch(T.ROOM_SCORE_UPDATE,T.getRoomScore())}),c.on("add remove update",function(){T.dispatch(T.WAIT_LIST_UPDATE,T.getWaitList())}),window.API=T}),define("ac785/c3562/b2762",["underscore","socketio","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/f04be/c8b95","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/ac507/ac792","ac785/e734f/ac507/af94a","ac785/f6dac/f643f","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.extend({connected:!1,firstTime:!0,disconnectTime:Date.now(),init:function(t,n){this.options=t,this.options["max reconnection attempts"]=6,this.slug=n,this.connectBind=e.bind(this.onConnect,this),this.connectingBind=e.bind(this.onConnecting,this),this.disconnectBind=e.bind(this.onDisconnect,this),this.connectFailedBind=e.bind(this.onConnectFailed,this),this.reconnectBind=e.bind(this.onReconnect,this),this.reconnectingBind=e.bind(this.onReconnecting,this),this.reconnectFailedBind=e.bind(this.onReconnectFailed,this),this.errorBind=e.bind(this.onError,this),this.chatBind=e.bind(this.onChat,this),this.bucketBind=e.bind(this.onBucket,this),r.on("name:changed",this.nameChanged,this)},connect:function(){this.connected||(this.sio=t.connect("/room",this.options),this.sio.on("connect",this.connectBind),this.sio.on("connecting",this.connectingBind),this.sio.on("disconnect",this.disconnectBind),this.sio.on("connect_failed",this.connectFailedBind),this.sio.on("reconnect",this.reconnectBind),this.sio.on("reconnecting",this.reconnectingBind),this.sio.on("reconnect_failed",this.reconnectFailedBind),this.sio.on("error",this.errorBind),this.sio.on("chat",this.chatBind),this.sio.on("bucket",this.bucketBind))},onConnect:function(){this.connected||(console.log("sio","connect"),this.connected=!0,this.firstTime?(this.firstTime=!1,r.trigger("sio:connected")):(this.join(this.slug),r.trigger("sio:reconnected"),new f(this.slug,Date.now()-this.disconnectTime)))},onConnecting:function(e){console.log("sio","connecting",e)},onDisconnect:function(){console.log("sio","disconnect"),this.connected=!1,r.trigger("sio:reconnecting"),this.disconnectTime=Date.now(),new a(this.slug)},onReconnect:function(e,t){console.log("sio","reconnect",e,t)},onReconnecting:function(e,t){this.connected=!1,r.trigger("sio:reconnecting"),console.log("sio","attempting to re-connect to the server",e,t),t==6&&this.connectionError()},onConnectFailed:function(){console.log("sio","connect failed"),this.connected=!1,this.connectionError()},onReconnectFailed:function(){console.log("sio","reconnect failed"),this.connected=!1,this.connectionError()},onError:function(e){console.log("sio",e?e:"an unknown error occurred"),this.connected=!1,this.connectionError()},onChat:function(e){s.receive(e),l.dispatch(l.CHAT,e)},onBucket:function(e){},join:function(e){console.log("sio join",e),this.slug=e,this.sio&&this.connected&&this.sio.emit("join",e)},send:function(e){var t=Array.prototype.slice.call(arguments,1);this.sio.emit.apply(this.sio,arguments)},chat:function(e){this.connected&&this.sio.emit("chat",e)},nameChanged:function(){this.connected&&this.sio.emit("name_changed")},connectionError:function(){r.dispatch(new i(i.ALERT,h.alerts.connectionError,h.alerts.connectionErrorMessage,e.bind(c.forceRefresh,c),!0))},socketLog:function(e,t){o.hasPermission(u.ADMIN)&&(t?console.log(e,t):console.log(e))}});return window.socketioOpts&&window.Slug?new p(window.socketioOpts,window.Slug):undefined}),define("ac785/e734f/e9abd/e8ce2",["ac785/e734f/b669d","ac785/ca252/c512b","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n,r){var i=e.extend({init:function(){this._super(!0)},execute:function(){n.execute("history.select",this,t.get("id"))},parse:function(e){if(e.status==0){var t=e.data.length;while(t--)r.deserializeHistoryItem(e.data[t]);this.successCallback(e.data)}else this.onStatusError(e.status)}});return i}),define("ac785/b1ca1/a8750",["underscore","ac785/bc190/fea39","ac785/ca252/d83c7","ac785/ca252/b276e","ac785/ca252/de5df","ac785/ca252/aeeec","ac785/ca252/c512b","ac785/e734f/e9abd/e8ce2"],function(e,t,n,r,i,s,o,u){var a=t.extend({execute:function(){if(!a.synced&&!a.running){a.running=!0;var t=new u;t.successCallback=e.bind(this.onHistory,this),t.errorCallback=e.bind(this.onError,this)}else this.finish()},onHistory:function(e){var t=[],o=e.length;for(var u=0;u<o;++u)e[u].media=new s(e[u].media),t.push(new i(e[u]));a.synced=!0,a.running=!1,r.reset(t),n.trigger("change"),this.finish()},onError:function(){a.running=!1,a.synced=!1,this.finish()}});return a}),define("ac785/d94e0/fd72e",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="HistorySyncEvent",t.SYNC="HistorySyncEvent:sync",t}),define("ac785/d94e0/dcf27",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r,i,s){this._super(e),this.media=t,this.mediaStartTime=n,this.playlistID=r,this.historyID=i,this.replace=s}});return t._name="PlayMediaEvent",t.PLAY="PlayMediaEvent:play",t}),define("ac785/d94e0/a7d9d",["ac785/d94e0/b584a"],function(e){var t=e.extend({});return t._name="UserListEvent",t.BANS="UserListEvent:bans",t.FAN_OF="UserListEvent:fanOf",t.FANS="UserListEvent:fans",t.STAFF="UserListEvent:staff",t}),define("ac785/e734f/bbe20/df1a5",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t,n){this._super(),this.auth=e,this.cid=t,this.duration=n},execute:function(){t.execute("duration.update",this,this.auth,this.cid,this.duration)},parse:function(e){this.auth=undefined,this.cid=undefined,this.duration=undefined,e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/ab6db/c8e12",["ac785/bc190/b96e1","ac785/ab6db/ffb2a"],function(e,t){var n=e.extend({write:function(e){t.lastModTime[e.name]=e},read:function(e){var n=t.lastModTime[e];return n?n:{name:null,modified:"0,0000000000"}},remove:function(e){delete t.lastModTime[e]}});return new n}),define("ac785/ab6db/e1b12",["ac785/bc190/b96e1","ac785/ab6db/ffb2a","ac785/ab6db/c8e12","ac785/ab6db/a4893","ac785/f6dac/d17c3"],function(e,t,n,r,i){var s=e.extend({modified:function(){return n.read("media").modified},write:function(e){if(e&&e.length>0){var i=e.length;while(i--){var s=e[i];s.active?t.media[s.id]=t.media[s.cid]=s:this.remove(s.id)}r.setItem("media",JSON.stringify(t.media)),n.write({name:"media",modified:e[e.length-1].modified}),r.setItem("lastModTime",JSON.stringify(t.lastModTime))}},read:function(){var e=[];for(var n in t.media)t.media[n].id==n&&e.push(t.media[n]);return e},remove:function(e){var n=t.media[e];n&&(delete t.media[n.cid],delete t.media[e])},lookup:function(e){return t.media[e]},select:function(e){var n=[],r=e.length;while(r--){var i=t.media[e[r]];i&&n.push(i)}return n.length>0?n:null},exists:function(e){var n=t.media[e];return n!=undefined},updateDuration:function(e,n){t.media[e]&&(t.media[e].duration=n,r.setItem("media",JSON.stringify(t.media)))},localSearch:function(e){var n=[];for(var r in t.playlist){var s=t.playlist[r].items,o=s.length;for(var u=0;u<o;++u){var a=t.media[s[u]];if(a&&a.author&&a.title&&(a.author.toLowerCase().indexOf(e)>-1||a.title.toLowerCase().indexOf(e)>-1)){var f={};f.media=i.clone(a),f.playlist={id:r,name:t.playlist[r].name},n.push(f);if(n.length==50)break}}if(n.length==50)break}return n.sort(this.playlistSort),n},playlistSort:function(e,t){var n=e.playlist.name.toLowerCase(),r=t.playlist.name.toLowerCase();return n>r?1:n<r?-1:0}});return new s}),define("ac785/ab6db/ca525",["ac785/bc190/b96e1","ac785/ab6db/ffb2a","ac785/ab6db/c8e12","ac785/ab6db/a4893","ac785/ab6db/e1b12","ac785/f6dac/d17c3"],function(e,t,n,r,i,s){var o=e.extend({init:function(){this.mediaLookup={};for(var e in t.playlist){this.mediaLookup[e]={};for(var n in t.playlist[e].items)this.mediaLookup[e][t.playlist[e].items[n]]=!0}},modified:function(){return n.read("playlists").modified||"0"},write:function(e){var i;if(e&&e.length>0){var s=e.length;while(s--){var o=e[s];if(o.active){t.playlist[o.id]=o,this.mediaLookup[o.id]={};for(var u in o.items)this.mediaLookup[o.id][o.items[u]]=!0}else i=!0,n.remove("playlist_"+o.id),this.deleteAllPlaylistMedia(o.id),delete t.playlist[o.id]}n.write({name:"playlists",modified:e[e.length-1].modified}),r.setItem("playlist",JSON.stringify(t.playlist)),r.setItem("lastModTime",JSON.stringify(t.lastModTime))}},update:function(e){if(e&&t.playlist[e.id]){t.playlist[e.id].items=[].concat(e.items),t.playlist[e.id].modified=e.modified,this.mediaLookup[e.id]={};for(var n in e.items)this.mediaLookup[e.id][e.items[n]]=!0;r.setItem("playlist",JSON.stringify(t.playlist))}},read:function(){var e=[];for(var n in t.playlist)e.push(t.playlist[n]);return e.sort(this.nameSort),e},nameSort:function(e,t){var n=e.name.toLowerCase(),r=t.name.toLowerCase();return n>r?1:n<r?-1:0},exists:function(e){return t.playlist[e]!=undefined},selected:function(){for(var e in t.playlist)if(e.selected)return e.id;return 0},firstMedia:function(e){var n=[],r=t.playlist[e];return r&&r.items.length>0&&(r.items.length>1?n=[r.items[0],r.items[1]]:n=[r.items[0]]),n},deletePlaylistMedia:function(e,n){var i=n.length;while(i--)this.mediaLookup[e]&&delete this.mediaLookup[e][n[i]];var s=[];i=n.length;while(i--)this.checkPermaDelete(n[i])&&s.push(n[i]);return s.length>0&&r.setItem("media",JSON.stringify(t.media)),s},deleteAllPlaylistMedia:function(e){delete this.mediaLookup[e];if(t.playlist[e]){var n=t.playlist[e].items,i=!1,s=n.length;while(s--)this.checkPermaDelete(n[s])&&(i=!0);i&&r.setItem("media",JSON.stringify(t.media))}},checkPermaDelete:function(e){var t=!1;for(var n in this.mediaLookup)if(this.mediaLookup[n][e]){t=!0;break}return t||i.remove(e),!t},getMedia:function(e){var n=t.playlist[e].items,r=n.length,i=[];for(var o=0;o<r;++o)i.push(s.clone(t.media[n[o]]));return i},getMissing:function(){var e={};for(var n in t.playlist){var r=t.playlist[n].items,i=r.length;while(i--)t.media[r[i]]||(e[r[i]]=!0)}var s=[];for(var o in e)s.push(o);return s},getFilteredMedia:function(e,n){if(n.length>0){var r=t.playlist[e].items,i=r.length,o=[];for(var u=0;u<i;++u){var a=t.media[r[u]];a&&a.author&&a.title&&(a.author.toLowerCase().indexOf(n)>-1||a.title.toLowerCase().indexOf(n)>-1)&&o.push(s.clone(a))}return o}return this.read(e)},lookupMedia:function(e,n){var r=t.playlist[e].items,i=r.length,s=0;for(var o=0;o<i;++o){var u=t.media[r[o]];if(u.title.indexOf(n)==0){s=u.id;break}}return s}});return new o}),define("ac785/f6dac/d62c4",["ac785/bc190/b96e1","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/ab6db/ffb2a","ac785/f6dac/c1354","ac785/f6dac/d17c3"],function(e,t,n,r,i,s,o){var u=e.extend({init:function(){this.rows=22,this.columns=196,this.cellSize=10,this.backScale=.4,this.random=new s,this.defaultInvalidation(),this.clear()},defaultInvalidation:function(){this.invalidationArray=[]},clear:function(){this.zones=[],this.priorityGrid=[];var e,t,n,r;for(e=0;e<this.rows;++e){var i=[];for(t=0;t<this.columns;++t)i.push(100);this.priorityGrid.push(i)}this.userCount=0,this.userMap={},this.addZone(1,{x:0,y:0,w:this.columns,h:this.rows-12}),this.addZone(2,{x:0,y:this.rows-12,w:this.columns,h:6}),this.addZone(3,{x:0,y:this.rows-5,w:this.columns,h:3}),this.addZone(4,{x:this.columns*(3/8),y:this.rows-4,w:this.columns/4,h:2}),this.addZone(5,{x:~~(this.columns/2)-1,y:this.rows-1,w:1,h:1});var s=(1-this.backScale)/this.rows;for(e=0;e<this.rows;++e){n=o.quadEaseOut(e,0,1-this.backScale,this.rows),r=~~(n*this.columns/2);var u=this.columns-2*r-4;for(t=0;t<u;++t)t<u/2?n=o.quadEaseOut(t,50,50,u/2):n=o.quadEaseIn(t-u/2,100,-50,u/2),this.setCellPriority(e,t+r+2,n);this.invalidateCellsInBounds({x:0,y:e,w:r+2,h:1}),this.invalidateCellsInBounds({x:this.columns-r-2,y:e,w:r+2,h:1})}this.invalidateCellsInBounds({x:0,y:this.rows-1,w:~~(this.columns/2)-1,h:1}),this.invalidateCellsInBounds({x:~~(this.columns/2)+1,y:this.rows-1,w:~~(this.columns/2)-1,h:1}),this.invalidateRoomElements()},invalidateRoomElements:function(){var e=this.invalidationArray.length;while(e--)this.invalidateCellsInBounds(this.invalidationArray[e])},addZone:function(e,t){this.zones.push({id:e,bounds:t})},addUser:function(e){if(!this.userMap[e.get("id")]){if(this.userCount<(i.settings.avatarcap||150)){var t=[],n=this.getZone(e);do t=this.getCellsInZone(n--);while(t.length==0&&n>0);if(t.length==0){n=4;do t=this.getCellsInZone(n--);while(t.length==0&&n>0);if(t.length==0)return!1}var r=this.getPosition(t);e.set("_position",r),this.userMap[e.get("id")]=e,++this.userCount,this.invalidateCellAt(r.r,r.c);for(var s=1;s<=4;++s)this.decrementCellsInBounds({x:r.c-s,y:r.r-s*2,w:2*s+1,h:s*3});return!0}return!1}return-1},getHighestPriority:function(){var e=-1,t;for(var n in this.userMap){var r=this.userMap[n];r&&r.get("priority")>e&&(e=r.get("priority"),t=n)}return{id:t,priority:e}},getPosition:function(e){var t=[],n=[],r=[],i=e.length;while(i--){var s=this.getPriorityLevelForCellAt(e[i].r,e[i].c);s>69?t.push(e[i]):s>49?n.push(e[i]):s>24&&r.push(e[i])}return t.length>0?t[this.random.integer(0,t.length-1)]:n.length>0?n[this.random.integer(0,n.length-1)]:r.length>0?r[this.random.integer(0,r.length-1)]:e[this.random.integer(0,e.length-1)]},removeUser:function(e){if(this.userMap[e]){var t=this.userMap[e].get("_position");if(t){this.validateCellAt(t.r,t.c);var n;for(n=1;n<=4;++n)this.incrementCellsInBounds({x:t.c-n,y:t.r-n*2,w:2*n+1,h:n*3})}return this.userMap[e]=undefined,delete this.userMap[e],--this.userCount,!0}return!1},getZone:function(e){if(e.get("id")==n.get("id"))return 5;if(e.get("relationship")==3||t.getUserByID(e.get("id"))&&t.getUserByID(e.get("id")).hasPermission(r.VOLUNTEER))return 4;if(e.get("relationship")==2||e.get("relationship")==1)return 3;var i=this.random.float(0,1),s=e.getTotalPoints();return s<100?i>.75?2:1:s<300?i>.95?3:i>.65?2:1:s<700?i>.7?3:i>.5?2:1:s<1500?i>.55?3:i>.35?2:1:s<3e3?i>.4?3:i>.2?2:1:i>.3?3:2},getZoneIDsForCellAt:function(e,t){var n=[],r=this.zones.length;for(var i=0;i<r;++i){var s=this.zones[i];t>=s.bounds.x&&t<=s.bounds.x+s.bounds.w&&e>=s.bounds.y&&e<=s.bounds.y+s.bounds.h&&n.push(s.id)}return n},getCellsInZone:function(e,t){var n=[],r=this.zones.length;for(var i=0;i<r;++i){var s=this.zones[i];if(s.id==e){for(var o=s.bounds.y;o<s.bounds.y+s.bounds.h;++o)for(var u=s.bounds.x;u<s.bounds.x+s.bounds.w;++u)(this.getPriorityLevelForCellAt(o,u)>0||t)&&n.push({c:u,r:o});break}}return e==5&&!t&&n.length==0?this.getCellsInZone(e,!0):n},getPriorityLevelForCellAt:function(e,t){return Math.max(0,this.priorityGrid[e][t])},invalidateCellAt:function(e,t){this.priorityGrid[e][t]-=100},validateCellAt:function(e,t){this.priorityGrid[e][t]+=100},invalidateCellsInBounds:function(e){for(var t=e.y;t<e.y+e.h;++t){if(t<0||t>=this.rows)continue;for(var n=e.x;n<e.x+e.w;++n){if(n<0||n>=this.columns)continue;this.invalidateCellAt(t,n)}}},decrementCellsInBounds:function(e){for(var t=e.y;t<e.y+e.h;++t){if(t<0||t>=this.rows)continue;for(var n=e.x;n<e.x+e.w;++n){if(n<0||n>=this.columns)continue;this.decrementCellAt(t,n)}}},incrementCellsInBounds:function(e){for(var t=e.y;t<e.y+e.h;++t){if(t<0||t>=this.rows)continue;for(var n=e.x;n<e.x+e.w;++n){if(n<0||n>=this.columns)continue;this.incrementCellAt(t,n)}}},decrementCellAt:function(e,t){var n=this.getZoneIDsForCellAt(e,t).sort();this.priorityGrid[e][t]-=this.getAdjustment(n[n.length-1])},incrementCellAt:function(e,t){var n=this.getZoneIDsForCellAt(e,t).sort();this.priorityGrid[e][t]+=this.getAdjustment(n[n.length-1])},setCellPriority:function(e,t,n){this.priorityGrid[e][t]=n},getAdjustment:function(e){return e==5||e==4?45:e==3?30:e==2?25:15}});return new u}),define("ac785/f6dac/abcc8",["jquery"],function(e){var t=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},n=t(navigator.userAgent),r={};n.browser&&(r[n.browser]=!0,r.version=n.version);var i={};i.isMac=navigator.platform.toLowerCase().indexOf("mac")>-1,i.isChrome=navigator.userAgent.indexOf("Chrome")>-1,i.isSafari=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")==-1,i.isIE=r.msie,i.isFirefox=r.mozilla,i.isiOS=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?!0:!1,i.isAndroid=navigator.userAgent.indexOf("android")>-1,i.clipRender=i.isSafari||i.isMac&&i.isChrome;if(i.isiOS)e("body").addClass("ios");else if(i.isAndroid)e("body").addClass("android");else{i.isMac?e("body").addClass("osx"):e("body").addClass("win");var s;i.isChrome?s="chrome":i.isFirefox?s="firefox":i.isSafari?s="safari":i.isIE&&(s="ie"),e("body").addClass(s)}return i}),define("ac785/f6dac/ae40c",[],function(){var e=window.AvatarManifest;return window.AvatarManifest=undefined,delete window.AvatarManifest,e}),define("ac785/e734f/ea1d8/bd239",["ac785/d94e0/fb1a1","ac785/f04be/c8b95","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/c3562/d4511","ac785/e734f/b669d","lang/Lang"],function(e,t,n,r,i,s,o){var u=s.extend({init:function(e,t){this.value=e,this.userID=t,this._super(!0)},execute:function(){var e="user.follow";this.value||(e="user.unfollow"),i.execute(e,this,this.userID)},parse:function(e){if(e.status==0)this.value?(this.trigger("notify","icon-fan",o.messages.fan.split("%NAME%").join(e.data)),r.addFollowing(this.userID)):(this.trigger("notify","icon-unfan",o.messages.unfan.split("%NAME%").join(e.data)),r.removeFollowing(this.userID)),n.updateRelationships();else{var t;this.value?t=o.alerts.fan+e.status:o.alerts.unfan+e.status,this.alert(undefined,t)}}});return u}),define("hbs!template/dialogs/DialogBanUser",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="username"></span>\n<div class="divider"></div>\n<ul>\n    <li class="reason r1">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.ban,o==null||o===!1?o:o.reason1),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r2">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.ban,o==null||o===!1?o:o.reason2),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r3">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.ban,o==null||o===!1?o:o.reason3),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r4">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.ban,o==null||o===!1?o:o.reason4),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r5">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.ban,o==null||o===!1?o:o.reason5),typeof o===u?o.apply(t):o))+"</span>\n    </li>\n</ul>",s});return t.registerPartial("template_dialogs_DialogBanUser",n),n}),define("ac785/abf10/d9a0c/a36b6",["underscore","ac785/d94e0/e089a","ac785/f6dac/bf313","ac785/abf10/d9a0c/fbb95","hbs!template/dialogs/DialogBanUser","lang/Lang"],function(e,t,n,r,i,s){var o=r.extend({id:"dialog-ban-user",className:"dialog choice destructive",render:function(){return this.$el.append(this.getHeader(s.dialog.banUser)).append(this.getBody().append(i(s))).append(this.getButtons(s.dialog.banUser,!0)),this.$el.addClass("no-submit"),this.$(".username").text(this.options.user.get("username")),this.$(".reason").on("click",e.bind(this.onReasonClick,this)),this._super()},onReasonClick:function(e){var t=$(e.target);if(t.hasClass("radio")||t.hasClass("icon")||t.is("span"))t=t.parent();this.$(".reason").removeClass("selected"),t.addClass("selected"),this.$el.removeClass("no-submit")},submit:function(){if(this.$el.hasClass("no-submit"))return;var e;this.$("li.selected").hasClass("r1")?e=1:this.$("li.selected").hasClass("r2")?e=2:this.$("li.selected").hasClass("r3")?e=3:this.$("li.selected").hasClass("r4")?e=4:this.$("li.selected").hasClass("r5")&&(e=5),e&&(this.dispatch(new t(t.BAN,this.options.user.get("id"),e)),n.event("Moderation","Ban User")),this.close()},close:function(){this.options.user=undefined,this.$(".reason").off("click"),this._super()}});return o}),define("hbs!template/dialogs/DialogSkip",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="username"></span>\n<span class="media"></span>\n<div class="divider"></div>\n<ul>\n    <li class="reason r1">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.skip,o==null||o===!1?o:o.reason1),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r2">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.skip,o==null||o===!1?o:o.reason2),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r3">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.skip,o==null||o===!1?o:o.reason3),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r4">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.skip,o==null||o===!1?o:o.reason4),typeof o===u?o.apply(t):o))+'</span>\n    </li>\n    <li class="reason r5">\n        <div class="radio">\n            <i class="icon icon-active-rollover"></i>\n        </div>\n        <span>'+a((o=(o=t.skip,o==null||o===!1?o:o.reason5),typeof o===u?o.apply(t):o))+"</span>\n    </li>\n</ul>",s});return t.registerPartial("template_dialogs_DialogSkip",n),n}),define("ac785/abf10/d9a0c/cb766",["underscore","ac785/d94e0/e089a","ac785/f6dac/bf313","ac785/abf10/d9a0c/fbb95","hbs!template/dialogs/DialogSkip","lang/Lang"],function(e,t,n,r,i,s){var o=r.extend({id:"dialog-skip",className:"dialog choice destructive",render:function(){return this.$el.append(this.getHeader(s.dialog.skip)).append(this.getBody().append(i(s))).append(this.getButtons(s.dialog.skip,!0)),this.$el.addClass("no-submit"),this.$(".username").text(this.options.user.get("username")),this.$(".media").text(this.options.media.get("author")+" - "+this.options.media.get("title")),this.$(".reason").on("click",e.bind(this.onReasonClick,this)),this._super()},onReasonClick:function(e){var t=$(e.target);if(t.hasClass("radio")||t.hasClass("icon")||t.is("span"))t=t.parent();this.$(".reason").removeClass("selected"),t.addClass("selected"),this.$el.removeClass("no-submit")},submit:function(){if(this.$el.hasClass("no-submit"))return;var e;this.$("li.selected").hasClass("r1")?e=1:this.$("li.selected").hasClass("r2")?e=2:this.$("li.selected").hasClass("r3")?e=3:this.$("li.selected").hasClass("r4")?e=4:this.$("li.selected").hasClass("r5")&&(e=5),e&&(this.dispatch(new t(t.SKIP,this.options.user.get("id"),this.options.historyID)),n.event("Moderation","Force Skip")),this.close()},close:function(){this.options.user=undefined,this.$(".reason").off("click"),this._super()}});return o}),define("hbs!template/dialogs/DialogUserPermissions",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="avatar-thumb">\r\n    <div class="avitmb"></div>\r\n</div>\r\n<span class="name"></span>\r\n<div class="role-menu">\r\n    <div class="selected">\r\n        <i class="rank"></i>\r\n        <span></span>\r\n        <i class="icon icon-arrow-down-blue"></i>\r\n    </div>\r\n    <div class="menu">\r\n        <ul>\r\n            <li class="host">\r\n                <i class="icon icon-chat-host"></i>\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.host),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n            <li class="cohost">\r\n                <i class="icon icon-chat-host"></i>\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.cohost),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n            <li class="manager">\r\n                <i class="icon icon-chat-manager"></i>\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.manager),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n            <li class="bouncer">\r\n                <i class="icon icon-chat-bouncer"></i>\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.bouncer),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n            <li class="resident">\r\n                <i class="icon icon-chat-dj"></i>\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.dj),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n            <li class="none">\r\n                <span>'+a((o=(o=t.ranks,o==null||o===!1?o:o.none),typeof o===u?o.apply(t):o))+'</span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n<div class="divider"></div>\r\n<ul class="left">\r\n    <li class="hosts">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.cohosts),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.managers),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.bouncers),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.dj),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers bouncers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.chat),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.name),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.description),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.welcome),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n</ul>\r\n<ul class="right">\r\n    <li class="hosts cohosts managers bouncers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.add),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.lock),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.cycle),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers residentdjs">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.join),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers bouncers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.skip),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers bouncers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.ban),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n    <li class="hosts cohosts managers">\r\n        <span>'+a((o=(o=t.permissions,o==null||o===!1?o:o.unban),typeof o===u?o.apply(t):o))+'</span>\r\n        <i class="icon icon-check-blue"></i>\r\n    </li>\r\n</ul>',s});return t.registerPartial("template_dialogs_DialogUserPermissions",n),n}),define("ac785/abf10/d9a0c/f2528",["jquery","underscore","ac785/d94e0/e089a","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/f6dac/bf313","ac785/abf10/d9a0c/fbb95","hbs!template/dialogs/DialogUserPermissions","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=o.extend({id:"dialog-user-permissions",className:"dialog",initialize:function(){this._super(),this.permission=this.options.user.get("permission"),this.clickBind=t.bind(this.onClick,this)},render:function(){this.$el.append(this.getHeader(a.dialog.userPermissions)).append(this.getBody().append(u(a))).append(this.getButtons(a.dialog.ok,!0)),this.options.user.hasPermission(i.VOLUNTEER)?this.$el.addClass("is-ambassador"):this.options.user.hasPermission(i.DJ)&&this.$el.addClass("is-staff"),this.$(".name").text(this.options.user.get("username")),this.$(".avitmb").addClass("avitmb-"+this.options.user.get("avatarID"));var e=this;return t.defer(function(){e.initRoleMenu()}),this._super()},initRoleMenu:function(){r.hasPermission(i.ADMIN)||(r.hasPermission(i.HOST)||(this.$(".host").hide(),this.$(".cohost").hide()),r.hasPermission(i.COHOST)||this.$(".manager").hide(),r.hasPermission(i.MANAGER)||(this.$(".bouncer").hide(),this.$(".resident").hide())),this.$(".menu li").on("click",this.clickBind),this.$(".role-menu").on("mouseenter",t.bind(this.onMenuOver,this)).on("mouseleave",t.bind(this.onMenuOut,this));var e=this;t.defer(function(){e.update(e.options.user.get("permission"))})},onMenuOver:function(t){e(".role-menu .menu").show()},onMenuOut:function(t){e(".role-menu .menu").hide()},update:function(e){this.$(".hosts i").hide();var t;e==i.HOST?(this.$(".hosts i").show(),this.$(".role-menu .selected span").text(a.ranks.host),t="host"):e==i.COHOST?(this.$(".cohosts i").show(),this.$(".role-menu .selected span").text(a.ranks.cohost),t="host"):e==i.MANAGER?(this.$(".managers i").show(),this.$(".role-menu .selected span").text(a.ranks.manager),t="manager"):e==i.BOUNCER?(this.$(".bouncers i").show(),this.$(".role-menu .selected span").text(a.ranks.bouncer),t="bouncer"):e==i.DJ?(this.$(".residentdjs i").show(),this.$(".role-menu .selected span").text(a.ranks.dj),t="dj"):this.$(".role-menu .selected span").text(a.ranks.none),t?this.$(".role-menu .selected .rank").removeClass().addClass("rank icon icon-chat-"+t):this.$(".role-menu .selected .rank").removeClass().addClass("rank"),this.permission=e},onClick:function(t){var n=e(t.target);if(n.hasClass("icon")||n.is("span"))n=n.parent();n.hasClass("host")?this.update(i.HOST):n.hasClass("cohost")?this.update(i.COHOST):n.hasClass("manager")?this.update(i.MANAGER):n.hasClass("bouncer")?this.update(i.BOUNCER):n.hasClass("resident")?this.update(i.DJ):n.hasClass("none")&&this.update(i.NONE),this.onMenuOut(t)},submit:function(){if(this.permission!=this.options.user.get("permission")){var e=this.options.user.get("id");this.dispatch(new n(n.PERMISSION,e,this.permission)),s.event("Dialog","User Permissions",this.permission)}this.close()},close:function(){this.$(".menu li").off(),this.$(".role-menu .menu").off(),this.permission=undefined,this.options.user=undefined,this.clickBind=undefined,this.$description=undefined,this._super()}});return f}),define("hbs!template/room/user/UserPanel",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="user">\r\n    <div class="avatar-thumb">\r\n        <div class="avitmb"></div>\r\n    </div>\r\n    <i class="rank"></i>\r\n    <span class="name"></span>\r\n    <i class="status"></i>\r\n    <span class="status"></span>\r\n    <span class="joined"></span>\r\n</div>\r\n<div class="score">\r\n    <div class="points">\r\n        <span class="value"></span>\r\n        <span class="label">'+a((o=(o=t.userPanel,o==null||o===!1?o:o.points),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div class="fans">\r\n        <span class="value"></span>\r\n        <span class="label">'+a((o=(o=t.userPanel,o==null||o===!1?o:o.fans),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n</div>\r\n<div class="actions">\r\n    <div class="action skip">\r\n        <i class="icon icon-skip"></i>\r\n    </div>\r\n    <div class="action fan">\r\n        <i class="icon icon-fan"></i>\r\n    </div>\r\n    <div class="action mention">\r\n        <i class="icon icon-mention"></i>\r\n    </div>\r\n    <div class="action mod-dj">\r\n        <i class="icon icon-join-booth"></i>\r\n    </div>\r\n    <div class="action mod-permissions">\r\n        <i class="icon icon-staff"></i>\r\n    </div>\r\n    <div class="action mod-ban">\r\n        <i class="icon icon-ban"></i>\r\n    </div>\r\n</div>\r\n<div class="arrow-down"></div>',s});return t.registerPartial("template_room_user_UserPanel",n),n}),define("ac785/abf10/e9abd/ea1d8/a04e5",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/c672e","ac785/d94e0/e089a","ac785/d94e0/bd874","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/b276e","ac785/ca252/ec425","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/ea1d8/bd239","ac785/f6dac/f643f","ac785/f6dac/ffe62","ac785/f6dac/bf313","ac785/f6dac/d17c3","ac785/abf10/d9a0c/a36b6","ac785/abf10/d9a0c/cb766","ac785/abf10/d9a0c/f2528","hbs!template/room/user/UserPanel","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){var C=n.View.extend({id:"user-panel",template:T(N),initialize:function(){this.hidden=!0,this.user=null,this.popout=undefined,this.targetX=0,this.clickBind=t.bind(this.onAction,this),this.enterBind=t.bind(this.onEnter,this),this.leaveBind=t.bind(this.onHideTooltip,this),this.$modal=e("<div/>").addClass("user-panel-modal")},render:function(){return this.$el.html(this.template).on("mouseenter",t.bind(this.hide,this)),this.$thumb=this.$(".avitmb"),this.$username=this.$(".user span.name"),this.$joined=this.$(".joined"),this.$rank=this.$(".user i.rank"),this.$status=this.$(".user span.status"),this.$statusIcon=this.$(".user i.status"),this.$points=this.$(".points .value"),this.$fans=this.$(".fans .value"),this.$skip=this.$(".action.skip"),this.$fan=this.$(".action.fan"),this.$fanIcon=this.$(".action.fan i"),this.$mention=this.$(".action.mention"),this.$dj=this.$(".action.mod-dj"),this.$djIcon=this.$(".action.mod-dj i"),this.$permissions=this.$(".action.mod-permissions"),this.$ban=this.$(".action.mod-ban"),this.$(".action").on("click",this.clickBind).on("mouseenter",this.enterBind).on("mouseleave",this.leaveBind),this},showSimple:function(t,n){this.isSimple||(this.isSimple=!0);var r=t.get("id");if(!this.user||this.user.get("id")!=r){this.user=t,d.hasPermission(v.AMBASSADOR)&&(g.selectedUserID=r);var i=this.user.get("username");this.$username.text(i),this.$joined.text(w.convertNumberStringToMDY(this.user.get("dateJoined"),N.userPanel.joined)),this.$thumb.removeClass().addClass("avitmb avitmb-"+this.user.get("avatarID"));var s=this.user.get("status"),o="";s==0?(o+="available",this.$status.text(N.userStatus.available),this.$statusIcon.removeClass().addClass("icon icon-status-available status")):s==1?(o+="away",this.$status.text(N.userStatus.away),this.$statusIcon.removeClass().addClass("icon icon-status-away status")):s==2||s==3?(o+="working",this.$status.text(s==2?N.userStatus.working:N.userStatus.gaming),this.$statusIcon.removeClass().addClass("icon icon-status-working status")):s==4&&(o+="idle",this.$status.text(N.userStatus.idle),this.$statusIcon.removeClass().addClass("icon icon-status-idle status"));if(this.user.hasPermission(v.ADMIN))o+=" is-admin",this.$rank.removeClass().addClass("icon icon-chat-admin rank");else if(this.user.hasPermission(v.VOLUNTEER))o+=" is-ambassador",this.$rank.removeClass().addClass("icon icon-chat-ambassador rank");else if(this.user.hasPermission(v.DJ)){o+=" is-staff";var u="dj";this.user.hasPermission(v.COHOST)?u="host":this.user.hasPermission(v.MANAGER)?u="manager":this.user.hasPermission(v.BOUNCER)&&(u="bouncer"),this.$rank.removeClass().addClass("icon icon-chat-"+u+" rank")}else r==d.get("id")?(o+=" is-you",this.$rank.removeClass().addClass("rank")):o+=" is-none";if(r==d.get("id"))o+=" self";else if(d.hasPermission(v.MANAGER)){if(d.hasPermission(v.ADMIN)||d.hasPermission(v.LEADER)&&!this.user.hasPermission(v.COHOST)||d.hasPermission(v.AMBASSADOR)&&!this.user.hasPermission(v.MANAGER)||d.hasPermission(v.MANAGER)&&d.get("permission")>this.user.get("permission"))o+=" manager"}else d.hasPermission(v.BOUNCER)&&this.user.get("permission")==0&&(o+=" bouncer");p.get("boothLocked")&&(o+=" booth-locked");var l=this.user.getTotalPoints();if(r==f.currentDJ){l+=a.djPoints+a.curatePoints;if(r==d.get("id")||d.hasPermission(v.BOUNCER))o+=" current-dj"}else isNaN(a.listenerPoints[r])||(l+=a.listenerPoints[r]);this.$points.text(w.commafy(l)),this.$fans.text(w.commafy(this.user.get("fans"))),this.$el.removeClass().addClass(o)}return this.targetX=n.x,this.$el.css("left",n.x-this.$el.width()/2).css("top",n.y-this.$el.height()),this.popout?e(this.popout._window.document.body).append(this.$el):e("body").append(this.$el),this.hidden&&(this.$el.show(),this.hidden=!1),!0},showChat:function(e,t,n){this.popout=n,this.showSimple(e,t),this.showInfo(t.y)},showStaff:function(e,t,n){this.popout=n,this.showSimple(e,t),this.isSimple=!1,this.$el.addClass("expand staff").removeClass("current-dj");var r=this.user.get("id");r!=d.get("id")&&(d.getRelationship(r)>1?this.$fanIcon.removeClass().addClass("icon icon-unfan"):this.$fanIcon.removeClass().addClass("icon icon-fan")),this.positionInfo(t.y),this.showModal()},showInfo:function(e){this.isSimple=!1,this.$el.addClass("expand");var t=this.user.get("id");t!=d.get("id")&&(d.getRelationship(t)>1?this.$fanIcon.removeClass().addClass("icon icon-unfan"):this.$fanIcon.removeClass().addClass("icon icon-fan")),t!=d.get("id")&&d.hasPermission(v.BOUNCER)&&(f.getDJByID(t)?this.$djIcon.removeClass().addClass("icon icon-leave-booth"):l.getUserPosition(this.user)>-1?this.$djIcon.removeClass().addClass("icon icon-leave-waitlist"):f.length==0?this.$djIcon.removeClass().addClass("icon icon-join-booth"):l.isFull()?this.$djIcon.removeClass().addClass("icon icon-waitlist-full"):this.$djIcon.removeClass().addClass("icon icon-join-waitlist")),this.positionInfo(e),this.showModal()},positionInfo:function(t){if(!t){this.$el.css("left",this.targetX-this.$el.width()/2).removeClass("chat").removeClass("upwards");var n=0;this.$el.hasClass("current-dj")&&(n+=44),this.$el.hasClass("manager")&&(n+=44),this.$el.hasClass("self")||(n+=44),this.$el.css("top",this.$el.offset().top-n)}else{var r=0;t+this.$el.height()>e(window).height()-54?(r=this.$el.height()-46,this.$el.addClass("upwards")):this.$el.removeClass("upwards"),this.$el.css("left",this.targetX-(this.popout?0:this.$el.width()+3)).css("top",t-16-r).addClass("chat")}},showModal:function(){e("body").append(this.$modal);var n=y.getSize();this.$modal.width(n.width).height(n.height).show().on("click",t.bind(this.cleanup,this)),this.popout&&this.popout.showModal()},onAction:function(t){var n=e(t.target);n.hasClass("icon")&&(n=n.parent());if(n.hasClass("fan")){var i=this.$fanIcon.hasClass("icon-fan");b.event("User Panel",i?"Fan":"Unfan"),new m(i,this.user.get("id"))}else n.hasClass("mention")?(b.event("User Panel","@ Mention"),r.trigger("chat:mention",this.user.get("username"))):n.hasClass("skip")?d.get("id")==this.user.get("id")?(b.event("User Panel","Skip"),r.dispatch(new s(s.SKIP))):r.dispatch(new u(u.SHOW,new S({user:this.user,media:h.get("media"),historyID:h.get("historyID")}))):n.hasClass("mod-dj")?this.$djIcon.hasClass("icon-leave-booth")||this.$djIcon.hasClass("icon-leave-waitlist")?r.dispatch(new o(o.REMOVE_DJ,this.user.get("id"))):this.$djIcon.hasClass("icon-waitlist-full")||(b.event("Moderation","Add DJ"),r.dispatch(new o(o.ADD_DJ,this.user.get("id")))):n.hasClass("mod-ban")?r.dispatch(new u(u.SHOW,new E({user:this.user}))):n.hasClass("mod-permissions")&&(b.event("Moderation","User Permissions"),r.dispatch(new u(u.SHOW,new x({user:this.user}))));this.cleanup()},onEnter:function(t){if(!this.popout){var n=e(t.target);n.hasClass("icon")&&(n=n.parent());if(n.hasClass("fan")){var i=this.$fanIcon.hasClass("icon-fan");r.trigger("tooltip:show",i?N.tooltips.fan:N.tooltips.unfan,n)}else n.hasClass("mention")?r.trigger("tooltip:show",N.tooltips.mention,n):n.hasClass("skip")?d.get("id")==this.user.get("id")?r.trigger("tooltip:show",N.tooltips.selfSkip,n):r.trigger("tooltip:show",N.tooltips.modSkip,n):n.hasClass("mod-dj")?this.$djIcon.hasClass("icon-leave-booth")?r.trigger("tooltip:show",N.tooltips.modBoothRemove,n):this.$djIcon.hasClass("icon-leave-waitlist")?r.trigger("tooltip:show",N.tooltips.modWaitListRemove,n):this.$djIcon.hasClass("icon-join-waitlist")?r.trigger("tooltip:show",N.tooltips.modWaitListAdd,n):this.$djIcon.hasClass("icon-waitlist-full")?r.trigger("tooltip:show",N.tooltips.modWaitListFull,n):r.trigger("tooltip:show",N.tooltips.modBoothAdd,n):n.hasClass("mod-ban")?r.trigger("tooltip:show",N.tooltips.modBan,n):n.hasClass("mod-permissions")&&r.trigger("tooltip:show",N.tooltips.modPerm,n)}},onHideTooltip:function(){this.popout||r.trigger("tooltip:hide")},cleanup:function(){this.popout&&this.popout.hideModal(),this.$modal.hide().off("click").remove(),this.hide(!0)},hide:function(t){if(this.isSimple||t==1)this.$el.removeClass().hide(),e("body").append(this.$el),this.user=undefined,this.hidden=!0,this.popout=undefined,g.selectedUserID=undefined,r.trigger("tooltip:hide")},onAvatarClick:function(e){this.popout=undefined,this.user&&(this.user.get("id")!=d.get("id")||d.get("id")==f.currentDJ)&&this.showInfo()}});return new C}),define("hbs!template/room/Audience",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<canvas id="audience-canvas" width="805" height="207"></canvas>\r\n<canvas id="map-canvas" width="805" height="207"></canvas>'});return t.registerPartial("template_room_Audience",n),n}),define("ac785/abf10/e9abd/a97ff",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/a9a95","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ab6db/ffb2a","ac785/f6dac/d62c4","ac785/f6dac/d17c3","ac785/f6dac/abcc8","ac785/f6dac/ae40c","ac785/f6dac/c41ff","ac785/abf10/e9abd/ea1d8/a04e5","hbs!template/room/Audience"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=n.View.extend({id:"audience",WIDTH:805,HEIGHT:207,OFFSET_X:15,OFFSET_Y:50,initialize:function(){this.setRenderMode(l.clipRender),r.on("room:joining",this.onRoomJoin,this),this.clickBind=t.bind(p.onAvatarClick,p),this.moveBind=t.bind(this.onMouseMove,this)},render:function(){return this.$el.html(d()),this.canvas=document.getElementById("audience-canvas"),this.context=this.canvas.getContext("2d"),this.context.fillStyle="rgba(0,0,0,0)",this.imageMap=document.getElementById("map-canvas"),this.imageMapContext=this.imageMap.getContext("2d"),this.imageMapContext.fillStyle="rgba(0,0,0,0)",this.gridData=a,this.zoneColors=["#33007F","#80007F","#990000","#FF0000","#FFFF00"],this.initRoomElements(),this.frame=0,this.avatarImages={},this.images=[],this.full=!1,this.strobeOnSpeed=50,this.strobeOffSpeed=160,this.createColorLookup(),this.renderedFrames=[],this.avatarTheme="default",this.clear(!0),e(this.imageMap).hide(),this.$el.on("mousemove",this.moveBind).on("click",this.clickBind),this},createColorLookup:function(){this.colorLookup={},this.colorMap={};var e,t;for(var n=0;n<255;++n)e=37+n,e%170==0&&(e+=121),this.colorLookup[e]=n},initRoomElements:function(){this.defaultRoomElements()},disableRollovers:function(){this.imageMap&&(e(this.imageMap).remove(),this.imageMap=undefined,this.imageMapContext=undefined,this.$el.off("mousemove",this.moveBind).off("click",this.clickBind))},onRoomJoin:function(){this.defaultRoomElements(),this.clear()},defaultRoomElements:function(){this.roomElements=[]},onMouseMove:function(e){var t=this.$el.offset(),n=e.pageX-t.left,r=e.pageY-t.top,i=this.imageMapContext.getImageData(n,r,1,1);if(i.data[3]==255){var s,o=this.colorMap[this.colorLookup[i.data[1]*255+i.data[2]]];if(o){var u=o.length;for(var a=0;a<u;++a){var f=o[a];if(n>f.props.rect.l&&n<f.props.rect.r&&r>f.props.rect.t&&r<f.props.rect.b){s=f.user;break}}}s?(p.showSimple(s,{x:e.pageX,y:e.pageY-14}),this.$el.css("cursor","pointer")):(p.hide(!1),this.$el.css("cursor","default"))}else p.hide(!1),this.$el.css("cursor","default")},setRenderMode:function(e){e?this.renderFunc=this.renderClip:this.renderFunc=this.renderNoClip},onImageLoaded:function(){++this.loadCount,this.loadCount==this.images.length&&(this.sortZIndex(),this.refresh(),this.draw())},clear:function(e){this.gridData.clear(),this.userImageMap={},this.images=[],this.images=this.images.concat(this.roomElements),this.loadCount=e?0:this.roomElements.length,this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),u.settings.rollovers&&(this.imageMapContext.clearRect(0,0,this.WIDTH,this.HEIGHT),this.colorMap={}),this.full=!1,this.invisibleUsers=[],this.refresh()},refresh:function(){this.isRendered=!1,this.renderPass=0,this.renderedFrames=new Array(11)},draw:function(){var e;this.isRendered?this.update():(e=this.renderFunc(),e?++this.renderPass<12?u.settings.rollovers?this.renderedFrames[this.frame]={audience:this.context.getImageData(0,0,this.WIDTH,this.HEIGHT),map:this.imageMapContext.getImageData(0,0,this.WIDTH,this.HEIGHT)}:this.renderedFrames[this.frame]={audience:this.context.getImageData(0,0,this.WIDTH,this.HEIGHT)}:this.isRendered=!0:this.refresh())},update:function(){this.renderedFrames[this.frame]&&(this.context.putImageData(this.renderedFrames[this.frame].audience,0,0),u.settings.rollovers&&this.imageMapContext.putImageData(this.renderedFrames[this.frame].map,0,0))},renderClip:function(){this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),u.settings.rollovers&&this.imageMapContext.clearRect(0,0,this.WIDTH,this.HEIGHT);var e=this.images.length,t=!0;for(var n=0;n<e;++n){var r=this.images[n];if(r.image&&r.image.complete)if(r.user){var i=r.user.get("vote")==1?this.frame:0;this.context.save(),this.context.beginPath(),this.context.moveTo(r.props.x,r.props.y),this.context.lineTo(r.props.x+r.props.w,r.props.y),this.context.lineTo(r.props.x+r.props.w,r.props.y+r.props.h),this.context.lineTo(r.props.x,r.props.y+r.props.h),this.context.lineTo(r.props.x,r.props.y),this.context.closePath(),this.context.fill(),this.context.clip(),this.context.drawImage(r.image,r.props.x-r.props.w*i,r.props.y,r.props.sw,r.props.h),this.context.restore(),u.settings.rollovers&&(r.hitArea&&r.hitArea.complete?(this.imageMapContext.save(),this.imageMapContext.beginPath(),this.imageMapContext.moveTo(r.props.x,r.props.y),this.imageMapContext.lineTo(r.props.x+r.props.w,r.props.y),this.imageMapContext.lineTo(r.props.x+r.props.w,r.props.y+r.props.h),this.imageMapContext.lineTo(r.props.x,r.props.y+r.props.h),this.imageMapContext.lineTo(r.props.x,r.props.y),this.imageMapContext.closePath(),this.imageMapContext.fill(),this.imageMapContext.clip(),this.imageMapContext.drawImage(r.hitArea,r.props.x-r.props.w*i,r.props.y,r.props.sw,r.props.h),this.imageMapContext.restore()):t=!1)}else this.context.drawImage(r.image,r.props.x,r.props.y,r.props.w,r.props.h),u.settings.rollovers&&this.imageMapContext.drawImage(r.hitArea,r.props.x,r.props.y,r.props.w,r.props.h);else t=!1}return t},renderNoClip:function(){this.context.clearRect(0,0,this.WIDTH,this.HEIGHT),u.settings.rollovers&&this.imageMapContext.clearRect(0,0,this.WIDTH,this.HEIGHT);var e=this.images.length,t=!0;for(var n=0;n<e;++n){var r=this.images[n];if(r.image&&r.image.complete)if(r.user){var i=r.user.get("vote")==1?this.frame:0;this.context.save(),this.context.translate(r.props.x,r.props.y),this.context.scale(r.props.scale,r.props.scale),this.context.drawImage(r.image,r.props.ow*i,0,r.props.ow,r.props.oh,0,0,r.props.ow,r.props.oh),this.context.restore(),u.settings.rollovers&&(r.hitArea&&r.hitArea.complete?(this.imageMapContext.save(),this.imageMapContext.translate(r.props.x,r.props.y),this.imageMapContext.scale(r.props.scale,r.props.scale),this.imageMapContext.drawImage(r.hitArea,r.props.ow*i,0,r.props.ow,r.props.oh,0,0,r.props.ow,r.props.oh),this.imageMapContext.restore()):t=!1)}else this.context.drawImage(r.image,r.props.x,r.props.y,r.props.w,r.props.h),u.settings.rollovers&&this.imageMapContext.drawImage(r.hitArea,r.props.x,r.props.y,r.props.w,r.props.h);else t=!1}return t},addUser:function(e){if(!this.full){var t=this.gridData.addUser(e);t==1?(this.createUser(e),this.sortZIndex(),this.refresh(),this.draw()):t==0&&(this.full=!0)}if(this.full){var n=this.gridData.getHighestPriority();if(e.get("priority")<n.priority){var r=this.gridData.userMap[n.id];this.removeUser(n.id,!0),this.addUser(e),e=r}this.invisibleUsers.push(e),this.invisibleUsers.sort(this.prioritySort)}},prioritySort:function(e,t){return e.priority<t.priority?1:-1},removeUser:function(e,t){var n=this.gridData.removeUser(e);n&&(this.full=!1);var r;if(this.userImageMap[e]){r=this.images.length;while(r--)if(this.images[r]==this.userImageMap[e]){this.images.splice(r,1),--this.loadCount;break}u.settings.rollovers&&this.removeFromColorMap(e),this.userImageMap[e].user.off("change:avatarID",this.onAvatarChange,this).off("change:vote",this.onVoteChange,this),delete this.userImageMap[e],t||(this.refresh(),this.draw())}else{r=this.invisibleUsers.length;while(r--)if(this.invisibleUsers[r].id==e){this.invisibleUsers.splice(r,1);break}}!this.full&&!t&&this.invisibleUsers.length>0&&this.addUser(this.invisibleUsers.shift())},removeFromColorMap:function(e){var t=this.colorMap[this.userImageMap[e].color].length;while(t--)if(this.colorMap[this.userImageMap[e].color][t].user.get("id")==e){this.colorMap[this.userImageMap[e].color].splice(t,1);break}},createUser:function(e){e.on("change:avatarID",this.onAvatarChange,this).on("change:vote",this.onVoteChange,this);var t=e.get("_position").r,n=e.get("_position").c,r=(1-this.gridData.backScale)/this.gridData.rows,s=this.OFFSET_Y,o=.4,a=this.gridData.cellSize*o;for(var f=0;f<t;++f)o=r*f+this.gridData.backScale,a=this.gridData.cellSize*o,f<t&&(s+=a);var l=15+(this.WIDTH-30-this.gridData.cellSize*this.gridData.columns*o)/2,h;u.settings.rollovers&&(h=c.getHitSlot(e.get("avatarID"))||1);var p=this.userImageMap[e.get("id")]={user:e,avatarID:e.get("avatarID"),color:h,props:{x:~~(l+n*a+a/2-i.audience.w/2*o),y:~~(s+a/2-i.audience.h*o),w:i.audience.w*o,h:i.audience.h*o,sw:i.audience.sw*o,scale:o,ox:l+n*a+a/2-i.audience.w/2,oy:s+a/2-i.audience.h,ow:i.audience.w,oh:i.audience.h}};u.settings.rollovers&&(p.props.rect={l:Math.round(p.props.x+35*p.props.scale),t:Math.round(p.props.y+50*p.props.scale),r:Math.round(p.props.x+p.props.w-35*p.props.scale),b:Math.round(p.props.y+p.props.h-5*p.props.scale)},this.colorMap[String(h)]||(this.colorMap[String(h)]=[]),this.colorMap[String(h)].push(p)),this.avatarImages[e.get("avatarID")]?(p.image=this.avatarImages[e.get("avatarID")],u.settings.rollovers&&this.loadHitArea(p)):this.loadAvatar(p),this.images.push(this.userImageMap[e.get("id")])},onAvatarChange:function(e){if(this.userImageMap[e.get("id")]){var t=this.gridData.userMap[e.get("id")],n=t.get("_position").r,r=t.get("_position").c,s=(1-this.gridData.backScale)/this.gridData.rows,o=this.OFFSET_Y,a=.4,f=this.gridData.cellSize*a;for(var l=0;l<n;++l)a=s*l+this.gridData.backScale,f=this.gridData.cellSize*a,l<n&&(o+=f);var h=15+(this.WIDTH-30-this.gridData.cellSize*this.gridData.columns*a)/2;u.settings.rollovers&&this.removeFromColorMap(e.get("id"));var p=this.userImageMap[e.get("id")];p.avatarID=e.get("avatarID");var d;u.settings.rollovers&&(d=c.getHitSlot(p.avatarID)||1,p.color=d),p.props={x:~~(h+r*f+f/2-i.audience.w/2*a),y:~~(o+f/2-i.audience.h*a),w:i.audience.w*a,h:i.audience.h*a,sw:i.audience.sw*a,scale:a,ox:h+r*f+f/2-i.audience.w/2,oy:o+f/2-i.audience.h,ow:i.audience.w,oh:i.audience.h},u.settings.rollovers&&(p.props.rect={l:Math.round(p.props.x+35*p.props.scale),t:Math.round(p.props.y+50*p.props.scale),r:Math.round(p.props.x+p.props.w-35*p.props.scale),b:Math.round(p.props.y+p.props.h-5*p.props.scale)},this.colorMap[String(p.color)]||(this.colorMap[String(p.color)]=[]),this.colorMap[String(p.color)].push(p)),this.avatarImages[e.get("avatarID")]?(p.image=this.avatarImages[e.get("avatarID")],u.settings.rollovers&&this.loadHitArea(p,!0),u.settings.dancing||this.draw()):this.loadAvatar(p,!0)}},onVoteChange:function(e,t){if(this.userImageMap[e.get("id")]){var n=e.previousAttributes(),r=!1;n&&(n.vote==0||n.vote==-1&&t==1?r=!0:n.vote==1&&(r=!0)),r&&this.refresh()}},sortZIndex:function(){this.images.sort(function(e,t){var n=e.props.y+e.props.h,r=t.props.y+t.props.h;if(e.user&&t.user){if(e.user.get("id")==o.get("id"))return 1;if(t.user.get("id")==o.get("id"))return-1;e.user.get("priority")<t.user.get("priority")?n+=.5:e.user.get("priority")>t.user.get("priority")&&(n-=.5)}return n>r?1:n<r+r?-1:0});var e=this.images.length,t=null;while(e--)if(this.images[e].user&&this.images[e].user.get("id")==o.get("id")){t=e;break}if(t!=null){var n=this.images.splice(t,1)[0];n&&this.images.push(n)}e=this.images.length;while(e--)this.images[e].props.zindex=e;for(var r in this.colorMap)this.colorMap[r].sort(function(e,t){return e.props.zindex>t.props.zindex?1:e.props.zindex<t.props.zindex?-1:0})},loadAvatar:function(e,t){var n=new Image,r=this;n.onload=function(){r.onAvatarLoaded(this,e,t)},n.src=c.getAvatarUrl(this.avatarTheme,e.user.get("avatarID"),"")},onAvatarLoaded:function(e,t,n){t.image=e,u.settings.rollovers?this.loadHitArea(t,n):n?(this.refresh(),this.draw()):this.onImageLoaded()},loadHitArea:function(e,t){var n=new Image,r=String(e.color),i=this;n.onload=function(){i.onHitAreaLoaded(this,e,t)},n.src=c.getHitUrl(e.user.get("avatarID"),r)},onHitAreaLoaded:function(e,t,n){t.hitArea=e,n?(this.refresh(),this.draw()):this.onImageLoaded()},lightsOut:function(t){if(u.settings.rollovers)if(this.gridData.userCount>0||!t)return t?(e(this.canvas).hide(),e(this.imageMap).show(),this.strobeState=!1):(e(this.canvas).show(),e(this.imageMap).hide(),this.strobeState=!0),!0;return!1},strobeMode:function(e){return u.settings.rollovers,!1},strobeSwap:function(){u.settings.rollovers&&(this.lightsOut(this.strobeState),clearTimeout(this.strobeTimeoutID),this.strobeState?this.strobeTimeoutID=setTimeout(e.proxy(this.strobeSwap,this),this.strobeOnSpeed):this.strobeTimeoutID=setTimeout(e.proxy(this.strobeSwap,this),this.strobeOffSpeed))},drawGrid:function(){var e=(1-this.gridData.backScale)/this.gridData.rows,t=this.OFFSET_Y;for(var n=0;n<this.gridData.rows;++n){var r=e*n+this.gridData.backScale,i=this.gridData.cellSize*r,s=15+(this.WIDTH-30-this.gridData.cellSize*this.gridData.columns*r)/2;for(var o=0;o<this.gridData.columns;++o){var u=f.hexToRGB(this.getCellColor(n,o)),a=this.getCellAlpha(n,o);this.context.fillStyle="rgba("+u.red+", "+u.green+", "+u.blue+", "+a+")",this.context.fillRect(s+o*i,t,i-1,i-1)}t+=i}},getCellAlpha:function(e,t){return this.gridData.getPriorityLevelForCellAt(e,t)/100},getCellColor:function(e,t){var n=this.gridData.getZoneIDsForCellAt(e,t);return n.sort(),n.length>0?this.zoneColors[n[n.length-1]-1]:"#333333"}});return new v}),define("ac785/ca252/a985d",["backbone","ac785/ca252/a1027","ac785/f6dac/ae2d1"],function(e,t,n){var r=e.Collection.extend({model:t,comparator:n.permission});return new r}),define("ac785/ca252/b61cf",["underscore","backbone","ac785/ca252/a985d","ac785/ca252/a1027"],function(e,t,n,r){var i=t.Collection.extend({model:r,lastFilter:undefined,initialize:function(){n.on("reset",this.onReset,this)},onChange:function(){this.setFilter(this.lastFilter)},onReset:function(){this.setFilter()},setFilter:function(e){this.lastFilter=e,n.length>0?e?this.reset(n.filter(function(t){return t.get("username").toLowerCase().indexOf(e)>-1})):this.reset(n.toArray()):this.reset()}});return new i}),define("hbs!template/room/user/RoomStaffGroupRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-chat-',(o=n.rank)?o=o.call(t,{hash:{}}):(o=t.rank,o=typeof o===u?o.apply(t):o),s+=a(o)+'"></i>\n<span>',(o=n.group)?o=o.call(t,{hash:{}}):(o=t.group,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>",s});return t.registerPartial("template_room_user_RoomStaffGroupRow",n),n}),define("ac785/abf10/e9abd/ea1d8/fb665",["backbone","ac785/ca252/a1027","hbs!template/room/user/RoomStaffGroupRow","lang/Lang"],function(e,t,n,r){var i=e.View.extend({className:"group",render:function(){var e;return this.options.permission>=t.COHOST?e={rank:"host",group:r.userList.groupHosts}:this.options.permission==t.MANAGER?e={rank:"manager",group:r.userList.groupManagers}:this.options.permission==t.BOUNCER?e={rank:"bouncer",group:r.userList.groupBouncers}:e={rank:"dj",group:r.userList.groupDJs},this.$el.html(n(e)),this.$el.addClass(e.rank),this}});return i}),define("ac785/d94e0/a2e23",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r){this._super(e),this.user=t,this.pos=n,this.room=r}});return t._name="ShowUserPanelEvent",t.SHOW="ShowUserPanelEvent:show",t}),define("ac785/abf10/e9abd/ea1d8/a76eb",["jquery","backbone","ac785/bc190/cd0b8","ac785/d94e0/a2e23"],function(e,t,n,r){var i=t.View.extend({className:"user",events:{click:"onClick"},render:function(){return this.$el.html(e("<span/>").addClass("name").text(this.model.get("username"))),this},onClick:function(){n.dispatch(new r(r.SHOW,this.model,{x:e("#user-lists").offset().left,y:this.$el.offset().top+6,staff:!0},!0))},remove:function(){this._super(),this.off(),this.model=undefined,this.$el=undefined,this.el=undefined,delete this.$el,delete this.el}});return i}),define("ac785/abf10/bc8c0/e31ab",["backbone","ac785/f6dac/c1354","canvasloader"],function(e,t,n){var r=e.View.extend({className:"spinner",initialize:function(){var e=new t;this.id="spin-"+e.integer(1,4294967295).toString(16),this.$el.attr("id",this.id)},render:function(){return this.cl=new n(this.id,{id:this.id+"-canvas"}),this.cl.setColor(this.options.size.color),this.cl.setDiameter(this.options.size.diameter),this.cl.setDensity(this.options.size.density),this.cl.setRange(this.options.size.range),this.options.size.speed&&this.cl.setSpeed(this.options.size.speed),this.cl.show(),this.$el.width(this.options.size.diameter).height(this.options.size.diameter),this.$("#"+this.id+"-canvas").css("position","absolute").css("left",this.options.size.diameter/-2).css("top",this.options.size.diameter/-2),this},remove:function(){this.cl&&this.cl.kill(),this._super(),this.$el.empty(),this.id=undefined,this.cl=undefined,this.$el=undefined,this.el=undefined,this.options=undefined,delete this.cl}});return r.LARGE={color:"#eeeeee",diameter:100,density:100,speed:4,range:.9},r.MEDIUM={color:"#eeeeee",diameter:40,density:40,range:.9},r.SMALL={color:"#eeeeee",diameter:20,density:50,speed:3,range:.9},r}),define("ac785/abf10/e9abd/ea1d8/b0928",["jquery","backbone","ac785/ca252/b61cf","ac785/ca252/a1027","ac785/abf10/e9abd/ea1d8/fb665","ac785/abf10/e9abd/ea1d8/a76eb","ac785/abf10/bc8c0/e31ab"],function(e,t,n,r,i,s,o){var u=t.View.extend({className:"list staff",initialize:function(){this._super(),this.rows=[],this.groups={},this.drawBind=_.bind(this.drawRow,this)},render:function(){n.on("reset",this.onCollectionReset,this),this.onCollectionReset(),n.length==0&&this.showSpinner(),_.delay(_.bind(this.checkForZero,this),250),u.showing=!0},remove:function(){this._super(),n.off("reset",this.onCollectionReset,this),this.clear(),this.off(),this.rows=undefined,this.groups=undefined,this.$el=undefined,this.el=undefined,delete this.rows,delete this.groups,delete this.$el,delete this.el,u.showing=!1},checkForZero:function(){n.length==0&&this.hideSpinner()},onCollectionReset:function(){this.clear(),this.draw()},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.groups={},this.$el.empty(),this.hideSpinner()},showSpinner:function(){this.hideSpinner(),this.spinner=new o({size:o.MEDIUM}),this.$el.append(this.spinner.$el),this.spinner.render().$el.css("left","50%").css("top","40%").css("z-index",9999)},hideSpinner:function(){this.spinner&&(this.spinner.remove(),this.spinner=undefined)},draw:function(){n.each(this.drawBind)},drawRow:function(e){var t=e.get("permission");t==4&&(t=5),this.addGroupUser(t);var n=new s({model:e});this.$el.append(n.$el),this.rows.push(n),n.render()},addGroupUser:function(e){if(!this.groups[e]){var t=new i({permission:e});this.groups[e]=t,this.$el.append(t.$el),this.rows.push(t),t.render()}}});return u.showing=!1,u}),define("ac785/c3562/b2a8e",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/b1ca1/a8750","ac785/d94e0/fb1a1","ac785/d94e0/fd72e","ac785/d94e0/dcf27","ac785/d94e0/a045f","ac785/d94e0/a7d9d","ac785/f04be/c8b95","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/deacc","ac785/ca252/aeeec","ac785/ca252/ec425","ac785/ca252/c0f8f","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/bbe20/df1a5","ac785/ab6db/ffb2a","ac785/ab6db/e1b12","ac785/ab6db/ca525","ac785/f6dac/f643f","ac785/f6dac/d17c3","ac785/abf10/e9abd/a97ff","ac785/abf10/e9abd/ea1d8/b0928","ac785/abf10/e9abd/ea1d8/a04e5","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){var O=t.extend({init:function(e){this.socket=e},chat:function(e){f.receive(e),T.dispatch(T.CHAT,e)},skip:function(e){f.receive({type:"skip",message:A.messages.djSkip.split("%NAME%").join($("<span/>").text(e.username).html())}),T.dispatch(T.USER_SKIP,e.username)},userJoin:function(e){g.userJoin(e),T.dispatch(T.USER_JOIN,e)},userLeave:function(e){if(y.get("id")==e.id){n.dispatch(new u(u.JOIN,m.get("id")));return}var t=m.getUserByID(e.id);t&&T.dispatch(T.USER_LEAVE,t.toJSON()),g.userLeave(e.id)},userUpdate:function(e){g.userUpdate(e)},userCounterUpdate:function(e){var t=m.getUserByID(e.id);t&&t.set("fans",e.fans)},userFollow:function(e){f.receive({type:"update",message:A.messages.follow.split("%NAME%").join($("<span/>").text(e.un).html()),language:y.get("language")}),y.addFollower(e.id);var t=m.getUserByID(e.id);t&&T.dispatch(T.USER_FAN,t.toJSON())},followJoin:function(e){var t=m.getUserByID(e.id);e.r>1?(E.settings.fanJoin&&n.trigger("notify","icon-fans",A.messages.friendEnter.split("%NAME%").join(e.un)),e.r==3?y.addFriend(e.id):y.addFollowing(e.id),t&&T.dispatch(T.FRIEND_JOIN,t.toJSON())):(E.settings.fanJoin&&n.trigger("notify","icon-fans",A.messages.fanEnter.split("%NAME%").join(e.un)),y.addFollower(e.id),t&&T.dispatch(T.FAN_JOIN,t.toJSON()))},voteUpdate:function(e){l.voteUpdate(e);var t=m.getUserByID(e.id);t&&T.dispatch(T.VOTE_UPDATE,{user:t.toJSON(),vote:e.vote})},voteUpdateMulti:function(e){for(var t in e.votes){l.voteUpdate({id:t,vote:e.votes[t]});var n=m.getUserByID(e.id);n&&T.dispatch(T.VOTE_UPDATE,{user:n.toJSON(),vote:e.vote})}},curateUpdate:function(e){l.curateUpdate(e);var t=m.getUserByID(e.id);t&&T.dispatch(T.CURATE_UPDATE,{user:t.toJSON()})},djAdvance:function(t){var i;d.get("media")&&(i={dj:c.currentDJ?m.getUserByID(c.currentDJ):undefined,media:d.get("media")?N.clone(d.get("media")):undefined,score:l.toJSON()},l.earn(t.earn),E.settings.score&&c.currentDJ&&m.getUserByID(c.currentDJ)&&n.trigger("notify","icon-vote-woot-selected",A.messages.score.split("%DJ%").join(m.getUserByID(c.currentDJ).get("username")).split("%P%").join(l.get("positive")).split("%N%").join(l.get("negative")).split("%A%").join(l.get("curates")))),L.user&&L.user.get("id")==c.currentDJ&&L.hide(!0),t.djs=t.djs||[],g.updateDJs(t.djs),l.djAdvance(),n.dispatch(new o(o.PLAY,t.media?new p(t.media):undefined,N.convertUnixDateStringToNumberString(t.mediaStartTime),t.playlistID,t.historyID)),n.trigger("djButton:update").trigger("userPlaying:update"),C.strobeMode(!1),t.media&&c.currentDJ?(T.dispatch(T.DJ_ADVANCE,{dj:m.getUserByID(c.currentDJ)?m.getUserByID(c.currentDJ).toJSON():undefined,media:t.media,lastPlay:i}),E.settings.djAnnounce&&m.getUserByID(c.currentDJ)&&e.delay(function(){n.trigger("notify","icon-join-booth",A.messages.djAnnounce.split("%DJ%").join(m.getUserByID(c.currentDJ).get("username")).split("%MEDIA%").join(t.media.author+" - "+t.media.title))},1e3)):T.dispatch(T.DJ_ADVANCE,{lastPlay:i}),r.synced=r.running=!1,e.delay(function(){n.dispatch(new s(s.SYNC))},500)},djUpdate:function(e){(e.remove=="clear"||e.remove==y.get("id"))&&n.trigger("autojoin:clear"),g.updateDJs(e.djs),T.dispatch(T.DJ_UPDATE,T.getDJ())},boothLocked:function(e){m.get("boothLocked")!=e.locked&&f.receive({type:"moderation",from:e.moderator,message:e.locked&&e.clear?A.messages.waitListLockedClear:e.locked?A.messages.waitListLocked:A.messages.waitListUnlocked,language:y.get("language")}),m.set("boothLocked",e.locked),n.trigger("djButton:update")},boothCycle:function(e){m.get("boothCycle")!=e.cycle&&f.receive({type:"moderation",from:e.moderator,message:e.cycle?A.messages.djCycleEnabled:A.messages.djCycleDisabled,language:y.get("language")}),m.set("boothCycle",e.cycle),n.trigger("djButton:update")},roomNameUpdate:function(e){m.set("name",e)},roomDescriptionUpdate:function(e){m.set("description",e)},roomWelcomeUpdate:function(e){m.set("welcome",e)},roomVoteSkip:function(){f.receive({type:"skip",message:A.messages.roomSkip}),T.dispatch(T.VOTE_SKIP,undefined)},modSkip:function(e){f.receive({type:"moderation",from:e.moderator,message:A.moderation.skip,language:y.get("language")}),T.dispatch(T.MOD_SKIP,e.moderator)},modBan:function(e){f.receive({type:"moderation",from:e.moderator,message:A.moderation.ban.split("%NAME%").join($("<span/>").text(e.username).html()),language:y.get("language")}),n.trigger("mod:ban")},modAddDJ:function(e){c.length==0?f.receive({type:"moderation",from:e.moderator,message:A.moderation.addDJ.split("%NAME%").join($("<span/>").text(e.username).html()),language:y.get("language")}):this.modAddWaitList(e)},modRemoveDJ:function(e){e.userID==y.get("id")&&n.trigger("autojoin:clear"),e.currentDJ?f.receive({type:"moderation",from:e.moderator,message:A.moderation.removeDJ.split("%NAME%").join($("<span/>").text(e.username).html()),language:y.get("language")}):this.modRemoveWaitList(e)},modAddWaitList:function(e){f.receive({type:"moderation",from:e.moderator,message:A.moderation.addWaitList.split("%NAME%").join($("<span/>").text(e.username).html()),language:y.get("language")})},modRemoveWaitList:function(e){f.receive({type:"moderation",from:e.moderator,message:A.moderation.removeWaitList.split("%NAME%").join($("<span/>").text(e.username).html()),language:y.get("language")})},modMoveDJ:function(e){var t=m.getUserByID(e.userID);t&&f.receive({type:"moderation",from:e.moderator,message:A.moderation.moveDJ.split("%NAME%").join($("<span/>").text(t.get("username")).html()).split("%OLD%").join(e.old).split("%NEW%").join(e.index),language:y.get("language")})},modStaff:function(e){var t,r=e.users.length;while(r--){var i=m.getUserByID(e.users[r].user.id),s=e.users[r].permission;i&&(s==0?t=A.moderation.staffNone:s==1?t=A.moderation.staffDJ:s==2?t=A.moderation.staffBouncer:s==3?t=A.moderation.staffManager:s==4?t=A.moderation.staffCohost:s==5&&(t=A.moderation.staffHost),t&&f.receive({type:"moderation",from:e.moderator,message:t.split("%NAME%").join(N.cleanTypedString(e.users[r].user.username)),language:y.get("language")})),m.updateStaff(e.users[r].user,s),k.showing&&n.dispatch(new a(a.STAFF)),e.users[r].user.id==y.get("id")&&n.trigger("djButton:update")}},modAmbassador:function(e){var t=m.getUserByID(e.userID);e.rank>0?(m.get("ambassadors")[e.userID]=e.rank,t&&t.set("permission",e.rank)):(m.get("ambassadors")[e.userID]=undefined,delete m.get("ambassadors")[e.userID],t&&t.set("permission",m.get("staff")[e.userID]||0))},playlistCycle:function(e){N.deserializeModified(e),x.update(e);var t=v.get(e.id);t&&t.set("items",e.items)},djTrigger:function(e){if(d.get("media")&&c.currentDJ&&m.getUserByID(c.currentDJ)){var t=$("<span/>").text(m.getUserByID(c.currentDJ).get("username")).html();e==1&&C.lightsOut(!0)?f.chatLog(A.messages.lights.split("%NAME%").join(t)):e==2&&C.strobeMode(!0)?f.chatLog(A.messages.strobe.split("%NAME%").join(t)):e==0&&C.strobeMode(!1)}},requestDuration:function(t){var n=d.get("media");n&&n.get("cid")==t.cid.split(":").pop()?d.get("ytDuration")>0?new w(t.auth,t.cid,d.get("ytDuration")):(this.durationAuth=t.auth,this.durationCID=t.cid,e.delay(e.bind(this.requestDurationRetry,this),1e3)):new w(t.auth,t.cid,0)},requestDurationRetry:function(){new w(this.durationAuth,this.durationCID,d.get("ytDuration")),this.durationAuth=null,this.durationCID=null},durationUpdate:function(e){if(d.get("media").get("cid")==e.cid){console.log("override duration"),d.set("duration",e.duration),S.updateDuration(e.cid,e.duration);var t=h.find(function(t){return t.get("cid")==e.cid});t&&t.set("duration",e.duration)}},ping:function(e){y.get("permission")==10&&E.settings.showPings&&f.receive({type:"system",message:"Server: Ping Received "+N.getSimpleTimestamp(),language:y.get("language")}),this.socket.execute("user.pong",null)},pdjUpdate:function(){var t=E.settings.streamDisabled;n.dispatch(new o(o.PLAY)),d.set("streamDisabled",!0),E.settings.streamDisabled=t,E.saveSettings(),n.dispatch(new i(i.ALERT,A.alerts.update,A.alerts.updateMessage,e.bind(N.forceRefresh,N),!0))},pdjMessage:function(e){f.receive({type:"system",message:e,language:y.get("language")})},sessionClose:function(){console.log("sessionClose received"),this.socket.sessionClosed=!0;var e=E.settings.streamDisabled;n.dispatch(new o(o.PLAY)),d.set("streamDisabled",!0),E.settings.streamDisabled=e,E.saveSettings()},ban:function(e){window.location.href="/communities/?ref="+e.ref+"&reason="+encodeURIComponent(e.reason)+"&who="+encodeURIComponent(e.moderator)},chatDelete:function(e){e.username=e.moderator,f.onChatDelete(e)}});return O}),define("ac785/c3562/f9d8b",["underscore","sockjs","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/a045f","ac785/d94e0/bc747","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/c3562/b2762","ac785/c3562/b2a8e","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=n.extend({init:function(t){this.url=t,this.buffer=[],this.backoff=0,this.sessionClosed=!1,this.listener=new c(this),r.on("chat:send",e.bind(this.chat,this)).on("room:joined",e.bind(this.checkBuffer,this)).on("sio:connected",e.bind(this.dispatchJoin,this))},connect:function(){this.sockjs&&(this.sockjs.onopen=undefined,this.sockjs.onclose=undefined,this.sockjs.onmessage=undefined,this.sockjs=undefined),this.sockjs=new t(this.url),this.sockjs.onopen=e.bind(this.open,this),this.sockjs.onclose=e.bind(this.close,this),this.sockjs.onmessage=e.bind(this.message,this),this.rpcs={},this._rpc_id=1,this.buffer.length=0},send:function(e){this.sockjs.send(JSON.stringify(e))},sioJoin:function(e){l.join(e)},open:function(){this.backoff=0,this.connected=!0,console.log("sjs","connect"),l.connected?this.dispatchJoin():e.defer(function(){l.connect()})},dispatchJoin:function(){window.Slug?e.defer(function(){r.dispatch(new s(s.JOIN,window.Slug))}):e.defer(function(){r.dispatch(new o(o.UPDATE,u.get("id")))})},close:function(t){console.log("sjs","disconnect",t);if(t&&t.wasClean&&this.sessionClosed){r.dispatch(new i(i.ALERT,p.alerts.sessionExpired,p.alerts.sessionExpiredMessage,e.bind(h.forceRefresh,h),!0)),this.connected=!1;return}if(++this.backoff==6)r.dispatch(new i(i.ALERT,p.alerts.connectionError,p.alerts.connectionErrorMessage,e.bind(h.forceRefresh,h),!0));else{console.log("sjs","attempting to re-connect to the server",this.backoff);var n=this;e.delay(function(){n.connect()},Math.pow(2,n.backoff)*1e3)}},execute:function(e,t){var n=Array.prototype.slice.call(arguments).slice(2),r=this._rpc_id++;this.rpcs[r]=t,this.send({type:"rpc",id:r,name:e,args:n})},chat:function(e){l.chat({msg:e.message,chatID:e.chatID})},message:function(e){var t=JSON.parse(e.data);if(t.type&&t.type==="rpc"){var n=t.id;if(!n){this.socketLog(t,"no rpc id");return}var r=this.rpcs[n];if(!r){this.socketLog(t,"no responder");return}delete this.rpcs[n];if(t.status===999){this.socketLog(t),r.onFault(t.result);return}r.onResult({status:t.status,data:t.result});return}if(!u.get("joined")){this.buffer.push(t);return}this.handleMessage(t)},handleMessage:function(t){try{if(t.room&&t["room"]!=u.get("id")){this.socketLog(t,"room mismatch");return}var n=t.messages;if(!n){this.socketLog(t,"no messages");return}var r=n.length;for(var i=0;i<r;++i){var s=n[i].type,o=n[i].data;if(!this.listener[s]){console.error("UNKNOWN MESSAGE! ",n[i]);continue}if(s=="chat")continue;try{var a=e.bind(this.listener[s],this.listener);a(o)}catch(f){console.error(f)}}}catch(f){console.error(f)}},checkBuffer:function(){var e=this.buffer.length;for(var t=0;t<e;++t)this.handleMessage(this.buffer[t]);this.buffer.length=0},socketLog:function(e,t){a.hasPermission(f.ADMIN)&&(t&&console.log(t),e&&console.log(e))}}),v=window._ep;return window._ep=undefined,delete window._ep,v?new d(v):undefined}),define("ac785/e734f/fc65d/bb57b",["ac785/c3562/f9d8b","ac785/e734f/b669d","lang/Lang"],function(e,t,n){var r=t.extend({init:function(){this._super()},execute:function(){e.execute("booth.join",this)},parse:function(e){if(e.status==0)return;e.status==1?this.trigger("notify","icon-waitlist-full",n.alerts.waitListFull):e.status==2?this.trigger("notify","icon-booth-locked",n.alerts.lockedBooth):e.status==3&&this.trigger("notify","icon-playlist",n.alerts.playlistWithoutMedia),this.errorCallback&&this.errorCallback(),this.trigger("userPlaying:update")}});return r}),define("ac785/e734f/fc65d/e7530",["ac785/c3562/f9d8b","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(){this._super()},execute:function(){e.execute("booth.leave",this)},parse:function(e){e.status!=0&&(this.onStatusError(e.status),this.trigger("userPlaying:update"))}});return n}),define("ac785/e734f/fc65d/e1e32",["ac785/e734f/b669d","ac785/c3562/f9d8b"],function(e,t){var n=e.extend({init:function(){this._super()},execute:function(){t.execute("booth.skip",this)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/cdb20",["ac785/bc190/d22bb","ac785/d94e0/c672e","ac785/e734f/fc65d/bb57b","ac785/e734f/fc65d/e7530","ac785/e734f/fc65d/e1e32"],function(e,t,n,r,i){var s=e.extend({execute:function(){this.event.type==t.JOIN?new n:this.event.type==t.LEAVE?new r:this.event.type==t.SKIP&&new i}});return s}),define("ac785/e734f/a93fe/d94b2",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s){var o=t.extend({init:function(){this.callback=undefined,this.related=!1,this.importing=!1},load:function(t,n,r,i){this.callback=i,this.related=t.indexOf("/related?")>-1,this.importing=n==1&&r==1,t+="&start-index="+(n*r+1),t+="&max-results="+r,t+="&format=5",t+="&paid-content=false",t+="&callback=?",$.jsonp({url:t,success:e.bind(this.onComplete,this),error:e.bind(this.onError,this)})},onComplete:function(e){var t=e.feed.entry,i=[];if(t)try{var o=parseInt(e.feed.openSearch$startIndex.$t),u=t.length;for(var a=0;a<u;++a){var f=this.deserialize(t[a],o++);f.image&&f.format>0?i.push(f):--o}}catch(l){!this.related&&!this.importing&&n.dispatch(new r(r.ALERT,s.alerts.youtubeError,s.alerts.pleaseTryAgain))}this.callback(i)},deserialize:function(e,t){var n={};n.format=1,n.cid=e.media$group.yt$videoid.$t,e.media$group.media$credit&&e.media$group.media$credit.length&&e.media$group.media$credit[0].yt$display?n.author=e.media$group.media$credit[0].yt$display:e.author&&e.author.length&&e.author[0].name&&(n.author=e.author[0].name.$t),n.title=e.media$group.media$title.$t,n.duration=e.media$group.yt$duration.seconds||60,n.image=e.media$group.media$thumbnail[0].url;var r;if(e.yt$accessControl){r=e.yt$accessControl.length;while(r--)if(e.yt$accessControl[r].action=="embed"&&e.yt$accessControl[r].permission=="denied"){n.format=0;break}}n.index=t;var s=i.authorTitle(n.title);return n.author=s.author||n.author,n.title=s.title,n.id=n.cid,n},onError:function(e,t){console.log(e,t),!this.related&&!this.importing&&n.dispatch(new r(r.ALERT,s.alerts.youtubeError,s.alerts.pleaseTryAgain)),this.callback([])}});return o}),define("ac785/e734f/a93fe/b4e28",["jquery-jsonp","underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","lang/Lang"],function(e,t,n,r,i,s){var o=n.extend({load:function(e,t){this.username=e,this.callback=t,this.start=1,this.data=[],this.next()},next:function(){this.timeoutID&&clearTimeout(this.timeoutID),this.resultCount=0;var n="http://gdata.youtube.com/feeds/api/users/"+this.username+"/playlists?v=2&alt=json&start-index="+this.start+"&max-results=50&callback=?";e.jsonp({url:n,success:t.bind(this.onComplete,this),error:t.bind(this.onError,this)})},onComplete:function(e){var n=!0;try{this.deserialize(e)}catch(o){n=!1}if(n)if(this.resultCount>0)this.start+=50,this.timeoutID=setTimeout(t.bind(this.next,this),20);else{this.data.sort(this.sortByName);var u=this.username;t.each(this.data,function(e){e.username=u}),this.data.unshift({name:"Favorites",username:this.username}),this.callback(this.data)}else r.dispatch(new i(i.ALERT,s.alerts.youtubeError,s.alerts.pleaseTryAgain)),this.callback([])},sortByName:function(e,t){return e.name>t.name?1:e.name<t.name?-1:0},deserialize:function(e){var t=e.feed.entry;if(t){this.resultCount=t.length;for(var n=0;n<this.resultCount;++n)this.data.push({playlistID:t[n].yt$playlistId.$t,name:t[n].title.$t,count:t[n].yt$countHint.$t})}else this.resultCount=0},onError:function(e,t){console.log(e,t),r.dispatch(new i(i.ALERT,s.alerts.youtubeError,s.alerts.usernameNotFound)),this.callback([])}});return o}),define("ac785/e734f/a93fe/c3e84",["jquery-jsonp","underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o){var u=n.extend({init:function(e){this.timeoutID=0},load:function(e,t,n){this.query=e,this.favorites=t,this.callback=n,this.start=1,this.index=0,this.data=[],this.next()},next:function(){this.timeoutID&&clearTimeout(this.timeoutID),this.resultCount=0;var n=this.getURL()+"?v=2&alt=json&start-index="+this.start+"&max-results=50&format=5&paid-content=false&callback=?";e.jsonp({url:n,success:t.bind(this.onComplete,this),error:t.bind(this.onError,this)})},getURL:function(){return this.favorites?"http://gdata.youtube.com/feeds/api/users/"+encodeURIComponent(this.query)+"/favorites":"http://gdata.youtube.com/feeds/api/playlists/"+encodeURIComponent(this.query)},onComplete:function(e){var n=!0;try{this.deserialize(e)}catch(s){n=!1}n?this.resultCount>0?(this.start+=50,this.timeoutID=setTimeout(t.bind(this.next,this),20)):(this.eliminateDuplicates(),this.callback(this.data)):(r.dispatch(new i(i.ALERT,o.alerts.youtubeError,o.alerts.pleaseTryAgain)),this.callback([]))},deserialize:function(e){var t=e.feed.entry;if(t){this.resultCount=t.length;for(var n=0;n<this.resultCount;++n)try{var r=t[n],i,o;if(r.yt$accessControl){i=!1,o=r.yt$accessControl.length;while(o--)if(r.yt$accessControl[o].action=="embed"&&r.yt$accessControl[o].permission=="denied"){i=!0;break}if(i)continue}if(!r.media$group.media$thumbnail[0].url)continue;var u={};u.format=1,u.cid=r.media$group.yt$videoid.$t,r.media$group.media$credit&&r.media$group.media$credit.length&&r.media$group.media$credit[0].yt$display?u.author=r.media$group.media$credit[0].yt$display:r.author&&r.author.length&&r.author[0].name&&(u.author=r.author[0].name.$t),u.title=r.media$group.media$title.$t;var a=s.authorTitle(u.title);u.author=a.author||u.author,u.title=a.title,u.duration=r.media$group.yt$duration.seconds||60,u.image=r.media$group.media$thumbnail[0].url,u.index=this.index++,u.id=String(this.index),this.data.push(u)}catch(f){}}else this.resultCount=0},eliminateDuplicates:function(){this.hash={};var e=[],t=this.data.length;for(var n=0;n<t;++n){var r=this.data[n];this.hash[r.cid]||(this.hash[r.cid]=!0,e.push(r))}this.data=e},onError:function(e,t){console.log(e,t),this.callback([])}});return u}),define("ac785/f6dac/aa843",["jquery","underscore","ac785/bc190/cd0b8"],function(e,t,n){var r={};r.id="bd7fb07288b526f6f190bfd02b31b25e",r.cb="http://plug.dj/sccallback.html",r.r=!1;var i=0;return r.v=function(){if(window.SC){r.r=!0;try{window.SC.initialize({client_id:r.id,redirect_uri:r.cb}),r.sc=window.SC,n.trigger("sc:ready")}catch(e){}t.defer(function(){r.v=undefined,delete r.v})}else i++<40?(r.r=!1,t.delay(t.bind(r.v,r),250)):r.r=!0},r.g=function(){t.delay(function(){e("body").append(e("<script/>").attr("src","http://connect.soundcloud.com/sdk.js")),t.delay(t.bind(r.v,r),1e3)},100)},r}),define("ac785/e734f/e33f6/d0294",["jquery","underscore","ac785/bc190/b96e1","ac785/f6dac/aa843","ac785/f6dac/c41ff","ac785/f6dac/d17c3"],function(e,t,n,r,i,s){var o=n.extend({init:function(){this.callback=undefined},load:function(n,i,s,o){this.callback=o;var u,a;n.indexOf("https://soundcloud.com/")==0||n.indexOf("http://soundcloud.com/")==0?(u="https://api.soundcloud.com/resolve.json?client_id="+r.id+"&url="+encodeURIComponent(n)+"&callback=?",a=t.bind(this.onResolve,this)):(u="https://api.soundcloud.com/tracks.json?client_id="+r.id+"&q="+encodeURIComponent(n)+"&offset="+i*s+"&limit="+s+"&callback=?",a=t.bind(this.onComplete,this)),e.jsonp({url:u,success:a,error:t.bind(this.onError,this)})},onComplete:function(e){var t=e.length,n=[];for(var r=0;r<t;++r){var i=this.parse(e[r],r);i&&n.push(i)}this.callback(n)},onResolve:function(n){var i=[];if(n.kind==="track"){var s=this.parse(n,0);s&&i.push(s)}else if(n.kind==="user"){var o="https://api.soundcloud.com/tracks.json?client_id="+r.id+"&user_id="+n.id+"&limit=200&callback=?";e.jsonp({url:o,success:t.bind(this.onComplete,this),error:t.bind(this.onError,this)});return}this.callback(i)},parse:function(e,t){var n={};if(e.streamable)n.cid=e.stream_url.split("/")[4];else{if(!e.downloadable)return;n.cid=e.download_url.split("/")[4]}n.image=e.artwork_url||e.avatar_url||i.scThumbnail,n.duration=e.duration/1e3;if(e.user)n.author=e.user.username,n.title=e.title;else{var r=s.authorTitle(e.title);n.author=r.author||n.author,n.title=r.title}return n.format=2,n.id=n.cid,n},onError:function(e,t){console.log("SoundCloud Search Error"),this.callback([])}});return o}),define("ac785/e734f/e33f6/b2205",["ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/ab6db/e1b12","ac785/f6dac/aa843","ac785/f6dac/c41ff","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u){var a=e.extend({init:function(){this.callback=undefined,this.hasConnected=!1},load:function(e,r,s){this.callback=s;var o=this;this.hasConnected?i.sc.get("/me/favorites?offset="+e*r+"&limit="+r,{client_id:i.id,redirect_uri:i.cb},function(e,r){r?(o.hasConnected=!1,t.dispatch(new n(n.ALERT,u.alerts.soundcloudError,r.message+"<br/>"+u.alerts.pleaseTryAgain))):o.onComplete(e)}):this.auth(e,r)},auth:function(e,r){var s=this;i.sc.connect(function(){i.sc.get("/me/favorites?offset="+e*r+"&limit="+r,{client_id:i.id,redirect_uri:i.cb},function(e,r){r?(s.hasConnected=!0,t.dispatch(new n(n.ALERT,u.alerts.soundcloudError,r.message+"<br/>"+u.alerts.pleaseTryAgain))):(s.hasConnected=!0,s.onComplete(e))})})},onComplete:function(e){var t=e.length,n=[],i=[];for(var u=0;u<t;++u){var a=e[u],f={};if(a.streamable)f.cid=a.stream_url.split("/")[4];else{if(!a.downloadable)continue;f.cid=a.download_url.split("/")[4]}var l=r.lookup(f.cid);if(!l){f.image=a.artwork_url||a.avatar_url||s.scThumbnail,f.duration=a.duration/1e3;if(a.user)f.author=a.user.username,f.title=a.title;else{var c=o.authorTitle(a.title);f.author=c.author||f.author,f.title=c.title}f.format=2,f.id=f.cid,i.push(f)}else n.push(l)}this.callback(n.concat(i))},onError:function(){console.log("SoundCloud Favorites Error"),this.callback([])}});return a}),define("ac785/e734f/e33f6/e1a76",["jquery","underscore","ac785/bc190/b96e1","ac785/f6dac/aa843"],function(e,t,n,r){var i=n.extend({init:function(){this.callback=undefined},load:function(n,i){this.callback=i;var s="https://api.soundcloud.com/tracks/"+n+".json?client_id="+r.id+"&callback=?";e.jsonp({url:s,success:t.bind(this.onComplete,this),error:t.bind(this.onError,this)})},onComplete:function(e){e&&e.permalink_url?this.callback(e.permalink_url):this.callback()},onError:function(e,t){console.log("SoundCloud Permalink Error"),this.callback()}});return i}),define("ac785/e734f/e33f6/f213b",["ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/ab6db/e1b12","ac785/f6dac/aa843","ac785/f6dac/c41ff","ac785/f6dac/d17c3"],function(e,t,n,r,i,s,o){var u=e.extend({init:function(){this.callback=undefined,this.hasConnected=!1},load:function(e,r,s){this.callback=s;var o=this;this.hasConnected?i.sc.get("/me/tracks?offset="+e*r+"&limit="+r,{client_id:i.id,redirect_uri:i.cb},function(e,r){r?(o.hasConnected=!1,t.dispatch(new n(n.ALERT,Lang.alerts.soundcloudError,r.message+"<br/>"+Lang.alerts.pleaseTryAgain))):o.onComplete(e)}):this.auth(e,r)},auth:function(e,r){var s=this;i.sc.connect(function(){i.sc.get("/me/tracks?offset="+e*r+"&limit="+r,{client_id:i.id,redirect_uri:i.cb},function(e,r){r?(s.hasConnected=!0,t.dispatch(new n(n.ALERT,Lang.alerts.soundcloudError,r.message+"<br/>"+Lang.alerts.pleaseTryAgain))):(s.hasConnected=!0,s.onComplete(e))})})},onComplete:function(e){var t=e.length,n=[],i=[];for(var u=0;u<t;++u){var a=e[u],f={};if(a.streamable)f.cid=a.stream_url.split("/")[4];else{if(!a.downloadable)continue;f.cid=a.download_url.split("/")[4]}var l=r.lookup(f.cid);if(!l){f.image=a.artwork_url||a.avatar_url||s.scThumbnail,f.duration=a.duration/1e3;if(a.user)f.author=a.user.username,f.title=a.title;else{var c=o.authorTitle(a.title);f.author=c.author||f.author,f.title=c.title}f.format=2,f.id=f.cid,i.push(f)}else n.push(l)}this.callback(n.concat(i))},onError:function(){console.log("SoundCloud Tracks Error"),this.callback([])}});return u}),define("ac785/e734f/e33f6/b44be",["ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/ca252/aeeec","ac785/ab6db/e1b12","ac785/f6dac/aa843","ac785/f6dac/c41ff","ac785/f6dac/d17c3"],function(e,t,n,r,i,s,o,u){var a=e.extend({init:function(){this.callback=undefined,this.hasConnected=!1},load:function(e,r,i){this.callback=i;var o=this;this.hasConnected?s.sc.get("/me/playlists?offset="+e*r+"&limit="+r,{client_id:s.id,redirect_uri:s.cb},function(e,r){r?(o.hasConnected=!1,t.dispatch(new n(n.ALERT,Lang.alerts.soundcloudError,r.message+"<br/>"+Lang.alerts.pleaseTryAgain))):o.onComplete(e)}):this.auth(e,r)},auth:function(e,r){var i=this;s.sc.connect(function(){s.sc.get("/me/playlists?offset="+e*r+"&limit="+r,{client_id:s.id,redirect_uri:s.cb},function(e,r){r?(i.hasConnected=!0,t.dispatch(new n(n.ALERT,Lang.alerts.soundcloudError,r.message+"<br/>"+Lang.alerts.pleaseTryAgain))):(i.hasConnected=!0,i.onComplete(e))})})},onComplete:function(e){var t=e.length,n=[];for(var s=0;s<t;++s){var a={};a.title=e[s].title;var f=e[s].tracks.length,l=[],c=[];for(var h=0;h<f;++h){var p=e[s].tracks[h],d={};if(p.streamable)d.cid=p.stream_url.split("/")[4];else{if(!p.downloadable)continue;d.cid=p.download_url.split("/")[4]}var v=i.lookup(d.cid);if(!v){d.image=p.artwork_url||p.avatar_url||o.scThumbnail,d.duration=p.duration/1e3;if(p.user)d.author=p.user.username,d.title=p.title;else{var m=u.authorTitle(p.title);d.author=m.author||d.author,d.title=m.title}d.format=2,d.id=d.cid,c.push(new r(d))}else l.push(new r(v))}a.tracks=l.concat(c),a.tracks.length>0&&n.push(a)}this.callback(n)},onError:function(){console.log("SoundCloud Sets Error"),this.callback([])}});return a}),define("ac785/e734f/a3e81",["ac785/bc190/b96e1","ac785/e734f/a93fe/d94b2","ac785/e734f/a93fe/b4e28","ac785/e734f/a93fe/c3e84","ac785/e734f/e33f6/d0294","ac785/e734f/e33f6/b2205","ac785/e734f/e33f6/e1a76","ac785/e734f/e33f6/f213b","ac785/e734f/e33f6/b44be"],function(e,t,n,r,i,s,o,u,a){var f=e.extend({init:function(){this.ytSearchService=undefined,this.ytPlaylistService=undefined,this.ytImportService=undefined,this.scSearchService=undefined,this.scFavoritesService=undefined,this.scTracksService=undefined,this.scSetsService=undefined,this.scPermalinkService=undefined},ytSearch:function(e,n,r,i){var s="http://gdata.youtube.com/feeds/api/videos?v=2&alt=json&q="+encodeURIComponent(e);this.ytSearchService||(this.ytSearchService=new t),this.ytSearchService.load(s,n,r,i)},ytRelated:function(e,n){var r="http://gdata.youtube.com/feeds/api/videos/"+encodeURIComponent(e)+"/related?v=2&alt=json";this.ytSearchService||(this.ytSearchService=new t),this.ytSearchService.load(r,0,50,n)},ytPlaylist:function(e,t){this.ytPlaylistService||(this.ytPlaylistService=new n),this.ytPlaylistService.load(e,t)},ytPlaylistVideos:function(e,t){this.ytImportService||(this.ytImportService=new r),this.ytImportService.load(e,!1,t)},ytFavoriteVideos:function(e,t){this.ytImportService||(this.ytImportService=new r),this.ytImportService.load(e,!0,t)},scSearch:function(e,t,n,r){this.scSearchService||(this.scSearchService=new i),this.scSearchService.load(e,t,n,r)},scFavorites:function(e,t,n){this.scFavoritesService||(this.scFavoritesService=new s),this.scFavoritesService.load(e,t,n)},scTracks:function(e,t,n){this.scTracksService||(this.scTracksService=new u),this.scTracksService.load(e,t,n)},scSets:function(e,t,n){this.scSetsService||(this.scSetsService=new a),this.scSetsService.load(e,t,n)},scPermalink:function(e,t){this.scPermalinkService||(this.scPermalinkService=new o),this.scPermalinkService.load(e,t)}});return new f}),define("ac785/d94e0/c7cab",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r){this._super(e),this.name=t,this.items=n,this.curate=r}});return t._name="PlaylistCreateEvent",t.CREATE="PlaylistCreateEvent:create",t}),define("ac785/b1ca1/e09fd",["underscore","ac785/bc190/fea39","ac785/e734f/a3e81","ac785/f6dac/d17c3","ac785/f6dac/ffe62","ac785/d94e0/c7cab"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){this.pIndex=-1,this.sIndex=-1,this.items=[],this.hash={},this.bindSearch=e.bind(this.onSearch,this),this.bindNext=e.bind(this.nextSong,this),this.time=1,this.start=0,this.total=this.event.items.length,this.nextPlaylist()},nextPlaylist:function(){++this.pIndex<this.event.items.length?(this.sIndex=-1,this.items=[],this.hash={},this.nextSong()):this.finish()},nextSong:function(){var e=this.event.items[this.pIndex];if(++this.sIndex<e.items.length){var t=e.items[this.sIndex];$(".dialog-message").html(e.name+" "+(this.sIndex+1)+"/"+e.items.length+"<br/><br/>"+t.artist+" - "+t.name+"<br/>Estimated Time Remaining: -"+r.formatTime(~~(this.time*this.total--))),this.start=Date.now(),n.ytSearch(t.artist+" "+t.name,1,1,this.bindSearch)}else this.createPlaylist(e.name,this.items,1)},onSearch:function(t){t.length>0&&t[0].format!=0&&(this.hash[t[0].cid]||this.items.push(t[0]),this.hash[t[0].cid]=!0),this.time=50+(Date.now()-this.start)/1e3,e.delay(this.bindNext,50)},createPlaylist:function(e,t,n){if(t.length>0){var r=e;n>1&&(r+=" "+n);if(t.length<=200)this.dispatch(new s(s.CREATE,r,t)),this.nextPlaylist();else{var i=t.slice(0,200);this.dispatch(new s(s.CREATE,r,i)),t.splice(0,200),this.createPlaylist(e,t,++n)}}else this.nextPlaylist()},finish:function(){try{i.currentDialog.close()}catch(e){}this.pIndex=undefined,this.sIndex=undefined,this.items=undefined,this.hash=undefined,this.bindSearch=undefined,this.bindNext=undefined,this.time=undefined,this.start=undefined,this.total=undefined,this._super()}});return o}),define("hbs!template/dialogs/DialogiTunesLoading",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div id="dialog-import-itunes-progress">\r\n    <div id="dialog-import-itunes-progress-bar"></div>\r\n    <div id="dialog-import-itunes-progress-perc"></div>\r\n</div>'});return t.registerPartial("template_dialogs_DialogiTunesLoading",n),n}),define("ac785/d94e0/b5c70",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.items=t}});return t._name="ImportiTunesEvent",t.PARSE="ImportiTunesEvent:parse",t.IMPORT="ImportiTunesEvent:import",t}),define("ac785/abf10/d9a0c/e8843",["underscore","hbs!template/dialogs/DialogiTunesLoading","ac785/d94e0/fb1a1","ac785/d94e0/b5c70","ac785/f6dac/bf313","ac785/abf10/d9a0c/fbb95","lang/Lang"],function(e,t,n,r,i,s,o){var u=s.extend({id:"dialog-import-itunes",className:"dialog",initialize:function(){this._super(),this.items=undefined},render:function(){return this.$el.append(this.getHeader(o.dialog.itunesImport)).append(this.getBody().append(t())),this._super()},parsed:function(e){try{if(e.length>0){this.items=e;var t=$("<div/>").attr("id","dialog-itunes-container"),r=$("<ul/>"),i=e.length;for(var s=0;s<i;++s)r.append($("<li/>").append(this.getCheckBox(e[s].name+" ("+e[s].items.length+")","itp"+s)));t.append(r),this.$el.html(""),this.$el.append(this.getHeader(o.dialog.itunesImport)).append(this.getBody().append(this.getMessage(o.dialog.itunesPlaylists)).append(t)).append(this.getCancelButton()).append(this.getSubmitButton("Import"))}else this.dispatch(new n(n.ALERT,undefined,"No items"))}catch(u){this.dispatch(new n(n.ALERT,undefined,"No valid playlists found"))}},submit:function(){var e=[],t=this.items.length;for(var n=0;n<t;++n)$("#dialog-checkbox-itp"+n).attr("checked")&&e.push(this.context[n]);$(".dialog-button").hide(),$("#dialog-itunes-container").hide(),this.$el.css("height",190),this.dispatch(new r(r.IMPORT,e)),i.event("Dialog","Import iTunes",e.length)},close:function(){this.items=undefined,this._super()}});return u}),define("ac785/b1ca1/b7975",["ac785/bc190/d22bb","ac785/f6dac/ffe62","ac785/d94e0/bd874","ac785/abf10/d9a0c/e8843"],function(e,t,n,r){var i=e.extend({execute:function(){t.currentDialog instanceof r||this.dispatch(new n(n.SHOW,new r)),event.items&&t.currentDialog.parsed(event.items),this._super()}});return i}),define("ac785/b1ca1/d4828",["jquery","underscore","ac785/bc190/fea39","ac785/ca252/aeeec","ac785/e734f/a3e81","ac785/f6dac/d17c3","ac785/f6dac/ffe62","ac785/d94e0/c7cab"],function(e,t,n,r,i,s,o,u){var a=n.extend({execute:function(){this.index=-1,this.items=[],this.hash={},this.bindSearch=t.bind(this.onSearch,this),this.bindNext=t.bind(this.next,this),this.time=1,this.start=0,this.total=this.event.items.length,this.next()},next:function(){if(++this.index<this.event.items.length){var t=this.event.items[this.index];e(".dialog .import-progress-bar .progress-bar").width(Math.round(this.index/this.event.items.length*100)+"%"),e(".dialog .import-count").text(this.index+1+" / "+this.event.items.length),e(".dialog .import-item").text(t.artist+" - "+t.song),e(".dialog .import-time").text("Estimated Time Remaining: "+s.formatTime(~~(this.time*this.total--))),this.start=Date.now(),i.ytSearch(t.artist+" "+t.song,1,1,this.bindSearch)}else this.createPlaylist(this.items,1)},onSearch:function(e){e.length>0&&e[0].format!=0&&(e[0].id=String(this.index+1),this.hash[e[0].cid]||this.items.push(new r(e[0])),this.hash[e[0].cid]=!0),this.time=Math.max(1,Math.round((Date.now()-this.start+100)/1e3)),t.delay(this.bindNext,50)},createPlaylist:function(e,t){if(e.length>0){var n=this.event.name;t>1&&(n+=" "+t);if(e.length<=200)this.dispatch(new u(u.CREATE,n,e)),this.finish();else{var r=e.slice(0,200);this.dispatch(new u(u.CREATE,n,r)),e.splice(0,200),this.createPlaylist(e,++t)}}else this.finish()},finish:function(){try{e(".dialog").removeClass("importing"),o.currentDialog.close()}catch(t){}this.index=undefined,this.items=undefined,this.hash=undefined,this.bindSearch=undefined,this.bindNext=undefined,this.time=undefined,this.start=undefined,this.total=undefined,this._super()}});return a}),define("ac785/d94e0/c4bc0",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n){this._super(e),this.name=t,this.items=n}});return t._name="ImportTurntableEvent",t.IMPORT="ImportTurntableEvent:import",t}),define("ac785/f04be/b23bd",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/c7cab","ac785/ca252/aeeec","ac785/e734f/a3e81","ac785/ab6db/e1b12"],function(e,t,n,r,i,s,o){var u=t.extend({init:function(){this.updateCallback=undefined,this.data=[]},load:function(t){this.data=[],this.ytp=t,t.playlistID?s.ytPlaylistVideos(t.playlistID,e.bind(this.onComplete,this)):s.ytFavoriteVideos(t.username,e.bind(this.onComplete,this))},onComplete:function(e){this.ytResults=e;if(e.length>0){this.hash={};var t=e.length;for(var n=0;n<t;++n){var r=o.lookup(e[n].cid);r&&(this.hash[e[n].cid]=!0,this.data.push(new i(e[n])))}this.appendUnknown()}else this.updateCallback([])},appendUnknown:function(){var e=this.ytResults.length;for(var t=0;t<e;++t)this.hash[this.ytResults[t].cid]||this.data.push(new i(this.ytResults[t]));this.updateCallback(this.data)},"import":function(){if(this.data.length>0){var e=[];this.createPlaylist(e.concat(this.data),1)}},createPlaylist:function(e,t){if(e.length>0){var i=this.ytp.playlistID?this.ytp.name:"YouTube Favorites";t>1&&(i+=" "+t);if(e.length<=200)n.dispatch(new r(r.CREATE,i,e));else{var s=e.slice(0,200);n.dispatch(new r(r.CREATE,i,s)),e.splice(0,200),this.createPlaylist(e,++t)}}},onCIDResult:function(e){if(e){var t=e.length;for(var n=0;n<t;++n)this.hash[e[n].cid]=!0,this.data.push(new i(e[n]))}this.appendUnknown()}});return u.instance=new u,u}),define("ac785/ca252/a996a",["backbone","ac785/ca252/aeeec"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/b1ca1/a4f5a",["ac785/bc190/fea39","ac785/f04be/b23bd","ac785/ca252/a996a"],function(e,t,n){var r=e.extend({execute:function(){t.instance.updateCallback=_.bind(this.onMediaLoaded,this),t.instance.load(this.event.playlist),this._super()},onMediaLoaded:function(e){n.reset(e),this.finish()}});return r}),define("ac785/d94e0/d4a09",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.playlist=t}});return t._name="ImportYouTubeEvent",t.IMPORT="ImportYouTubeEvent:import",t}),define("ac785/ca252/a4f75",["backbone"],function(e){var t=e.Model.extend({defaults:{title:undefined,tracks:undefined}});return t}),define("ac785/ca252/baa5d",["backbone","ac785/ca252/a4f75"],function(e,t){var n=e.Collection.extend({model:t,selectedSet:undefined});return new n}),define("ac785/f04be/e84bd",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/e734f/a3e81","ac785/d94e0/c7cab","ac785/d94e0/fb1a1","lang/Lang","ac785/ca252/baa5d"],function(e,t,n,r,i,s,o,u){var a=t.extend({load:function(){u.reset(),u.selectedSet=undefined,r.scSets(0,200,e.bind(this.onComplete,this))},onComplete:function(e){u.reset(e)},importSelected:function(){this.createPlaylist(u.selectedSet.get("title"),u.selectedSet.get("tracks"),1),setTimeout(e.bind(this.importSelectedAlert,this),100)},importAll:function(){if(u.length>0){var t=this;u.each(function(e){t.createPlaylist(e.get("title"),e.get("tracks"),1)}),e.delay(e.bind(this.importAllAlert,this),100)}},createPlaylist:function(e,t,r){if(t.length>0){var s=e;r>1&&(s+=" "+r);if(t.length<=200)n.dispatch(new i(i.CREATE,s,t));else{var o=t.slice(0,200);n.dispatch(new i(i.CREATE,s,o)),t.splice(0,200),this.createPlaylist(e,t,++r)}}},importSelectedAlert:function(){n.trigger("notify","icon-import",o.alerts.playlistImporting.split("%PLAYLIST%").join(u.selectedSet.get("title")))},importAllAlert:function(){n.trigger("notify","icon-import",o.alerts.scSetsImporting)}});return new a}),define("ac785/ca252/c3969",["backbone","ac785/ca252/aeeec"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/ca252/f4f89",["backbone"],function(e){var t=e.Model.extend({defaults:{query:"",update:!1,disabled:!1,related:undefined,relatedHistory:[],relatedPlaylist:undefined}});return new t}),define("ac785/f04be/f1000",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/d94e0/c7cab","ac785/e734f/a3e81","ac785/ab6db/e1b12","ac785/ca252/aeeec","ac785/ca252/c3969","ac785/ca252/f4f89"],function(e,t,n,r,i,s,o,u,a){var f=t.extend({init:function(){this.data=[],this.ytBind=e.bind(this.onYTResult,this),this.scBind=e.bind(this.onSCResult,this)},reset:function(){this.hash={},this.page=0,this.lastCount=0,this.data.length=0,this.relatedSearch=undefined,this.scFavoritesLookup=!1,this.scTracksLookup=!1,this.lastQuery=undefined,this.lastFormat=undefined,u.reset()},resetRelated:function(){a.set({query:undefined,related:undefined,relatedHistory:[],relatedPlaylist:undefined,scImport:!1},{silent:!0})},load:function(e,t){this.reset(),this.resetRelated(),this.lastQuery=e,this.lastFormat=t,a.set("query","").set("query",e).set("disabled",e.indexOf("http")==0),this._search()},_search:function(){this.lastFormat=="1"?i.ytSearch(this.lastQuery,this.page,30,this.ytBind):this.lastFormat=="2"&&i.scSearch(this.lastQuery,this.page,30,this.scBind)},loadRelated:function(e,t){this.relatedSearch?a.get("relatedHistory").push({title:this.relatedSearch,items:u.toArray()}):a.get("relatedHistory").push({title:this.lastQuery,items:u.toArray(),page:this.page}),t&&a.set("relatedPlaylist",t,{silent:!0}),this.reset(),this.lastFormat=e.get("format"),this.lastFormat=="1"?this.relatedSearch=e.get("author")+" - "+e.get("title"):this.lastFormat=="2"&&(this.relatedSearch=e.get("author")),a.set({pageCounts:[],query:undefined},{silent:!0}).set("related",this.relatedSearch),this.lastFormat=="1"?i.ytRelated(e.get("cid"),this.ytBind):this.lastFormat=="2"&&i.scSearch(this.relatedSearch,0,30,this.scBind)},loadSCFavorites:function(e){this._resetSC(e),this.scFavoritesLookup=!0,i.scFavorites(e,30,this.scBind)},loadSCTracks:function(e){this._resetSC(e),this.scTracksLookup=!0,i.scTracks(e,30,this.scBind)},importSC:function(e,t,i){t||(t=u.toArray()),i||(i=1);if(t.length>0){var s=e;i>1&&(s+=" "+i);if(t.length<=200)n.dispatch(new r(r.CREATE,s,t));else{var o=t.slice(0,200);n.dispatch(new r(r.CREATE,s,o)),t.splice(0,200),this.importSC(e,t,++i)}}},_resetSC:function(e){e==0&&(this.reset(),this.resetRelated(),this.page=e,this.lastFormat="2",a.set("scImport",!0))},more:function(){return!this.relatedSearch&&this.lastCount>0&&u.length<200?(++this.page,!this.scFavoritesLookup&&!this.scTracksLookup?this._search():this.scFavoritesLookup?this.loadSCFavorites(this.page):this.scTracksLookup&&this.loadSCTracks(this.page),!0):!1},onYTResult:function(e){this.relatedSearch&&e.length==0?(this.lastQuery=undefined,this.load(this.relatedSearch,"1")):this.eliminateDuplicates(e)},onSCResult:function(e){this.eliminateDuplicates(e)},eliminateDuplicates:function(e){this.ignoreDuplicatesAndLocal(e),this.collate(e)},ignoreDuplicatesAndLocal:function(e){if(e){var t=e.length;for(var n=0;n<t;++n)if(!this.hash[e[n].cid]){var r=e[n].cid,i=s.lookup(r);i&&(this.hash[r]=!0,this.data.push(i))}}},onCIDResult:function(e){if(e){var t=e.length;for(var n=0;n<t;++n)this.hash[e[n].cid]=!0,this.data.push(e[n])}this.collate(e)},collate:function(e){this.appendUnknown(e);if(u.length+this.data.length>200){var t=(u.length+this.data.length)%200;this.data.length-t>-1&&(this.data.length-=t)}u.add(this.data).trigger("update"),this.lastCount=this.data.length,this.data.length=0},appendUnknown:function(e){if(e){var t=e.length;for(var n=0;n<t;++n)this.hash[e[n].cid]||this.data.push(e[n])}}});return new f}),define("ac785/d94e0/b1cfb",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="ImportSoundCloudEvent",t.FAVORITES="ImportSoundCloudEvent:favorites",t.SETS="ImportSoundCloudEvent:sets",t.TRACKS="ImportSoundCloudEvent:tracks",t}),define("ac785/b1ca1/ea43b",["ac785/bc190/fea39","ac785/f04be/e84bd","ac785/f04be/f1000","ac785/d94e0/b1cfb"],function(e,t,n,r){var i=e.extend({execute:function(){this.event.type==r.SETS?t.load():this.event.type==r.TRACKS?n.loadSCTracks(0):this.event.type==r.FAVORITES&&n.loadSCFavorites(0),this._super()}});return i}),define("ac785/ca252/cc7a2",["underscore","backbone"],function(e,t){var n=t.Model.extend({defaults:{media:undefined,playlist:undefined}});return n}),define("ac785/d94e0/f5b19",["underscore","ac785/d94e0/b584a","ac785/ca252/aeeec","ac785/ca252/cc7a2"],function(e,t,n,r){var i=t.extend({init:function(t,i,s,o,u){this._super(t),i&&(this.selectedMedia=e.map(i,function(e){return e.model instanceof n?e.model:e.model.get("media")})),this.model=s instanceof n||s instanceof r?s:s.get("media"),this.index=o,this.target=u}});return i._name="MediaActionEvent",i.ADD="MediaActionEvent:add",i.DELETE="MediaActionEvent:delete",i.EDIT="MediaActionEvent:edit",i.MOVE_TO_TOP="MediaActionEvent:movetotop",i.PLAY_NEXT="MediaActionEvent:playnext",i.RELATED="MediaActionEvent:related",i}),define("ac785/d94e0/fc0ee",["backbone","ac785/d94e0/b584a"],function(e,t){var n=t.extend({init:function(t,n,r){this._super(t),n&&(n[0]instanceof e.View?this.items=_.map(n,function(e){return e.model}):this.items=n,this.beforeMediaID=r)}});return n._name="MediaMoveEvent",n.MOVE="MediaMoveEvent:move",n.SHUFFLE="MediaMoveEvent:shuffle",n.TOP="MediaMoveEvent:top",n}),define("ac785/d94e0/ca90f",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="PlaylistActivateEvent",t.ACTIVATE="PlaylistActivateEvent:activate",t}),define("ac785/d94e0/e3c1f",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r,i){this._super(e),this.id=t,this.author=n,this.title=r,this.playlistID=i}});return t._name="MediaUpdateEvent",t.UPDATE="MediaUpdateEvent:update",t}),define("ac785/abf10/d9a0c/ed66d",["ac785/abf10/d9a0c/fbb95","ac785/d94e0/e3c1f","ac785/ca252/c0f8f","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r,i){var s=e.extend({id:"dialog-media-update",className:"dialog",render:function(){return this.$el.append(this.getHeader(i.dialog.editMedia)).append(this.getBody().append(this.getInputField("author",i.dialog.artist,i.dialog.artist,this.options.media.get("author"),128).addClass("artist")).append(this.getInputField("title",i.dialog.title,i.dialog.title,this.options.media.get("title"),128).addClass("title")).append($("<div/>").addClass("swap").append('<i class="icon icon-swap"></i>').click(_.bind(this.swapAuthorTitle,this)))).append(this.getButtons(i.dialog.save,!0)),_.defer(_.bind(this.deferFocus,this)),this._super()},deferFocus:function(){var e=this.$el.find("input").on("keyup",_.bind(this.onKeyUp,this))[0];$(e).focus(),e.selectionStart=e.selectionEnd=e.value.length},onKeyUp:function(){var e=this.$el.find("input");e[0].value.length>0&&e[1].value.length>0?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},submit:function(){var e=this.$el.find("input");e[0].value.length>0&&e[1].value.length>0&&(this.dispatch(new t(t.UPDATE,this.options.media.get("id"),e[0].value,e[1].value)),r.event("Dialog","Update Media"),this.close())},close:function(){this.options.media=undefined,this.$el.find("input").off(),this._super()},swapAuthorTitle:function(e){var t=this.$el.find("input"),n=t[0].value,i=t[1].value;t[0].value=i,t[1].value=n,r.event("Dialog","Swap Author/Title")}});return s}),define("ac785/d94e0/dfc42",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n){this._super(e),this.playlistID=t,this.items=n}});return t._name="MediaDeleteEvent",t.DELETE="MediaDeleteEvent:delete",t}),define("ac785/abf10/d9a0c/ac224",["underscore","ac785/abf10/d9a0c/fbb95","ac785/d94e0/dfc42","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r,i){var s=t.extend({id:"dialog-delete",className:"dialog destructive",render:function(){var t;return this.options.items.length==1?t=i.dialog.deleteSinglePrompt.split("%MEDIA%").join(this.options.items[0].get("author")+" - "+this.options.items[0].get("title")):t=i.dialog.deleteMultiplePrompt.split("%COUNT%").join(String(this.options.items.length)),this.$el.append(this.getHeader(i.dialog.deleteMedia)).append(this.getBody().append(this.getMessage(t))).append(this.getButtons(i.dialog.deleteMedia,!0)),e.defer(e.bind(this.adjustTop,this)),this._super()},adjustTop:function(){this.$(".dialog-body .message").css("top",(this.$(".dialog-body").height()-this.$(".dialog-body .message").height())/2)},submit:function(){this.dispatch(new n(n.DELETE,this.options.playlistID,this.options.items)),r.event("Dialog","Delete Media"),this.close()},close:function(){this.options.items=undefined,this.options.playlistID=undefined,this._super()}});return s}),define("ac785/abf10/d9a0c/f324c",["ac785/abf10/d9a0c/fbb95","ac785/d94e0/c7cab","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r){var i=e.extend({id:"dialog-playlist-create",className:"dialog no-submit",render:function(){var e;return this.options.media&&this.options.media.length>0?this.options.media.length>1?e=r.dialog.createPlaylistFrom.split("%COUNT%").join(String(this.options.media.length)):e=r.dialog.createPlaylistFrom1:e=r.dialog.createPlaylist,this.$el.append(this.getHeader(e)).append(this.getBody().append(this.getInputField("name",r.dialog.name,r.dialog.playlistName,"",24))).append(this.getButtons(r.dialog.createPlaylist,!0)),_.defer(_.bind(this.deferFocus,this)),this._super()},deferFocus:function(){this.$field=this.$el.find("input").on("keyup",_.bind(this.onKeyUp,this)).focus()},onKeyUp:function(){this.$field[0].value.length>0?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},submit:function(){var e=this.$el.find("input")[0].value;e.length>0&&(this.dispatch(new t(t.CREATE,e,this.options.media,this.options.curate)),this.close(),n.event("Dialog","Create Playlist"+(this.options.media&&this.options.media.length>0?" From Selection":"")))},close:function(){this.options.media=undefined,this.options.curate=undefined,this.$field.off(),this.$field=undefined,this._super()}});return i}),define("ac785/d94e0/a133c",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.playlistID=t}});return t._name="MediaCurateEvent",t.CURATE="MediaCurateEvent:curate",t}),define("ac785/d94e0/b0721",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n,r,i){this._super(e),this.playlist=t,this.items=n,this.beforeMediaID=r,this.confirmCount=i}});return t._name="MediaInsertEvent",t.INSERT="MediaInsertEvent:insert",t}),define("ac785/abf10/e9abd/ddb98/c5def",["jquery","backbone","lang/Lang"],function(e,t,n){var r=t.View.extend({tagName:"li",events:{mousedown:"onPress"},render:function(){this.$el.empty();var t=e("<span/>");return this.model?(t.text(this.model.get("name")),this.model.get("selected")&&this.$el.append(e("<i/>").addClass("icon icon-active-selected"))):(this.$el.addClass("create").append(e("<i/>").addClass("icon icon-create-playlist")),t.text(n.popMenu.createPlaylist)),this.$el.append(t),this},onPress:function(){this.trigger("press",this.model)},remove:function(){this._super(),this.model=undefined,this.$el.off("mousedown",this.pressBind),this.pressBind=undefined,this.$el.empty(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el}});return r}),define("ac785/abf10/e9abd/ddb98/f882d",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/a133c","ac785/d94e0/b0721","ac785/d94e0/bd874","ac785/ca252/aeeec","ac785/ca252/c0f8f","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/ddb98/c5def","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({className:"pop-menu",collection:a,initialize:function(){this.isShowing=!1,this.$bar=e("<div/>").addClass("bar"),this.$icon=e("<i/>").addClass("icon icon-add"),this.$title=e("<span/>").addClass("title"),this.$menu=e("<div/>").addClass("menu"),this.$ul=e("<ul/>"),this.$bar.append(this.$icon).append(this.$title).append(e("<div/>").addClass("bar-divider")),this.$menu.append(this.$ul),this.rows=[],this.media=undefined,this.$target=undefined,this.drawRowBind=t.bind(this.drawRow,this),this.pressBind=t.bind(this.onRowPress,this),this.hideBind=t.bind(this.hide,this),r.on("popmenu:hide",this.hide,this),this.render()},draw:function(){if(this.$ul){this.clear(),this.$el.scrollTop(0),this.collection.each(this.drawRowBind);var e=new l;this.$ul.append(e.$el),e.render(),e.on("press",this.pressBind),this.rows.push(e)}},drawRow:function(e){var t=new l({model:e});return this.$ul.append(t.$el),t.render(),this.rows.push(t),t.on("press",this.pressBind),t},onRowPress:function(e){this.$target.data("curate")?e?r.dispatch(new i(i.CURATE,e.get("id"))):r.dispatch(new o(o.SHOW,new f({curate:!0}))):e?r.dispatch(new s(s.INSERT,e,this.media,-1,this.media.length)):r.dispatch(new o(o.SHOW,new f({media:this.media}))),this.hide()},clear:function(){if(this.$ul){var e=this.rows.length;while(e--)this.rows[e].$el.off("press",this.pressBind),this.rows[e].remove();this.rows.length=0,this.$ul.empty()}},render:function(){return this.$el.empty().append(this.$bar).append(this.$menu),this},show:function(t,n,r){if(!this.isShowing){this.draw(),this.isShowing=!0,this.$target=t,this.media=n;var i=this.media[0]instanceof u?this.media[0].get("format")==1:this.media[0].get("media").get("format")==1,s=t.data("curate"),o,a,f=31*Math.min(6,this.collection.length+1)+48,l=this.$target.offset();s?(this.$title.text(i?c.popMenu.grabVideo:c.popMenu.grabSong),this.$el.addClass("curate").removeClass("up"),o=~~(l.left+(this.$target.width()-205)/2),a=~~(l.top-f),this.$icon.removeClass().addClass("icon icon-curate-disabled")):(this.$title.text(i?this.media.length==1?c.popMenu.addVideo:c.popMenu.addVideos.split("%COUNT%").join(this.media.length):this.media.length==1?c.popMenu.addSong:c.popMenu.addSongs.split("%COUNT%").join(this.media.length)),this.$el.removeClass("curate"),o=~~(l.left-9),a=~~(l.top-10),a+f>e(window).height()?(a=~~(l.top-f+48-10),this.$el.addClass("up")):this.$el.removeClass("up"),this.$icon.removeClass().addClass("icon icon-add")),this.$menu.css("height",f-48).scrollTop(0),this.$el.css("height",f).css("left",o).css("top",a),r?r.append(this.$el):e("body").append(this.$el),this.$el.show(),this.$el.on("mouseleave",this.hideBind)}},hide:function(){this.isShowing&&(this.isShowing=!1,this.$el.off("mouseleave",this.hideBind).remove())}});return new h}),define("ac785/b1ca1/a9f55",["underscore","ac785/bc190/d22bb","ac785/d94e0/fb1a1","ac785/d94e0/f5b19","ac785/d94e0/bd874","ac785/d94e0/fc0ee","ac785/d94e0/ca90f","ac785/f04be/f1000","ac785/ca252/f89d8","ac785/ca252/aeeec","ac785/ca252/c0f8f","ac785/ca252/ec425","ac785/abf10/d9a0c/ed66d","ac785/abf10/d9a0c/ac224","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/ddb98/f882d"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=t.extend({execute:function(){this.trigger("suggestions:hide");var e=l.getVisibleID(),t=l.find(function(e){return e.get("selected")});this.event.type==r.ADD?this.actionAdd(t):e?this.event.type==r.DELETE?this.actionDelete(t,e):this.event.type==r.EDIT?this.dispatch(new i(i.SHOW,new h({media:this.event.model}))):this.event.type==r.MOVE_TO_TOP?this.actionMoveToTop():this.event.type==r.RELATED&&u.loadRelated(this.event.model,l.get(e)):this.event.type==r.RELATED?(v.hide(),u.loadRelated(this.event.model)):this.event.type==r.PLAY_NEXT&&this.actionPlayNext(t)},actionAdd:function(e){var t=this.getExists(this.event.selectedMedia,this.event.model.get("id")),n=t?this.event.selectedMedia:[this.event.model];e?v.show($(this.event.target),n):this.dispatch(new i(i.SHOW,new d({media:n})))},actionDelete:function(e,t){a.isTheUserPlaying&&t==c.get("playlistID")&&this.event.index==0&&this.event.model.get("id")==c.get("mediaID")?this.trigger("notify","icon-chat-system",Lang.alerts.deleteCurrentPlaylist):a.isTheUserInBooth&&e.get("id")==t&&e.get("items").length==this.event.selectedMedia.length?this.trigger("notify","icon-chat-system",Lang.alerts.deleteLastItem):this.event.selectedMedia.length>0&&this.getExists(this.event.selectedMedia,this.event.model.get("id"))?this.dispatch(new i(i.SHOW,new p({items:this.event.selectedMedia,playlistID:t}))):this.dispatch(new i(i.SHOW,new p({items:[this.event.model],playlistID:t})))},actionMoveToTop:function(){this.event.selectedMedia.length>0&&this.getExists(this.event.selectedMedia,this.event.model.get("id"))?this.dispatch(new s(s.TOP,this.event.selectedMedia)):this.dispatch(new s(s.TOP,[this.event.model]))},actionPlayNext:function(e){l.setVisible(l.get(this.event.model.get("playlist").id)),e.get("id")!=this.event.index&&this.dispatch(new o(o.ACTIVATE)),this.dispatch(new s(s.TOP,[new f(this.event.model.get("media"))])),this.trigger("search:clear")},getExists:function(e,t){var n=e.length,r=!1;while(n--)if(e[n].get("id")==t){r=!0;break}return r}});return m}),define("ac785/e734f/bbe20/fde31",["ac785/c3562/f9d8b","ac785/e734f/b669d","ac785/f6dac/d17c3"],function(e,t,n){var r=t.extend({init:function(e,t){this.playlistID=e,this.historyID=t,this._super()},execute:function(){e.execute("room.curate",this,this.playlistID,this.historyID)},parse:function(e){if(e.status==0){n.deserializeModified(e.data[0]);if(e.data[1].length>0){var t=e.data[1].length;while(t--)n.deserializeModified(e.data[1][t])}this.successCallback(e)}else e.status==5?this.errorCallback(5):this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/d010a",["underscore","ac785/bc190/fea39","ac785/d94e0/fb1a1","ac785/d94e0/e3c1f","ac785/ca252/ec425","ac785/ca252/deacc","ac785/ca252/c0f8f","ac785/e734f/bbe20/fde31","ac785/ab6db/ca525","ac785/ab6db/e1b12","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l){var c=t.extend({execute:function(){var t=new u(this.event.playlistID,i.get("historyID"));t.successCallback=e.bind(this.onCurateResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onCurateResponse:function(e){var t=i.get("media"),n;e.data[1].length>0&&(f.write(e.data[1]),s.add(e.data[1]),n=e.data[1][0]),a.write([e.data[0]]);var u=o.get(e.data[0].id);u?u.set("items",e.data[0].items):u=o.add(e.data[0]).get(e.data[0].id),t&&n&&u&&n.id==t.get("id")&&(n.author!=t.get("author")||n.title!=t.get("title"))&&this.dispatch(new r(r.UPDATE,t.get("id"),t.get("author"),t.get("title"),u.get("id"))),t&&u&&this.trigger("notify","icon-import",l.alerts.mediaAddedToPlaylist.split("%MEDIA%").join(t.get("author")+" - "+t.get("title")).split("%PLAYLIST%").join(u.get("name"))),this.finish()},onServiceError:function(e){e==5&&this.trigger("notify","icon-chat-system",l.alerts.tooManyItems),this.finish()}});return c}),define("ac785/e734f/bbe20/d4df0",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r){var i=t.extend({init:function(e,t){this.playlistID=e,this.items=n.serializeMediaItems(t),this._super(!0)},execute:function(){e.execute("playlist.media.delete",this,this.playlistID,this.items)},parse:function(e){this.playlistID=undefined;if(e.status==0){n.deserializeModified(e.data),e.media=[];var t=this.items.length;for(var i=0;i<t;++i)e.media.push(this.items[i]);this.successCallback(e),this.items=undefined}else e.status==2?this.alert(undefined,r.alerts.deleteLastItem):this.onStatusError(e.status)}});return i}),define("ac785/b1ca1/dc25c",["underscore","ac785/bc190/fea39","ac785/ca252/c0f8f","ac785/ca252/deacc","ac785/ab6db/ca525","ac785/ab6db/e1b12","ac785/e734f/bbe20/d4df0"],function(e,t,n,r,i,s,o){var u=t.extend({count:0,execute:function(){if(this.event.items.length>0){++this.count;var t=n.get(this.event.playlistID);t.set("syncing",!0);var r;if(this.event.items.length<50)r=new o(this.event.playlistID,this.event.items),r.successCallback=e.bind(this.onDeleteResponse,this),r.errorCallback=e.bind(this.onServiceError,this);else{var i=this.event.items.slice(0,50);r=new o(this.event.playlistID,i),r.successCallback=e.bind(this.onDeleteResponse,this),r.errorCallback=e.bind(this.onServiceError,this),this.event.items.splice(0,50),this.execute()}}else this.count==0&&this.finish()},onDeleteResponse:function(e){i.update(e.data),n.get(e.data.id).set("items",e.data.items);if(e.media.length>0){var t=i.deletePlaylistMedia(e.data.id,e.media);if(t.length>0){var s=t.length;while(s--){var o=r.get(t[s]);o&&o.trigger("destroy",o,o.collection,{})}}}--this.count<=0&&this.finish()},onServiceError:function(e){this.finish()},finish:function(){n.get(this.event.playlistID).set("syncing",!1),this._super()}});return u}),define("ac785/e734f/bbe20/ba9a6",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r){var i=t.extend({init:function(e,t,r,i){this.playlistID=e,this.name=t,this.items=n.serializeMediaItems(r),this.beforeMediaID=i,this._super(!0)},execute:function(){e.execute("playlist.media.insert",this,this.playlistID,this.name,this.beforeMediaID,this.items)},parse:function(e){this.items=undefined,this.beforeMediaID=undefined;if(e.status==0){n.deserializeModified(e.data[0]);if(e.data[1].length>0){var t=e.data[1].length;while(t--)n.deserializeModified(e.data[1][t])}this.successCallback(e)}else e.status==2?this.alert(undefined,r.alerts.playlistLimit):this.onStatusError(e.status);this.name=undefined,this.playlistID=undefined}});return i}),define("ac785/b1ca1/f6f6b",["underscore","ac785/bc190/fea39","ac785/ca252/c0f8f","ac785/ca252/deacc","ac785/ab6db/ca525","ac785/ab6db/e1b12","ac785/e734f/bbe20/ba9a6","ac785/d94e0/fb1a1","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.extend({count:0,execute:function(){if(this.event.items.length>0){++this.count;var t=this.event.playlist?this.event.playlist.get("id"):0;t&&this.event.playlist.set("syncing",!0);var n;this.confirmCount=this.event.confirmCount;if(this.event.items.length<50)n=new o(t,null,this.event.items,this.event.beforeMediaID),n.successCallback=e.bind(this.onInsertResponse,this),n.errorCallback=e.bind(this.onServiceError,this);else{var r=this.event.items.slice(0,50);n=new o(t,null,r,this.event.beforeMediaID),n.successCallback=e.bind(this.onInsertResponse,this),n.errorCallback=e.bind(this.onServiceError,this),this.event.items.splice(0,50),this.execute()}}else this.count==0&&this.finish()},onInsertResponse:function(e){i.update(e.data[0]),e.data[1].length>0&&(s.write(e.data[1]),r.add(e.data[1])),n.get(e.data[0].id).set("items",e.data[0].items);if(this.event.confirmCount){var t;this.event.confirmCount==1?t=a.alerts.addedToPlaylist1.split("%PLAYLIST%").join(this.event.playlist.get("name")):t=a.alerts.addedToPlaylist.split("%COUNT%").join(this.event.confirmCount).split("%PLAYLIST%").join(this.event.playlist.get("name")),this.trigger("notify","icon-import",t)}--this.count<=0&&this.finish()},onServiceError:function(e){this.finish()},finish:function(){this.event.playlist&&this.event.playlist.set("syncing",!1),this.event.playlist=undefined,this._super()}});return f}),define("ac785/e734f/bbe20/b77da",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e,t,r){this.playlistID=e,this.beforeMediaID=r,this.items=n.serializeMediaItems(t),this._super(!0)},execute:function(){t.execute("playlist.media.move",this,this.playlistID,this.beforeMediaID,this.items)},parse:function(e){this.playlistID=undefined,this.items=undefined,this.beforeMediaID=undefined,e.status==0?(n.deserializeModified(e.data),this.successCallback(e)):this.onStatusError(e.status)}});return r}),define("ac785/e734f/bbe20/c1e15",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e){this.playlistID=e,this._super(!0)},execute:function(){t.execute("playlist.media.shuffle",this,this.playlistID)},parse:function(e){this.playlistID=undefined,e.status==0?(n.deserializeModified(e.data),this.successCallback(e)):this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/ece5b",["underscore","ac785/bc190/fea39","ac785/d94e0/fc0ee","ac785/ca252/aeeec","ac785/ab6db/ca525","ac785/ca252/c0f8f","ac785/e734f/bbe20/b77da","ac785/e734f/bbe20/c1e15"],function(e,t,n,r,i,s,o,u){var a=t.extend({execute:function(){this.visiblePlaylist=s.find(function(e){return e.get("visible")}),this.visiblePlaylist.set("syncing",!0);var t;if(this.event.type==n.SHUFFLE){if(!(this.visiblePlaylist.get("items").length>2)){e.defer(e.bind(this.finish,this));return}t=new u(this.visiblePlaylist.get("id"))}else t=new o(this.visiblePlaylist.get("id"),this.event.items,this.event.beforeMediaID);t.successCallback=e.bind(this.onMoveResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onMoveResponse:function(e){i.update(e.data),s.get(e.data.id).set("items",e.data.items),this.finish()},onServiceError:function(e){this.finish()},finish:function(){this.visiblePlaylist.set("syncing",!1),this.visiblePlaylist=undefined,delete this.visiblePlaylist,this._super()}});return a}),define("ac785/b1ca1/ecb3c",["ac785/bc190/d22bb","ac785/ab6db/ca525","ac785/d94e0/fc0ee","ac785/ca252/c0f8f","ac785/ca252/ec425"],function(e,t,n,r,i){var s=e.extend({execute:function(){var e=r.getVisibleID(),s=t.firstMedia(e);if(s.length>0){var o,u=i.get("playlistID")==e;u&&s.length==2?o=s[1]:o=s[0],o!=0&&(o=o!=this.event.items[0]?o:this.event.items.length>1?this.event.items[1].get("id"):undefined,o&&this.dispatch(new n(n.MOVE,this.event.items,o)))}this._super()}});return s}),define("ac785/e734f/bbe20/d2d32",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3"],function(e,t,n){var r=t.extend({init:function(e){this.items=e,this._super(!0)},execute:function(){e.execute("media.recover",this,this.items)},parse:function(e){if(e.status!=0){this.onStatusError(e.status);return}var t=e.data.length;while(t--)n.deserializeModified(e.data[t]);this.successCallback(e.data)}});return r}),define("ac785/b1ca1/db9d0",["underscore","ac785/bc190/fea39","ac785/ab6db/e1b12","ac785/ab6db/ca525","ac785/ca252/deacc","ac785/ca252/c0f8f","ac785/e734f/bbe20/d2d32"],function(e,t,n,r,i,s,o){var u=t.extend({count:0,execute:function(){if(this.event.items.length>0){++this.count;var t;if(this.event.items.length<50)t=new o(this.event.items),t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.onError,this);else{var n=this.event.items.slice(0,50);t=new o(n),t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.onError,this),this.event.items.splice(0,50),this.execute()}}else this.count==0&&this.finish()},onResponse:function(e){n.write(e),--this.count<=0&&this.finish()},finish:function(){i.reset(n.read()),s.setVisible().reset(r.read()),this._super()},onError:function(t){++this.retries<10&&e.delay(e.bind(this.execute,this),100)}});return u}),define("ac785/d94e0/a0710",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.items=t}});return t._name="MediaRecoverEvent",t.RECOVER="MediaRecoverEvent:recover",t}),define("ac785/e734f/bbe20/e0a22",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e){this.after=n.convertNumberStringToUnixDateString(e),this._super(!0)},execute:function(){t.execute("media.select",this,this.after)},parse:function(e){this.after=undefined;if(e.status!=0){this.onStatusError(e.status);return}var t=e.data.length;while(t--)n.deserializeModified(e.data[t]);this.successCallback(e.data)}});return r}),define("ac785/d94e0/e001a",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="MediaSyncEvent",t.SYNC="MediaSyncEvent:sync",t.COMPLETE="MediaSyncEvent:complete",t}),define("ac785/d94e0/d90fb",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="PlaylistSyncEvent",t.SYNC="PlaylistSyncEvent:sync",t}),define("ac785/b1ca1/acabb",["underscore","ac785/bc190/fea39","ac785/ab6db/e1b12","ac785/ca252/deacc","ac785/e734f/bbe20/e0a22","ac785/d94e0/e001a","ac785/d94e0/d90fb"],function(e,t,n,r,i,s,o){var u=t.extend({retries:0,execute:function(){if(!u.synced){var t=new i(n.modified());t.successCallback=e.bind(this.onSelectResponse,this),t.errorCallback=e.bind(this.onServiceError,this)}else this.syncComplete()},onSelectResponse:function(e){n.write(e),e.length>=200?(u.synced=!1,this.execute()):this.syncComplete()},syncComplete:function(){u.synced=!0,r.reset(n.read()),this.finish()},finish:function(){this._super(),this.dispatch(new s(s.COMPLETE)),this.dispatch(new o(o.SYNC))},onServiceError:function(t){++this.retries<10&&e.delay(e.bind(this.execute,this),100)}});return u.synced=!1,u}),define("ac785/e734f/bbe20/e4706",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e,t,n){this.item={id:e,author:t,title:n},this._super()},execute:function(){t.execute("media.update",this,[this.item])},parse:function(e){e.status==0?(n.deserializeModified(e.data[0]),e.data[0].author=this.item.author,e.data[0].title=this.item.title,this.successCallback(e)):this.onStatusError(e.status),this.item=undefined}});return r}),define("ac785/b1ca1/e36af",["underscore","ac785/bc190/fea39","ac785/ab6db/e1b12","ac785/ca252/deacc","ac785/ca252/c0f8f","ac785/e734f/bbe20/e4706"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){this.progressPlaylist=this.event.playlistID?i.get(this.event.playlistID):i.find(function(e){return e.get("visible")}),this.progressPlaylist&&this.progressPlaylist.set("syncing",!0);var t=new s(this.event.id,this.event.author,this.event.title);t.successCallback=e.bind(this.onUpdateResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onUpdateResponse:function(e){n.write(e.data);var t=r.get(e.data[0].id);t.get("author")!=e.data[0].author&&t.set("author",e.data[0].author),t.get("title")!=e.data[0].title&&t.set("title",e.data[0].title),this.finish()},onServiceError:function(e){this.finish()},finish:function(){this.progressPlaylist&&this.progressPlaylist.set("syncing",!1),this.progressPlaylist=undefined,delete this.progressPlaylist,this._super()}});return o}),define("ac785/e734f/aa464/e7b4c",["ac785/c3562/d4511","ac785/e734f/b669d","lang/Lang"],function(e,t,n){var r=t.extend({init:function(e){this.userID=e,this._super()},execute:function(){e.execute("moderate.add_dj",this,this.userID)},parse:function(e){e.status!=0&&(e.status==3?this.alert(undefined,n.alerts.modAddDJ):this.onStatusError(e.status))}});return r}),define("ac785/e734f/aa464/ff199",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.chatID=e,this._super()},execute:function(){t.execute("moderate.chat_delete",this,this.chatID)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/aa464/e5c7e",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.userID=e,this.historyID=t,this._super()},execute:function(){t.execute("moderate.skip",this,this.userID,this.historyID)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/aa464/ab1e2",["ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(e,t){this.userID=e,this.reason=t||1,this._super()},execute:function(){e.execute("moderate.ban",this,this.userID,String(this.reason))},parse:function(e){this.userID=undefined,this.reason=undefined,e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/aa464/a0288",["ac785/c3562/d4511","ac785/e734f/b669d","lang/Lang"],function(e,t,n){var r=t.extend({init:function(e,t){this.userID=e,this.permission=t,this._super()},execute:function(){e.execute("moderate.permissions",this,this.userID,this.permission)},parse:function(e){e.status!=0&&(e.status==1?this.permission==4?this.alert(undefined,n.alerts.limitCohostError):this.permission==3?this.alert(undefined,n.alerts.limitManagerError):this.permission==2?this.alert(undefined,n.alerts.limitBouncerError):this.permission==1&&this.alert(undefined,n.alerts.limitDJError):e.status==2?this.alert(undefined,n.alerts.permissionError):this.onStatusError(e.status))}});return r}),define("ac785/e734f/aa464/a089f",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.userID=e,this._super()},execute:function(){t.execute("moderate.remove_dj",this,this.userID)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/cba6e",["ac785/bc190/d22bb","ac785/d94e0/e089a","ac785/e734f/aa464/e7b4c","ac785/e734f/aa464/ff199","ac785/e734f/aa464/e5c7e","ac785/e734f/aa464/ab1e2","ac785/e734f/aa464/a0288","ac785/e734f/aa464/a089f"],function(e,t,n,r,i,s,o,u){var a=e.extend({execute:function(){this.event.type==t.ADD_DJ?new n(this.event.id):this.event.type==t.CHAT_DELETE?new r(this.event.id):this.event.type==t.SKIP?new i(this.event.id,this.event.value):this.event.type==t.BAN?new s(this.event.id,this.event.value,this.event.option):this.event.type==t.PERMISSION?new o(this.event.id,this.event.value):this.event.type==t.REMOVE_DJ&&new u(this.event.id)}});return a}),define("ac785/e734f/aa464/e12a1",["ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(e){this.userID=e,this._super()},execute:function(){e.execute("moderate.unban",this,this.userID)},parse:function(e){e.status==0?this.successCallback(e):this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/a17a2",["underscore","ac785/bc190/fea39","ac785/bc190/cd0b8","ac785/ca252/ccfb5","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/aa464/e12a1","lang/Lang"],function(e,t,n,r,i,s,o,u){var a=t.extend({execute:function(){if(i.hasPermission(s.MANAGER)){var t=new o(this.event.id);t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.onError,this)}else this.finish()},onResponse:function(){r.remove(this.event.id),n.trigger("notify","icon-ban",u.messages.unban.split("%NAME%").join(this.event.value)),this.finish()},onError:function(e){r.reset(),this.finish()}});return a}),define("ac785/d94e0/ae10c",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="PlaylistActionEvent",t.ACTIVATE="PlaylistActionEvent:activate",t.RENAME="PlaylistActionEvent:rename",t.DELETE="PlaylistActionEvent:delete",t}),define("ac785/d94e0/ea5f9",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n){this._super(e),this.playlist=t,this.name=n}});return t._name="PlaylistRenameEvent",t.RENAME="PlaylistRenameEvent:rename",t}),define("ac785/abf10/d9a0c/ef2f4",["ac785/abf10/d9a0c/fbb95","ac785/d94e0/ea5f9","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r){var i=e.extend({id:"dialog-playlist-rename",className:"dialog",render:function(){return this.$el.append(this.getHeader(r.dialog.renamePlaylist)).append(this.getBody().append(this.getInputField("name",r.dialog.name,r.dialog.playlistName,this.options.playlist.get("name"),24))).append(this.getButtons(r.dialog.save,!0)),_.defer(_.bind(this.deferFocus,this)),this._super()},deferFocus:function(){this.$field=this.$el.find("input").on("keyup",_.bind(this.onKeyUp,this)).focus(),this.$field[0].selectionStart=this.$field[0].selectionEnd=this.$field[0].value.length},onKeyUp:function(){this.$field[0].value.length>0?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},submit:function(){var e=this.$field[0].value;e.length>0&&(this.dispatch(new t(t.RENAME,this.options.playlist,e)),n.event("Dialog","Rename Playlist"),this.close())},close:function(){this.options.playlist=undefined,this.$field.off(),this.$field=undefined,this._super()}});return i}),define("ac785/d94e0/e8fc4",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.id=t}});return t._name="PlaylistDeleteEvent",t.DELETE="PlaylistDeleteEvent:delete",t}),define("ac785/abf10/d9a0c/d2b5c",["underscore","ac785/abf10/d9a0c/fbb95","ac785/d94e0/e8fc4","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r,i){var s=t.extend({id:"dialog-playlist-delete",className:"dialog destructive no-submit",render:function(){return this.code=String(100+Math.round(Math.random()*899)),this.$el.append(this.getHeader(i.dialog.deletePlaylist)).append(this.getBody().append(this.getMessage(i.dialog.deletePlaylistPrompt.split("%NAME%").join(this.options.playlist.get("name")))).append(this.getInputField("code",i.dialog.deletePlaylistCode.split("%CODE%").join(this.code),i.dialog.deletePlaylistTypeCode.split("%CODE%").join(this.code),"",3))).append(this.getButtons(i.dialog.deletePlaylist,!0)),e.defer(e.bind(this.deferFocus,this)),this._super()},deferFocus:function(){this.$field=this.$el.find("input").on("keyup",e.bind(this.onKeyUp,this))},onKeyUp:function(){this.$field[0].value==this.code?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},submit:function(){this.$field[0].value==this.code&&(this.dispatch(new n(n.DELETE,this.options.playlist.get("id"))),r.event("Dialog","Delete Playlist"),this.close())},close:function(){this.$field.off(),this.$field=undefined,this.options.playlist=undefined,this.code=undefined,this._super()}});return s}),define("ac785/b1ca1/f7f1e",["ac785/bc190/d22bb","ac785/ca252/c0f8f","ac785/d94e0/ae10c","ac785/d94e0/ca90f","ac785/d94e0/bd874","ac785/abf10/d9a0c/ef2f4","ac785/abf10/d9a0c/d2b5c"],function(e,t,n,r,i,s,o){var u=e.extend({execute:function(){var e=t.find(function(e){return e.get("visible")});e&&(this.event.type==n.ACTIVATE?this.dispatch(new r(r.ACTIVATE,e.get("id"))):this.event.type==n.RENAME?this.dispatch(new i(i.SHOW,new s({playlist:e}))):this.event.type===n.DELETE&&this.dispatch(new i(i.SHOW,new o({playlist:e})))),this._super()}});return u}),define("ac785/e734f/b19be/bf262",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e){this.after=n.convertNumberStringToUnixDateString(e),this._super(!0)},execute:function(){t.execute("playlist.select",this,this.after,null,100,null)},parse:function(e){this.after=null;if(e.status==0){var t=e.data.length;while(t--)n.deserializeModified(e.data[t]);this.successCallback(e.data)}else this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/c90e3",["underscore","ac785/bc190/fea39","ac785/d94e0/a0710","ac785/ab6db/ca525","ac785/ca252/c0f8f","ac785/e734f/b19be/bf262"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){if(!o.synced){var t=new s(r.modified());t.successCallback=e.bind(this.onSelectResponse,this),t.errorCallback=e.bind(this.onServiceError,this)}else this.syncComplete()},onSelectResponse:function(e){r.write(e),e.length>=100?(o.synced=!1,this.execute()):this.syncComplete()},syncComplete:function(){o.synced=!0,i.reset(r.read());var e=r.getMissing();e.length>0&&this.dispatch(new n(n.RECOVER,e)),this.finish()},onServiceError:function(t){++this.retries<10&&e.delay(e.bind(this.execute,this),100)}});return o.synced=!1,o}),define("ac785/e734f/b19be/cccd2",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r){var i=t.extend({init:function(e){this.id=e,this._super(!0)},execute:function(){e.execute("playlist.activate",this,this.id)},parse:function(e){if(e.status==0){var t=e.data.length;while(t--)n.deserializeModified(e.data[t]);this.successCallback(e.data)}else e.status==2?this.alert(undefined,r.alerts.emptyPlaylist):this.onStatusError(e.status)}});return i}),define("ac785/b1ca1/a5c8f",["underscore","ac785/bc190/fea39","ac785/b1ca1/c90e3","ac785/ca252/c0f8f","ac785/ab6db/ca525","ac785/e734f/b19be/cccd2"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){this.playlist=r.find(function(e){return e.get("visible")});if(this.playlist){this.playlist.set("syncing",!0);var t=new s(this.playlist.get("id"));t.successCallback=e.bind(this.onActivateResponse,this),t.errorCallback=e.bind(this.onServiceError,this)}else this.finish()},onActivateResponse:function(e){i.write(e),n.synced=!0;var t;e.length==2&&(t=r.get(e[1].id),t&&t.set("selected",!1)),t=r.get(e[0].id),t&&t.set("selected",!0),this.finish()},onServiceError:function(e){this.finish()},finish:function(){this.playlist.set("syncing",!1),this.playlist=undefined,delete this.playlist,this._super()}});return o}),define("ac785/e734f/b19be/c1358",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e){this.name=e,this._super(!0)},execute:function(){t.execute("playlist.create",this,this.name)},parse:function(e){this.name=null,e.status==0?(n.deserializeModified(e.data),this.successCallback(e.data)):this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/ce3bb",["underscore","ac785/bc190/fea39","ac785/b1ca1/c90e3","ac785/ca252/c0f8f","ac785/ca252/deacc","ac785/ab6db/ca525","ac785/ab6db/e1b12","ac785/e734f/b19be/c1358","ac785/e734f/bbe20/ba9a6","ac785/d94e0/a133c"],function(e,t,n,r,i,s,o,u,a,f){var l=t.extend({execute:function(){var t;!this.event.items||this.event.items.length==0?(t=new u(this.event.name),t.successCallback=e.bind(this.onInsertResponse,this),t.errorCallback=e.bind(this.onServiceError,this)):(t=new a(0,this.event.name,this.event.items,0),t.successCallback=e.bind(this.onCreateInsertResponse,this),t.errorCallback=e.bind(this.onServiceError,this))},onInsertResponse:function(e){s.write([e]),r.length==0?r.reset(e):r.add(e),this.after(e.id)},onCreateInsertResponse:function(e){e.data[1].length>0&&(o.write(e.data[1]),i.add(e.data[1])),s.write([e.data[0]]),r.length==0?r.reset(e.data[0]):r.add(e.data[0]),this.after(e.data[0].id)},after:function(e){n.synced=!0,this.event.curate&&this.dispatch(new f(f.CURATE,e)),this.finish()},onServiceError:function(e){this.finish()},finish:function(){this._super()}});return l}),define("ac785/e734f/b19be/d19dd",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r){var i=t.extend({init:function(e){this.id=e,this._super(!0)},execute:function(){e.execute("playlist.delete",this,[this.id])},parse:function(e){if(e.status==0){var t=e.data.length;while(t--)n.deserializeModified(e.data[t]);this.successCallback(e.data)}else e.status==2?this.alert(undefined,r.alerts.deleteActive):this.onStatusError(e.status)}});return i}),define("ac785/b1ca1/eb193",["underscore","ac785/bc190/fea39","ac785/b1ca1/c90e3","ac785/ca252/c0f8f","ac785/ab6db/ca525","ac785/e734f/b19be/d19dd"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){var t=new s(this.event.id);t.successCallback=e.bind(this.onDeleteResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onDeleteResponse:function(e){i.write(e);var t=e.length;for(var s=0;s<t;++s){var o=r.get(e[s].id);if(o)if(!e[s].active){var u=-1;o.get("visible")&&(u=Math.max(0,r.indexOf(o)-1)),r.remove(o),u>-1&&r.setVisible(r.at(u))}else o.set({active:!0,selected:!0,modified:e[s].modified})}n.synced=!0,this.finish()},onServiceError:function(e){this.finish()}});return o}),define("ac785/e734f/b19be/aa68e",["ac785/e734f/b669d","ac785/c3562/d4511","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e,t){this.id=e,this.name=t,this._super(!0)},execute:function(){t.execute("playlist.rename",this,this.id,this.name)},parse:function(e){this.name=null,e.status==0?(n.deserializeModified(e.data),this.successCallback(e.data)):this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/c1320",["underscore","ac785/bc190/fea39","ac785/b1ca1/c90e3","ac785/ca252/c0f8f","ac785/ab6db/ca525","ac785/e734f/b19be/aa68e"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){this.event.playlist.set("syncing",!0);var t=new s(this.event.playlist.get("id"),this.event.name);t.successCallback=e.bind(this.onRenameResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onRenameResponse:function(e){i.write([e]),r.get(e.id).set("name",e.name),n.synced=!0,this.finish()},onServiceError:function(e){this.finish()},finish:function(){this.event.playlist.set("syncing",!1),this._super()}});return o}),define("ac785/b1ca1/e8023",["ac785/bc190/d22bb","ac785/ca252/f89d8","ac785/ca252/ec425"],function(e,t,n){var r=e.extend({execute:function(){this.event.media&&t.length>0?(this.event.replace&&n.set({duration:this.event.media.get("duration"),ytDuration:0}),n.set({restricted:undefined,mediaStartTime:this.event.mediaStartTime,playlistID:this.event.playlistID,media:this.event.media,historyID:this.event.historyID})):n.set({mediaStartTime:undefined,duration:0,playlistID:undefined,restricted:undefined,media:undefined,historyID:undefined}),this._super()}});return r}),define("ac785/d94e0/ab74a",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t){this._super(e),this.media=t}});return t._name="PreviewEvent",t.PREVIEW="PreviewEvent:preview",t}),define("ac785/abf10/d9a0c/ec643",["jquery","underscore","ac785/abf10/d9a0c/fbb95","ac785/f6dac/abcc8","ac785/ab6db/ffb2a","ac785/ca252/ec425","lang/Lang","ac785/bc190/cd0b8","ac785/d94e0/ab74a"],function(e,t,n,r,i,s,o,u,a){var f=n.extend({id:"dialog-preview",className:"dialog",initialize:function(){this._super(),this.options.media.get("format")==1?this.$el.addClass("youtube"):this.$el.addClass("soundcloud")},render:function(){this.$el.append(this.getHeader(o.dialog.preview));var n=this.getMessage(this.options.media.get("author")+" - "+this.options.media.get("title"));if(this.options.media.get("format")==1){this.$previewFrame=e('<iframe class="preview-frame" frameborder="0"/>'),this.$previewFrame.load(t.bind(this.onYTLoaded,this)),this.$el.append(this.getBody().append(n).append(this.$previewFrame));var i;r.isiOS?i="ytpiOS":r.isAndroid?i="ytp5":i="ytp",window.location.href.indexOf("pepper.plug.dj")>-1?i+="pepper":window.location.href.indexOf("sugar.plug.dj")>-1?i+="sugar":window.location.href.indexOf("localhost")>-1&&(i+="local"),this.$previewFrame.attr("src","http://yt-plg.appspot.com/"+i+".html")}else{var s='<object height="100%" width="100%"><param name="movie" value="https://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F'+this.options.media.get("cid")+'&amp;show_comments=false&amp;auto_play=true&amp;color=55B9FF"></param><param name="allowscriptaccess" value="always"></param><embed allowscriptaccess="always" width="100%" height="100%" src="https://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F'+this.options.media.get("cid")+'&amp;show_comments=false&amp;auto_play=true&amp;color=55B9FF" type="application/x-shockwave-flash"></embed></object>';this.$previewFrame=e('<div class="preview-frame"/>').html(s),this.$el.append(this.getBody().append(n).append(this.$previewFrame))}return this.$el.append(this.getButtons(o.dialog.close)),this._super()},onYTLoaded:function(){var e=document.getElementsByClassName("preview-frame")[0].contentWindow;e.postMessage(JSON.stringify({id:this.options.media.get("cid"),volume:s.get("lastVolume")}),"http://yt-plg.appspot.com")},onKeyEnter:function(e){return!0},submit:function(){this.close()},close:function(){this.$previewFrame&&(this.options.media.get("format")==1?this.$previewFrame.attr("src",'javascript:"<html></html>"').remove():this.$previewFrame.empty().remove()),this.$previewFrame=undefined,delete this.$previewFrame,this.options.media=undefined,u.dispatch(new a(a.PREVIEW)),this._super()}});return f}),define("ac785/b1ca1/b9816",["underscore","ac785/bc190/fea39","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/ec425","ac785/f6dac/bf313","ac785/abf10/d9a0c/ec643"],function(e,t,n,r,i,s,o){var u=t.extend({execute:function(){clearInterval(u.intervalID),clearTimeout(u.timeoutID);var t;this.event.media&&!i.get("muted")?(i.set("lastVolume",i.get("volume")),t=.15/i.get("volume")*1e3,u.intervalID=setInterval(e.bind(this.fadeToMute,this),t)):!this.event.media&&i.get("muted")&&(t=.15/i.get("lastVolume")*1e3,u.intervalID=setInterval(e.bind(this.fadeFromMute,this),t));if(this.event.media){var a=this.event.media;u.timeoutID=e.delay(function(){n.dispatch(new r(r.SHOW,new o({media:a})))},200),s.event("Media","Preview")}},fadeToMute:function(){i.get("volume")==0?this.finish():i.set("volume",Math.max(0,i.get("volume")-1))},fadeFromMute:function(){i.get("volume")==i.get("lastVolume")?this.finish():i.set("volume",Math.min(i.get("lastVolume"),i.get("volume")+1))},finish:function(){clearInterval(u.intervalID),this.event.media||clearTimeout(u.timeoutID),this._super()}});return u.intervalID=0,u.timeoutID=0,u}),define("ac785/b1ca1/d9a57",["ac785/bc190/d22bb","ac785/f04be/f1000","ac785/ca252/c0f8f","ac785/ca252/c3969","ac785/ca252/f4f89"],function(e,t,n,r,i){var s=e.extend({execute:function(){if(i.get("relatedHistory").length>0){var e=i.get("relatedHistory").pop();i.get("relatedHistory").length>0?(i.set("query",undefined,{silent:!0}).set("related",e.title),r.reset(e.items),t.page=e.page||0):i.get("relatedPlaylist")?(n.setVisible(i.get("relatedPlaylist")),t.resetRelated(),t.page=0):t.load(e.title,t.lastFormat)}this._super()}});return s}),define("ac785/d94e0/bcf57",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e){this._super(e)}});return t._name="RelatedBackEvent",t.BACK="RelatedBackEvent:back",t}),define("ac785/ca252/cb2fe",["backbone","ac785/ca252/aeeec"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("hbs!template/room/playlist/menu/PlaylistRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="activate-button">\r\n    <i class="icon icon-active-rollover"></i>\r\n</div>\r\n<span class="name"></span>\r\n<span class="count"></span>'});return t.registerPartial("template_room_playlist_menu_PlaylistRow",n),n}),define("ac785/abf10/e9abd/b19be/fbb07/a4c2e",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/b0721","ac785/d94e0/ae10c","ac785/f04be/f1000","ac785/ca252/aeeec","ac785/ca252/c0f8f","ac785/f6dac/bf313","ac785/f6dac/c41ff","ac785/abf10/bc8c0/e31ab","hbs!template/room/playlist/menu/PlaylistRow","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=t.View.extend({className:"row",events:{"click .activate-button":"onActivateClick",mouseup:"onRowRelease",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(){this.isOver=!1,this.model.on("change:name",this.onNameChange,this).on("change:items",this.onItemsChange,this).on("change:selected",this.onSelectedChange,this).on("change:visible",this.onVisibleChange,this).on("change:syncing",this.onSyncingChange,this).on("destroy",this.remove,this)},render:function(){return this.$el.html(c()),this.$activate=this.$(".activate-button"),this.$icon=this.$(".icon"),this.$name=this.$(".name"),this.$count=this.$(".count"),this.onNameChange(),this.onItemsChange(),this.onSelectedChange(),this.onVisibleChange(),this},onNameChange:function(){this.$name.text(this.model.get("name"))},onItemsChange:function(){this.$count.text(this.model.get("items").length)},onSelectedChange:function(){this.model.get("selected")?(this.$icon.removeClass("icon-active-rollover").addClass("icon-active-selected"),this.$activate.css("cursor","default").css("display","block").show()):(this.$icon.removeClass("icon-active-selected").addClass("icon-active-rollover"),this.$activate.css("cursor","pointer").css("display","block").show(),this.model.get("visible")&&this.isOver?this.$activate.show():this.$activate.hide())},onVisibleChange:function(){this.model.get("visible")?(this.$el.addClass("selected"),this.model.get("syncing")||(this.isOver||this.model.get("selected")?this.$activate.show():this.$activate.hide())):(this.$el.removeClass("selected"),this.model.get("selected")||this.$activate.hide())},onSyncingChange:function(){this.hideSpinner(),this.model.get("syncing")&&(this.spinner=new l({size:l.SMALL}),this.$el.append(this.spinner.$el),this.spinner.render().$el.css("left",21).css("top",20),this.$activate.hide())},hideSpinner:function(){this.spinner&&(this.spinner.remove(),this.spinner=undefined,(this.model.get("selected")||this.model.get("visible")&&this.isOver)&&this.$activate.show())},onActivateClick:function(){n.dispatch(new i(i.ACTIVATE)),a.event("Playlist","Activate Row")},onRowRelease:function(){if(u.getVisibleID()!=this.model.get("id"))if(!this.options.parent.selectedRows||this.options.parent.selectedRows.length==0)u.setVisible(this.model),s.resetRelated();else{var t;this.options.parent.selectedRows[0].model instanceof o?t=e.map(this.options.parent.selectedRows,function(e){return e.model}):t=e.map(this.options.parent.selectedRows,function(e){return e.model.get("media")}),n.dispatch(new r(r.INSERT,this.model,t,-1,this.options.parent.selectedRows.length))}},onMouseEnter:function(){this.model.get("visible")&&!this.model.get("selected")&&!this.model.get("syncing")&&this.$activate.show(),!this.model.get("visible")&&this.options.parent.selectedRows&&this.options.parent.selectedRows.length>0&&this.$el.addClass("drag-over"),this.isOver=!0},onMouseLeave:function(){this.model.get("visible")&&!this.model.get("selected")&&!this.model.get("syncing")&&this.$activate.hide(),this.$el.removeClass("drag-over"),this.isOver=!1},remove:function(){this._super(),this.model&&(this.model.off("change:name",this.onNameChange,this).off("change:items",this.onItemsChange,this).off("change:selected",this.onSelectedChange,this).off("change:visible",this.onVisibleChange,this).off("change:syncing",this.onSyncingChange,this).off("destroy",this.remove,this),this.model=undefined),this.off(),this.hideSpinner(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el}});return p}),define("hbs!template/room/playlist/menu/PlaylistMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="title">'+a((o=(o=t.playlist,o==null||o===!1?o:o.yourPlaylists),typeof o===u?o.apply(t):o))+'</span>\r\n<div id="room-history">\r\n    <i class="icon icon-room-history-row"></i>\r\n    <span>'+a((o=(o=t.playlist,o==null||o===!1?o:o.history),typeof o===u?o.apply(t):o))+'</span>\r\n</div>\r\n<div class="menu"></div>\r\n<div id="playlist-import" class="button">\r\n    <i class="icon icon-import"></i>\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o["import"]),typeof o===u?o.apply(t):o))+'</span>\r\n</div>\r\n<div id="playlist-create" class="button">\r\n    <div class="drop-zone"></div>\r\n    <i class="icon icon-create-playlist"></i>\r\n    <span>'+a((o=(o=t.playlist,o==null||o===!1?o:o.create),typeof o===u?o.apply(t):o))+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_menu_PlaylistMenu",n),n}),define("ac785/abf10/e9abd/b19be/fbb07/b8ba1",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/aeeec","ac785/ca252/c0f8f","ac785/f6dac/ffe62","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/b19be/fbb07/a4c2e","hbs!template/room/playlist/menu/PlaylistMenu","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l){var c=t.View.extend({id:"playlist-menu",initialize:function(){this.rows=[],this.selectedRows=undefined,s.on("reset",this.onReset,this).on("add",this.onAdd,this).on("remove",this.onRemove,this),this.drawRowBind=e.bind(this.drawRow,this)},render:function(){return this.$el.html(f(l)),this.$history=this.$("#room-history").click(e.bind(this.onHistoryClick,this)),this.$menu=this.$(".menu"),this.$import=this.$("#playlist-import").click(e.bind(this.onImportClick,this)),this.$menu.scrollTop(0),this.$create=this.$("#playlist-create").mouseup(e.bind(this.onCreateRelease,this)),this.onReset(),o.resize(e.bind(this.onResize,this)),n.on("filter:show",this.onHistoryDeselect,this).on("drag:media:start",this.onDragStart,this).on("drag:media:stop",this.onDragStop,this).on("anim:playlist:progress",this.onResize,this),this},onResize:function(e){this.$el.height(Math.max(450,e.height-this.$el.offset().top)),this.$menu.height(Math.max(250,e.height-this.$menu.offset().top-this.$create.height()))},onReset:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.$menu.empty(),s.each(this.drawRowBind)},onAdd:function(e,t){var n=new a({model:e,parent:this}),r=t.indexOf(e),i;r>0&&this.rows.length>0&&(i=this.rows[r-1]),i?(i.$el.after(n.$el),this.rows.splice(r,0,n)):(this.$menu.prepend(n.$el),this.rows.unshift(n)),n.render()},onRemove:function(e,t,n){this.rows[n.index].remove(),this.rows.splice(n.index,1)},drawRow:function(e){var t=new a({model:e,parent:this});this.$menu.append(t.$el),t.render(),this.rows.push(t)},onHistoryDeselect:function(){this.$history.removeClass("selected")},onHistoryClick:function(){n.trigger("history:show"),this.$history.addClass("selected")},onImportClick:function(){n.trigger("import:show")},onCreateRelease:function(){var t;this.selectedRows&&this.selectedRows.length>0&&(this.selectedRows[0].model instanceof i?t=e.map(this.selectedRows,function(e){return e.model}):t=e.map(this.selectedRows,function(e){return e.model.get("media")})),n.dispatch(new r(r.SHOW,new u({media:t})))},onDragStart:function(){this.$create.addClass("drag-over"),this.$history.addClass("drag-over"),this.$("#playlist-create span").text(l.playlist.createDrop)},onDragStop:function(){this.$create.removeClass("drag-over"),this.$history.removeClass("drag-over"),this.$("#playlist-create span").text(l.playlist.create)}});return new c}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/f5b19","ac785/d94e0/ab74a","ac785/f6dac/abcc8","ac785/f6dac/ffe62","ac785/abf10/e9abd/b19be/fbb07/b8ba1","ac785/abf10/bc8c0/e31ab"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({className:"media-list",initialize:function(){this.drawRowBind=t.bind(this.drawRow,this),this.rows=[],this.selectedRows={},this.baseSelectedRowIndex=-1,this.lastClickedIndex=0,this.lastClickedRow=undefined,this.currentDragRow=undefined,this.noModifier=!1,this.doubleClickTime=0,this.doubleClickThreshold=500,this.doubleClickRowData=null,this.pressMouseX=0,this.pressMouseY=0,this.isDragging=!1,this.withinBounds=!1,this.dragIntervalID=0,this.mouseX=0,this.mouseY=0,this.playlistID=0,this.DRAG_THRESHOLD=5,this.scrollLock=!1,this.deletePending=!1,this.documentReleaseBind=t.bind(this.onDocumentRelease,this),this.thresholdBind=t.bind(this.onCheckThreshold,this),this.mousePositionBind=t.bind(this.onMousePosition,this),this.$dragRowLine=e("<div/>").addClass("drag-row-line"),this.$dragRowLine.hide(),this.$dragIcon=e("<div/>").addClass("drag-media-box").append(e("<div/>").addClass("drag-media-corner")).append(e("<i/>").addClass("icon icon-drag-media")).append(e("<span/>").addClass("drag-media-label")),this.$dragIcon.hide(),this.resizeBind=t.bind(this.onResize,this),this.$el.scrollTop(0),this.$el.addClass(this.listClass)},onCollectionReset:function(){var e;this.scrollLock&&(e=this.$el.scrollTop()),this.clear(),this.drawList(),e?this.$el.scrollTop(e):this.$el.scrollTop(0),this.scrollLock=this.deletePending=!1},onResize:function(e){e=e||u.getSize(),this.$el.height(Math.max(350,e.height-this.$el.offset().top)),this.deletePending||(this.scrollLock=!1)},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.$el.empty(),this.hideLoadSpinner()},render:function(){return this.$el.empty(),this.collection.on("reset",this.onCollectionReset,this),this.onCollectionReset(),this.collection.length==0&&this.showLoadSpinner(),t.delay(t.bind(this.checkForZero,this),250),u.resize(this.resizeBind),r.on("anim:playlist:progress",this.onResize,this),this},checkForZero:function(){},remove:function(){this.clear(),this.clearSelection(),this.hideLoadSpinner(),this.collection.off("reset",this.onCollectionReset,this),u.off("resize",this.resizeBind),r.off("anim:playlist:progress",this.onResize,this),this._super()},drawList:function(){this.collection.each(this.drawRowBind)},showLoadSpinner:function(){this.hideLoadSpinner(),this.loadSpinner=new f({size:f.MEDIUM}),this.$el.append(this.loadSpinner.$el),this.loadSpinner.render().$el.css("left","50%").css("top","40%").css("z-index",9999)},hideLoadSpinner:function(){this.loadSpinner&&(this.loadSpinner.remove(),this.loadSpinner=undefined)},clearSelection:function(){this.selectedRows={},this.selectedRowIndex=0,this.baseSelectedRowIndex=-1,this.updateSelectedRows()},drawRow:function(e,t){var n=new this.RowClass({className:"row "+this.getRowClassName(t),model:e,index:t,selected:this.selectedRows[e.get("cid")]!=undefined});return this.$el.append(n.$el),n.render(),n.on("action",this.onRowAction,this).on("press",this.onRowPress,this).on("over",this.onRowOver,this).on("out",this.onRowOut,this).on("release",this.onRowRelease,this),this.rows.push(n),n.options.selected&&(this.selectedRows[e.get("cid")]=n),this.baseSelectedRowIndex==-1&&n.options.selected&&(this.baseSelectedRowIndex=t),n},getRowClassName:function(e){return"playlist-media-item"},onRowAction:function(e){if(e.action=="add")r.dispatch(new i(i.ADD,this.getSelectedRows(),e.row.model,undefined,e.event.target));else if(e.action=="delete"){var t=this.getSelectedRows();this.scrollLock=t.length<this.rows.length-t.length,this.deletePending=!0,r.dispatch(new i(i.DELETE,t,e.row.model,e.row.options.index))}else e.action=="edit"?r.dispatch(new i(i.EDIT,undefined,e.row.model)):e.action=="move-to-top"?(this.scrollLock=!0,r.dispatch(new i(i.MOVE_TO_TOP,this.getSelectedRows(),e.row.model))):e.action=="play-next"?r.dispatch(new i(i.PLAY_NEXT,undefined,e.row.model)):e.action=="related"&&r.dispatch(new i(i.RELATED,undefined,e.row.model))},onRowPress:function(t){e("*:focus")[0]&&e("*:focus")[0].nodeName=="INPUT"&&e("*:focus")[0].blur(),o.isMac&&(t.event.ctrlKey=t.event.metaKey);var n=!1;if(!t.row.isNowPlaying||t.row.options.index>0){this.noModifier=!1,this.lastClickedIndex=t.row.options.index;if(!t.event.shiftKey&&!t.event.ctrlKey)this.baseSelectedRowIndex==-1||!t.row.options.selected?this.selectSingleRow(t.row):this.noModifier=!0,(new Date).getTime()-this.doubleClickTime<this.doubleClickThreshold&&t.row.model==this.doubleClickRowData&&(n=!0,this.doubleClickRow(t.row)),this.doubleClickTime=(new Date).getTime(),this.doubleClickRowData=t.row.model;else if(t.event.ctrlKey&&!t.event.shiftKey)this.baseSelectedRowIndex=t.row.options.index,this.toggleRow(t.row);else if(t.event.shiftKey&&!t.event.ctrlKey)this.baseSelectedRowIndex==-1?(this.baseSelectedRowIndex=t.row.options.index,this.toggleRow(t.row)):this.baseSelectedRowIndex>t.row.options.index?this.selectMultipleRows(this.baseSelectedRowIndex,t.row.options.index):this.baseSelectedRowIndex<t.row.options.index&&this.selectMultipleRows(t.row.options.index,this.baseSelectedRowIndex);else if(t.event.ctrlKey&&t.event.shiftKey){var r,i;if(this.baseSelectedRowIndex==-1)this.selectSingleRow(t.row.options.index);else if(t.row.options.index>this.baseSelectedRowIndex)if(this.selectedRows[this.collection.at(this.baseSelectedRowIndex).get("cid")])this.selectMultipleRows(t.row.options.index,this.baseSelectedRowIndex);else{var s=this.collection.length;for(r=0;r<s;++r)if(this.selectedRows[this.collection.at(r).get("cid")]){i=r;break}this.selectMultipleRows(t.row.options.index,i)}else if(t.row.options.index<this.baseSelectedRowIndex)if(this.selectedRows[this.collection.at(this.baseSelectedRowIndex).get("cid")])this.selectMultipleRows(this.baseSelectedRowIndex,t.row.options.index);else{r=this.collection.length;while(r--)if(this.selectedRows[this.collection.at(r).get("cid")]){i=r;break}this.selectMultipleRows(i,t.row.options.index)}this.baseSelectedRowIndex=t.row.options.index}!n&&this.baseSelectedRowIndex>-1&&(this.pressMouseX=t.event.pageX,this.pressMouseY=t.event.pageY,e(document).on("mousemove",this.thresholdBind),e(document).on("mouseup",this.documentReleaseBind))}},onRowRelease:function(t){this.isDragging||(this.baseSelectedRowIndex>-1&&this.noModifier&&(!t.row.isNowPlaying||t.row.options.index>0)&&this.selectSingleRow(t.row),e(document).off("mousemove",this.thresholdBind)),this.resetDrag()},onRowOver:function(e){this.isDragging||e.row.showActions(),this.currentDragRow=e.row},onRowOut:function(){},onDocumentRelease:function(e){this.resetDrag()},doubleClickRow:function(t){e(document).off("mousemove",this.thresholdBind),this.resetDrag(),this.lastClickedRow=t,r.dispatch(new s(s.PREVIEW,t.model))},onCheckThreshold:function(n){if(n.pageX>this.pressMouseX+this.DRAG_THRESHOLD||n.pageX<this.pressMouseX-this.DRAG_THRESHOLD||n.pageY>this.pressMouseY+this.DRAG_THRESHOLD||n.pageY<this.pressMouseY-this.DRAG_THRESHOLD){this.isDragging=!0;var r=this.getSelectedRows();a.selectedRows=r,e(document).off("mousemove",this.thresholdBind),this.$dragIcon.find(".drag-media-label").text(r.length),e(document).on("mousemove",this.mousePositionBind),clearInterval(this.dragIntervalID),this.dragIntervalID=setInterval(t.bind(this.onDragUpdate,this),20),this.onMousePosition(n),this.onDragUpdate(undefined),this.startDrag(),e(document.body).append(this.$dragIcon)}},selectSingleRow:function(e){this.selectedRows={},this.updateSelectedRows(),this.toggleRow(e),this.lastClickedRow=e,this.baseSelectedRowIndex=e.options.selected?e.options.index:-1,this.baseSelectedRowIndex==-1?this.selectedRowIndex=0:this.selectedRowIndex=this.baseSelectedRowIndex},selectMultipleRows:function(e,t){for(var n=e;n>=t;n--)this.selectedRows[this.collection.at(n).get("cid")]=this.rows[n];this.updateSelectedRows()},updateSelectedRows:function(){var e=this;t.each(this.rows,function(t){t.select(e.selectedRows[t.model.get("cid")]!=undefined)})},selectAll:function(){this.selectMultipleRows(this.collection.length-1,0)},toggleRow:function(e){e.select(!e.options.selected),e.options.selected?this.selectedRows[e.model.get("cid")]=e:delete this.selectedRows[e.model.get("cid")]},getSelectedRows:function(e){var t=[],n;for(n in this.selectedRows)t.push(this.selectedRows[n]);return t.sort(this.sortSelectedRows),t},sortSelectedRows:function(e,t){return e.options.index<t.options.index?-1:e.options.index>t.options.index?1:0},resetDrag:function(){this.isDragging=!1,this.currentDragRow=undefined,a.selectedRows=undefined,e(document).off("mouseup",this.documentReleaseBind).off("mousemove",this.mousePositionBind),clearInterval(this.dragIntervalID),this.$dragRowLine.remove(),this.$dragIcon.remove(),r.trigger("drag:media:stop")},jumpToIndex:function(e){this.$el.scrollTop(e*47),this.selectSingleRow(this.rows[e])},onMousePosition:function(e){this.mouseX=e.pageX,this.mouseY=e.pageY},onDragUpdate:function(e){if(this.currentDragRow){this.$dragIcon.css("left",this.mouseX+1),this.$dragIcon.css("top",this.mouseY+1),this.$dragIcon.is(":visible")||this.$dragIcon.show(),this.onCheckListScroll(this.$el);if(!this.withinBounds){var t=a.$menu,n=t.scrollTop(),r=t.offset().top,i=t.offset().left,s=i+t.width(),o=t.height(),u,f;this.mouseX>=i&&this.mouseX<=s&&(this.mouseY<r?(u=(r-this.mouseY)/2,f=Math.max(0,n-u),t.scrollTop(f)):this.mouseY>r+o&&(u=(this.mouseY-(r+o))/2,f=Math.min(n+u,t[0].scrollHeight-o),t.scrollTop(f)))}}},onCheckListScroll:function(e){var t=e.offset().top,n=e.offset().left,r=n+e.width(),i=e.scrollTop(),s,o,u=e.height();if(this.mouseX>=n&&this.mouseX<=r){this.withinBounds=!0;if(this.mouseY<t)return s=(t-this.mouseY)/1.25,o=Math.max(0,i-s),e.scrollTop(o),o;if(this.mouseY>t+u)return s=(this.mouseY-(t+u))/1.25,o=Math.min(i+s,e[0].scrollHeight-u),e.scrollTop(o),o+e.height()-2}else this.withinBounds=!1;return-10},startDrag:function(){r.trigger("drag:media:start")}});return l}),define("hbs!template/room/playlist/media/actions/ActionsPlaylistMedia",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action edit">\r\n    <i class="icon icon-edit-white"></i>\r\n</div>\r\n<div class="action related">\r\n    <i class="icon icon-related"></i>\r\n</div>\r\n<div class="action move-to-top">\r\n    <i class="icon icon-move-to-top"></i>\r\n</div>\r\n<div class="action delete">\r\n    <i class="icon icon-delete"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsPlaylistMedia",n),n}),define("hbs!template/room/playlist/media/actions/ActionsPlaylistMediaFirst",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action edit">\r\n    <i class="icon icon-edit-white"></i>\r\n</div>\r\n<div class="action related">\r\n    <i class="icon icon-related"></i>\r\n</div>\r\n<div class="action delete">\r\n    <i class="icon icon-delete"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsPlaylistMediaFirst",n),n}),define("hbs!template/room/playlist/media/actions/ActionsPlaylistMediaLocked",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action edit">\r\n    <i class="icon icon-edit-white"></i>\r\n</div>\r\n<div class="action related">\r\n    <i class="icon icon-related"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsPlaylistMediaLocked",n),n}),define("hbs!template/room/playlist/media/actions/ActionsSearchMedia",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action add">\r\n    <i class="icon icon-add"></i>\r\n</div>\r\n<div class="action related">\r\n    <i class="icon icon-related"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsSearchMedia",n),n}),define("hbs!template/room/playlist/media/actions/ActionsSearchLocal",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action play-next">\n    <i class="icon icon-play-next"></i>\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsSearchLocal",n),n}),define("hbs!template/room/playlist/media/actions/ActionsImportMedia",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action add">\n    <i class="icon icon-add"></i>\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsImportMedia",n),n}),define("hbs!template/room/playlist/media/actions/ActionsHistory",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="action add">\r\n    <i class="icon icon-add"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_actions_ActionsHistory",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/aab00",["underscore","backbone","hbs!template/room/playlist/media/actions/ActionsPlaylistMedia","hbs!template/room/playlist/media/actions/ActionsPlaylistMediaFirst","hbs!template/room/playlist/media/actions/ActionsPlaylistMediaLocked","hbs!template/room/playlist/media/actions/ActionsSearchMedia","hbs!template/room/playlist/media/actions/ActionsSearchLocal","hbs!template/room/playlist/media/actions/ActionsImportMedia","hbs!template/room/playlist/media/actions/ActionsHistory"],function(e,t,n,r,i,s,o,u,a){var f=t.View.extend({className:"actions",initialize:function(){this.templates={},this.templates.playlistMedia=n(),this.templates.playlistMediaFirst=r(),this.templates.playlistMediaLocked=i(),this.templates.searchMedia=s(),this.templates.searchLocal=o(),this.templates.importMedia=u(),this.templates.history=a(),this.current=undefined},show:function(e){this.templates[e]&&this.current!=this.templates[e]&&(this.current=this.templates[e],this.$el.html(this.current))},render:function(){return this.$el.empty(),this}});return f}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb",["backbone","ac785/abf10/e9abd/b19be/bbe20/d2a6f/aab00","ac785/abf10/e9abd/ddb98/f882d"],function(e,t,n){var r=e.View.extend({className:"row",events:{mouseenter:"onRowEnter",mouseleave:"onRowLeave",mousedown:"onRowPress",mouseup:"onRowRelease"},initialize:function(){this.model.on("change",this.onChange,this)},remove:function(){this._super(),this.model&&(this.model.off("change",this.onChange,this),this.model=undefined),this.off(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onChange:function(e){},render:function(){return this},select:function(e){this.options.selected!=e&&(this.options.selected=e,this.update())},update:function(){this.options.selected?this.$el.addClass("selected"):this.$el.removeClass("selected")},getAction:function(){return"playlistMedia"},showActions:function(){r.actions.show(this.getAction()),this.$el.append(r.actions.$el)},onRowEnter:function(e){n.hide(),r.actions.remove(),this.trigger("over",{event:e,row:this})},onRowLeave:function(e){n.isShowing||r.actions.remove(),this.trigger("out",{event:e,row:this})},onRowPress:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.target.parentNode&&e.target.parentNode.className.indexOf("action ")==0?this.trigger("action",{event:e,row:this,action:e.target.parentNode.className.substr(7)}):this.trigger("press",{event:e,row:this})},onRowRelease:function(e){this.trigger("release",{event:e,row:this})}});return r.actions=new t,r}),define("hbs!template/room/playlist/media/list/PlaylistMediaRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<img src="',(o=n.image)?o=o.call(t,{hash:{}}):(o=t.image,o=typeof o===u?o.apply(t):o),s+=a(o)+'"/>\r\n<div class="meta">\r\n    <span class="author">',(o=n.author)?o=o.call(t,{hash:{}}):(o=t.author,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="title">',(o=n.title)?o=o.call(t,{hash:{}}):(o=t.title,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="duration">',(o=n.duration)?o=o.call(t,{hash:{}}):(o=t.duration,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_list_PlaylistMediaRow",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/fa74d",["backbone","ac785/ca252/ec425","ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb","hbs!template/room/playlist/media/list/PlaylistMediaRow","ac785/f6dac/d17c3"],function(e,t,n,r,i){var s=e.View.extend({className:"row",events:{mouseenter:"onRowEnter",mouseleave:"onRowLeave",mouseup:"onRowRelease"},render:function(){return this.$el.html(r({image:this.model.get("image"),author:this.model.get("author"),title:this.model.get("title"),duration:i.formatTime(this.model.get("duration"),!1)})),this},remove:function(){this._super(),this.off(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onRowEnter:function(){this.$el.addClass("selected")},onRowLeave:function(){this.$el.removeClass("selected")},onRowRelease:function(){t.set({restricted:t.get("media"),media:this.model})}});return s}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/be6ae",["underscore","ac785/ca252/cb2fe","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/fa74d","ac785/abf10/bc8c0/e31ab"],function(e,t,n,r,i){var s=Backbone.View.extend({className:"media-list",collection:t,initialize:function(){this.rows=[],this.drawRowBind=e.bind(this.drawRow,this)},render:function(){return this.$el.empty(),this.collection.on("reset",this.onCollectionReset,this),this.onCollectionReset(),this.collection.length==0&&this.showLoadSpinner(),this},remove:function(){this.collection.off("reset",this.onCollectionReset,this),this.clear(),this._super(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onCollectionReset:function(){this.clear(),this.drawList(),this.$el.scrollTop(0)},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.$el.empty(),this.hideLoadSpinner()},drawList:function(){this.collection.each(this.drawRowBind)},drawRow:function(e,t){var n=new r({model:e,index:t});this.$el.append(n.$el),n.render(),this.rows.push(n)},showLoadSpinner:function(){this.hideLoadSpinner(),this.loadSpinner=new i({size:i.MEDIUM}),this.$el.append(this.loadSpinner.$el),this.loadSpinner.render().$el.css("left","50%").css("top","40%").css("z-index",9999)},hideLoadSpinner:function(){this.loadSpinner&&(this.loadSpinner.remove(),this.loadSpinner=undefined)}});return s}),define("ac785/abf10/d9a0c/b2027",["jquery","ac785/abf10/d9a0c/fbb95","ac785/abf10/e9abd/b19be/bbe20/d2a6f/be6ae","lang/Lang"],function(e,t,n,r){var i=t.extend({id:"dialog-restricted-media",className:"dialog destructive",initialize:function(){this._super(),this.restrictedList=new n},render:function(){return this.$el.append(this.getHeader(r.dialog.restricted)).append(this.getBody().append(e("<span/>").addClass("media-name").text(this.options.media.get("author")+" - "+this.options.media.get("title"))).append(e("<div/>").addClass("divider")).append(this.getMessage("")).append(this.restrictedList.$el)).append(this.getButtons(r.dialog.waitForNextDJ)),this.restrictedList.render(),this._super()},onResponse:function(e){var t;e&&e.length>0?t=r.dialog.chooseAlternative:(t=r.dialog.noAlternative,this.$el.addClass("no-alternative"),this.onResize()),this.$(".message").text(t)},onKeyEnter:function(e){return e.preventDefault(),!1},submit:function(){this.close()},close:function(){this.options.media=undefined,this.restrictedList.remove(),this.restrictedList=undefined,this._super()}});return i}),define("ac785/b1ca1/cdf7e",["underscore","ac785/bc190/fea39","ac785/d94e0/bd874","ac785/ca252/ec425","ac785/ca252/cb2fe","ac785/e734f/a3e81","ac785/ab6db/e1b12","ac785/abf10/d9a0c/b2027"],function(e,t,n,r,i,s,o,u){var a=t.extend({execute:function(){this.data=[],i.reset();var t=r.get("media");this.dialog=new u({media:t}),this.dispatch(new n(n.SHOW,this.dialog));var o=t.get("author")+" "+t.get("title");t.get("format")=="2"?s.scSearch(o,0,10,e.bind(this.onResult,this)):s.ytSearch(o,0,10,e.bind(this.onResult,this))},onResult:function(e){if(e&&e.length>0){var t,n=e.length,r={};for(t=0;t<n;++t)if(!r[e[t].cid]){var s=e[t].cid,u=o.lookup(s);u&&(r[s]=!0,this.data.push(u))}for(t=0;t<n;++t)r[e[t].cid]||this.data.push(e[t]);i.reset(this.data)}this.finish()},finish:function(){this.dialog.onResponse(this.data),this.data=undefined,this.dialog=undefined,this._super()}});return a}),define("ac785/d94e0/df73d",["ac785/d94e0/b584a"],function(e){var t=e.extend({});return t._name="RestrictedSearchEvent",t.SEARCH="RestrictedSearchEvent:search",t}),define("ac785/e734f/aa464/a00ed",["ac785/c3562/d4511","ac785/e734f/b669d","ac785/f6dac/d17c3"],function(e,t,n){var r=t.extend({execute:function(){e.execute("moderate.bans",this)},parse:function(e){if(e.status==0){var t=e.data.length;while(t--)e.data[t].timestamp=n.convertUnixDateStringToNumberString(e.data[t].timestamp);this.successCallback(e.data)}else this.onStatusError(e.status)}});return r}),define("ac785/b1ca1/ad5d8",["underscore","ac785/bc190/fea39","ac785/ca252/ccfb5","ac785/e734f/aa464/a00ed"],function(e,t,n,r){var i=t.extend({execute:function(){n.reset();var t=new r;t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.onError,this)},onResponse:function(e){n.reset(e),this.finish()},onError:function(e){n.reset(),this.finish()}});return i}),define("ac785/e734f/e9abd/cd33d",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.id=e,this._super()},execute:function(){t.execute("room.staff",this,this.id)},parse:function(e){e.status==0?this.successCallback(e.data):this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/f6756",["underscore","ac785/bc190/fea39","ac785/ca252/c512b","ac785/ca252/a985d","ac785/ca252/fae6c","ac785/e734f/e9abd/cd33d"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){r.reset();var t=new s(n.get("id"));t.successCallback=e.bind(this.onResponse,this),t.errorCallback=e.bind(this.onError,this)},onResponse:function(e){var t=n.get("staff"),s=[],o=e.length;for(var u=0;u<o;++u)e[u].permission=t[e[u].id],e[u].relationship=i.getRelationship(e[u].id),e[u].permission>0&&s.push(e[u]);r.reset(s),this.finish()},onError:function(e){r.reset(),this.finish()}});return o}),define("ac785/e734f/e9abd/ffe2f",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.name=e,this.isPublic=t,this._super()},execute:function(){t.execute("room.create",this,this.name,this.isPublic)},parse:function(e){e.status==0?this.successCallback(e):this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/d5a1d",["underscore","ac785/bc190/fea39","ac785/e734f/e9abd/ffe2f","ac785/d94e0/a045f","ac785/d94e0/fb1a1","lang/Lang"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){var t=new n(this.event.name,this.event.isPublic);t.successCallback=e.bind(this.onCreateResponse,this),t.errorCallback=e.bind(this.onServiceError,this)},onCreateResponse:function(e){window.history.pushState(null,this.name,"/"+e.data+"/"),this.dispatch(new r(r.JOIN,e.data)),this.finish()},onServiceError:function(e){e==5&&this.dispatch(new i(i.ALERT,undefined,s.alerts.createRoom+e)),this.finish()}});return o}),define("ac785/d94e0/cb4b7",["ac785/d94e0/b584a"],function(e){var t=e.extend({init:function(e,t,n){this._super(e),this.name=t,this.isPublic=n}});return t._name="RoomCreateEvent",t.CREATE="RoomCreateEvent:create",t}),define("ac785/ca252/b223b",["underscore","backbone"],function(e,t){var n=t.Model.extend({defaults:{id:"",host:"",djCount:0,name:"",media:"",userCount:0,friends:[],custom:!1,"private":!1}});return n}),define("ac785/ca252/e503d",["backbone","ac785/ca252/b223b"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/e734f/e9abd/ff719",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.query=e||"",this.cursor=t,this._super()},execute:function(){t.execute("room.search",this,this.query,this.cursor)},parse:function(e){e.status==0?this.successCallback(e.data):this.onStatusError(e.status)}});return n}),define("ac785/f04be/fac07",["underscore","ac785/bc190/b96e1","ac785/ca252/e503d","ac785/ca252/b223b","ac785/e734f/e9abd/ff719"],function(e,t,n,r,i){var s=t.extend({init:function(){this.lastQuery=undefined,this.lastCursor=undefined,this.pending=!1,this.endOfList=!1,this.timestamp=Date.now(),this.successBind=e.bind(this.onSuccess,this),this.errorBind=e.bind(this.onError,this)},load:function(e,t){if(!this.pending){if(e!=this.lastQuery||!t)n.reset(),this.endOfList=!1;this.timestamp=Date.now(),this.pending=!0,this.lastQuery=e,this.lastCursor=t;var r=new i(e,t);r.successCallback=this.successBind,r.errorCallback=this.errorBind}},more:function(){this.endOfList||this.load(this.lastQuery,this.lastCursor)},onSuccess:function(e){this.pending=!1,this.lastCursor=e.cursor;if(e.results.length==0){this.endOfList=!0;return}n.add(e.results,{merge:!0})},onError:function(){this.pending=!1}});return new s}),define("ac785/e734f/e9abd/bc2b1",["ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(e){this.id=e,this._super()},execute:function(){e.execute("room.details",this,this.id)},parse:function(e){this.successCallback(e)}});return n}),define("ac785/e734f/e9abd/da667",["ac785/c3562/f9d8b","ac785/e734f/b669d"],function(e,t){var n=t.extend({init:function(e){this.id=e,this._super()},execute:function(){console.log("sjs join",this.id),e.execute("room.join",this,this.id,"fe940c")},parse:function(e){e.status==0||e.status==2||e.status==3||e.status==4||e.status==404?this.successCallback&&this.successCallback(e):this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/fa2b3",["jquery","underscore","ac785/bc190/fea39","ac785/b1ca1/a8750","ac785/d94e0/fb1a1","ac785/d94e0/a461e","ac785/d94e0/fd72e","ac785/d94e0/e001a","ac785/f04be/c8b95","ac785/f04be/fac07","ac785/ca252/a9a95","ac785/ca252/f89d8","ac785/ca252/b276e","ac785/ca252/ec425","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/ca252/bed74","ac785/c3562/f9d8b","ac785/e734f/e9abd/bc2b1","ac785/e734f/e9abd/da667","ac785/ab6db/ffb2a","ac785/f6dac/f643f","ac785/f6dac/afc91","ac785/f6dac/bf313","ac785/f6dac/d4236","ac785/f6dac/d17c3","ac785/abf10/e9abd/a97ff","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){var O=n.extend({execute:function(){this.tries=0,x.enabled=!1,p.set({media:undefined,mediaStartTime:undefined,duration:0,playlistID:undefined}),c.reset(),y.reset(),m.set("vote",0),d.get("joined")&&a.clear(),d.set(d.defaults),h.reset(),C.init(),r.synced=!1,f.timestamp=0,this.trigger("custom:unload"),this.trigger("room:joining");var e=new E(this.event.id);e.successCallback=t.bind(this.onJoinResponse,this),e.errorCallback=t.bind(this.onServiceError,this),b.sioJoin(this.event.id)},onJoinResponse:function(e){console.log("room joined");if(e.status==0){window.Slug?window.Slug=undefined:N.page(this.event.id),T.setServerTime(k.convertUnixDateStringToDate(e.data.serverTime)),this.getDetails();return}e.status==2||e.status==3?window.location.href="/communities/?ref=banned&reason=1":e.status==4&&(window.location.href="/"+encodeURIComponent(this.event.id)),this.finish()},getDetails:function(){var e=new w(this.event.id);e.successCallback=t.bind(this.onDetailsResponse,this),e.errorCallback=t.bind(this.onServiceError,this)},onDetailsResponse:function(e){if(e.status==0){S.ready(e.data.user.profile.id),S.settings.rollovers||L.disableRollovers(),document.title="plug.dj - "+e.data.room.name,N.enabled&&(!e.data.room.custom||e.data.room.lounge)&&(e.data.room.custom="/_/static/js/custom/winter.93c6b40.js");var n=this;e.data.user.profile.username=e.data.user.profile.username.split("<").join("").split(">").join(""),m.parse(e.data.user),l.valid[e.data.user.profile.avatarID]||(this.dispatch(new s(s.CHANGE,"animal05")),m.set("avatarID","animal05")),v.parse(e.data.room),b.sioJoin(this.event.id),this.dispatch(new u(u.SYNC)),this.trigger("room:joined",e.data.room.custom),c.isTheUserInBooth&&this.trigger("autojoin:check"),x.enabled=!0,l.onPointsChange(),l.setSelected(m.get("avatarID")),m.hasPermission(g.ADMIN)&&console.log("RoomDetailsResponse ",e.data),d.get("welcome")&&a.receive({type:"welcome",message:d.get("welcome")}),t.delay(function(){n.dispatch(new o(o.SYNC))},500),this.finish()}else this.tries++<3?this.getDetails():(this.dispatch(new i(i.ALERT,A.alerts.update,"Error Joining Room (err: "+e.status+"). Click OK to retry.",t.bind(k.forceRefresh,k),!0)),this.finish())},onServiceError:function(e){console.error("Room Join Error :: "+e),this.finish()}});return O}),define("ac785/e734f/e9abd/a0f5d",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.id=e,this._super()},execute:function(){console.log("rpc room.state"),t.execute("room.state",this,this.id)},parse:function(e){this.successCallback(e)}});return n}),define("ac785/b1ca1/c2595",["underscore","ac785/bc190/fea39","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/e734f/e9abd/da667","ac785/e734f/e9abd/a0f5d"],function(e,t,n,r,i,s){var o=t.extend({execute:function(){var t=new s(this.event.id);t.successCallback=e.bind(this.onStateResponse,this),t.errorCallback=e.bind(this.onStateError,this),this._super()},onStateResponse:function(e){e.status==0||e.status==1?(e.status==0&&r.parseState(e.data),new i(n.get("id"))):e.status==4?window.location.href="/"+encodeURIComponent(n.get("id")):this.onStateError(e.status),this.finish()},onStateError:function(e){window.location.href="/"+encodeURIComponent(n.get("id")),this.finish()}});return o}),define("ac785/e734f/ea1d8/def4f",["ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t,n,r){var i=r.extend({init:function(e,t){this.ids=e,this.pos=t,this._super()},execute:function(){n.execute("user.get_by_ids",this,this.ids)},parse:function(n){if(n.status==0){n.data.constructor!=Array&&(n.data=[n.data]);var r=n.data.length;for(var i=0;i<r;++i){n.data[i].owner=n.data[i].id==e.get("ownerID");var s;e.get("admins")[n.data[i].id]?s=10:e.get("ambassadors")[n.data[i].id]?s=e.get("ambassadors")[n.data[i].id]+6:s=e.get("staff")[n.data[i].id]||0,n.data[i].permission=s}if(this.successCallback!=null){var o=t.getOrCreateUserModel(n.data[0],!0);this.pos?this.successCallback(o,this.pos):this.successCallback(n.data)}}else this.onStatusError(n.status)}});return i}),define("hbs!template/room/chat/ChatSuggestion",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="frame-background"></div>\r\n<div id="chat-mention-suggestion-items"></div>'});return t.registerPartial("template_room_chat_ChatSuggestion",n),n}),define("hbs!template/room/chat/ChatSuggestionItem",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="chat-mention-suggestion-item" data-index="',(o=n.index)?o=o.call(t,{hash:{}}):(o=t.index,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\r\n    <span>',(o=n.username)?o=o.call(t,{hash:{}}):(o=t.username,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <div class="chat-mention-suggestion-item-line"></div>\r\n</div>',s});return t.registerPartial("template_room_chat_ChatSuggestionItem",n),n}),define("ac785/abf10/e9abd/eccfb/bf47e",["jquery","underscore","backbone","hbs!template/room/chat/ChatSuggestion","hbs!template/room/chat/ChatSuggestionItem","ac785/f6dac/d4236"],function(e,t,n,r,i,s){var o=n.View.extend({id:"chat-mention-suggestion",initialize:function(){this.suggestions=[],this.index=-1,this.hideTimeoutID=0,this.hideBind=t.bind(this.hide,this),this.showBind=t.bind(this.show,this),this.overBind=t.bind(this.onSuggestionOver,this),this.pressBind=t.bind(this.onSuggestionPress,this),this.refocusBind=t.bind(this.onRefocusInput,this),this.documentClickBind=t.bind(this.onDocumentClick,this),this.$document=e(document)},render:function(){return this.$el.html(r()),this.$itemContainer=this.$("#chat-mention-suggestion-items"),this},check:function(e,t){var n=e.lastIndexOf(" @");n==-1&&(n=e.indexOf("@")),n>-1&&(n==0?this.suggestions=s.lookup(e.substr(n+1,t)):n>0&&t>n+2&&(this.suggestions=s.lookup(e.substr(n+2,t))))},upDown:function(e){this.suggestions.length>1&&(e==40?++this.index:--this.index,this.index==-1?this.index=this.suggestions.length-1:this.index==this.suggestions.length&&(this.index=0),this.updateSelectedSuggestion())},updateSuggestions:function(){var n=this.suggestions.length;this.$itemContainer.html("");if(n==0)this.$el.hide(),this.index=-1;else{for(var r=0;r<n;++r)this.$itemContainer.append(e(i({username:this.suggestions[r].username,index:r})).mousedown(this.pressBind).mouseenter(this.overBind));if(this.index==-1||this.index>=n)this.index=0;this.updateSelectedSuggestion(),this.$el.height(n*22),t.delay(this.showBind,10),t.delay(this.showBind,15),this.$document.on("mousedown",this.documentClickBind)}},getSelected:function(){return this.suggestions[this.index].username},onSuggestionPress:function(e){this.index=e.currentTarget.dataset.index,this.trigger("submitSuggestion"),t.delay(this.refocusBind,100)},onSuggestionOver:function(t){this.index=t.currentTarget.dataset.index;var n=this.index;this.$(".chat-mention-suggestion-item").each(function(t){t==n?e(this).css("background","#45a8dc"):e(this).css("background","transparent")})},updateSelectedSuggestion:function(){var t=this.index;this.$(".chat-mention-suggestion-item").each(function(n){n==t?e(this).css("background","#45a8dc"):e(this).css("background","transparent")})},show:function(){var t=0;this.$(".chat-mention-suggestion-item span").each(function(){var n=e(this).width();n>t&&(t=n)}),this.$el.width(t+10),this.$el.show()},hide:function(){this.reset(),clearTimeout(this.hideTimeoutID),this.$el.is(":visible")&&(this.$itemContainer.html(""),this.$el.hide()),this.$document.off("mousedown",this.documentClickBind)},onDocumentClick:function(e){this.$el.is(":visible")&&(clearTimeout(this.hideTimeoutID),this.hideTimeoutID=t.delay(this.hideBind,150))},onRefocusInput:function(){this.trigger("refocus")},reset:function(){this.index=-1,this.suggestions=[]}});return o}),define("hbs!template/room/chat/Chat",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div id="chat-header">\r\n    <div class="divider"></div>\r\n    <div id="chat-timestamp-button" class="chat-header-button">\r\n        <i class="icon icon-timestamps-12"></i>\r\n    </div>\r\n    <div id="chat-sound-button" class="chat-header-button">\r\n        <i class="icon icon-chat-sound-on"></i>\r\n    </div>\r\n    <div id="chat-popout-button" class="chat-header-button">\r\n        <i class="icon icon-chat-popout"></i>\r\n    </div>\r\n    <div id="chat-emoji-button" class="chat-header-button">\r\n        <i class="icon icon-emoji-on"></i>\r\n    </div>\r\n    <div id="chat-mentions-button" class="chat-header-button">\r\n        <i class="icon icon-mention-off"></i>\r\n    </div>\r\n</div>\r\n<div id="chat-messages"></div>\r\n<div id="chat-input">\r\n    <form class="chat-input-form" onsubmit="return false">\r\n        <input id="chat-input-field" type="text" value="" placeholder="'+a((o=(o=t.chat,o==null||o===!1?o:o.placeholder),typeof o===u?o.apply(t):o))+'" maxlength="256"/>\r\n    </form>\r\n</div>',s});return t.registerPartial("template_room_chat_Chat",n),n}),define("ac785/abf10/e9abd/eccfb/b59f0",["jquery","underscore","backbone","swfobject","ac785/bc190/cd0b8","ac785/d94e0/bad16","ac785/d94e0/a2e23","ac785/f04be/c8b95","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/ea1d8/def4f","ac785/ab6db/ffb2a","ac785/f6dac/abcc8","ac785/f6dac/ffe62","ac785/f6dac/bf313","ac785/f6dac/c41ff","ac785/f6dac/d17c3","ac785/abf10/e9abd/eccfb/bf47e","ac785/abf10/bc8c0/e31ab","hbs!template/room/chat/Chat","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){var x=n.View.extend({id:"chat",events:{"click #chat-sound-button":"onSoundClick","click #chat-timestamp-button":"onTimestampClick","click #chat-popout-button":"onPopoutClick","click #chat-emoji-button":"onEmojiClick","click #chat-mentions-button":"onMentionsClick","mouseenter #chat-sound-button":"onSoundEnter","mouseleave #chat-sound-button":"onHideTooltip","mouseenter #chat-timestamp-button":"onTimestampEnter","mouseleave #chat-timestamp-button":"onHideTooltip","mouseenter #chat-popout-button":"onPopoutEnter","mouseleave #chat-popout-button":"onHideTooltip","mouseenter #chat-emoji-button":"onEmojiEnter","mouseleave #chat-emoji-button":"onHideTooltip","mouseenter #chat-mentions-button":"onMentionsEnter","mouseleave #chat-mentions-button":"onHideTooltip"},initialize:function(){this.suggestionView=new b,this.suggestionView.on("refocus",t.bind(this.onRefocusInput,this)).on("submitSuggestion",t.bind(this.submitSuggestion,this)),this.chatOverBind=t.bind(this.onChatOver,this),this.chatOutBind=t.bind(this.onChatOut,this),this.chatDeleteClickBind=t.bind(this.onDeleteClick,this),this.fromClickBind=t.bind(this.onFromClick,this),this.showChatUserBind=t.bind(this.onShowChatUser,this),this.$disco=e("<div/>").addClass("disconnect").append(e("<span/>").text(S.chat.reconnecting))},render:function(){return this.$el.html(E(S)).append(this.suggestionView.$el),this.suggestionView.render(),this.$chatInput=this.$("#chat-input-field").on("keydown",t.bind(this.onKeyDown,this)).on("keyup",t.bind(this.onKeyUp,this)).on("focus",t.bind(this.onFocus,this)).on("blur",t.bind(this.onBlur,this)),this.chatInput=this.$chatInput[0],this.$chatMessages=this.$("#chat-messages"),this.$chatSound=this.$("#chat-sound-button"),this.$chatEmoji=this.$("#chat-emoji-button"),this.$chatMentions=this.$("#chat-mentions-button"),this.$chatTimestamp=this.$("#chat-timestamp-button"),this.$chatHeader=this.$("#chat-header"),this.$chatPopout=this.$("#chat-popout-button"),i.on("chat:receive",this.onReceived,this).on("chat:mention",this.onInputMention,this).on(s.DELETE,this.onDelete,this).on(s.CLEAR,this.onClear,this).on(s.SOUND,this.onSoundUpdate,this).on(s.EMOJI,this.onEmojiUpdate,this).on(s.MENTIONS,this.onMentionsUpdate,this).on(s.TIMESTAMP,this.onTimestampUpdate,this).on("sio:reconnecting",this.onReconnecting,this).on("sio:reconnected",this.onReconnected,this).on("show:chat",this.show,this).on("show:users show:waitlist",this.hide,this),r.embedSWF(g.sfx,"chat-sound","1","1","10",null,null,{quality:"high",wmode:"opaque",allowScriptAccess:"always",allowFullScreen:"false",bgcolor:"#000000"},{id:"chat-sound"}),i.trigger("chat:log","Welcome to the plug.dj beta. Version "+window.VERSION),v.resize(t.bind(this.onResize,this)),this.onEmojiUpdate(p.settings.emoji),u.onSoundUpdate().onTimestampUpdate().onEmojiUpdate().onMentionsUpdate(),this},onResize:function(t){t=t||v.getSize(),this.$el.height(t.height-t.barHeight*2).css("left",t.availWidth),this.$chatMessages.height(t.height-t.barHeight*2-this.$chatHeader.height()-e("#chat-input").height()-parseInt(e("#chat-input").css("bottom"))-12).scrollTop(this.$chatMessages[0].scrollHeight)},onTimestampClick:function(){u.toggleTimestamp()},onSoundClick:function(){u.toggleChatSound()},onEmojiClick:function(){u.toggleEmoji()},onMentionsClick:function(){u.toggleMentions()},onPopoutClick:function(){i.trigger("popout:show"),m.event("Chat","Popout Click")},onSoundEnter:function(){i.trigger("tooltip:show",S.tooltips.chatSound,this.$chatSound,!0)},onTimestampEnter:function(){i.trigger("tooltip:show",S.tooltips.chatTimestamp,this.$chatTimestamp,!0)},onPopoutEnter:function(){i.trigger("tooltip:show",S.tooltips.chatPopout,this.$chatPopout,!0)},onEmojiEnter:function(){i.trigger("tooltip:show",S.tooltips.chatEmoji,this.$chatEmoji,!0)},onMentionsEnter:function(){i.trigger("tooltip:show",S.tooltips.chatMentions,this.$chatMentions,!0)},onHideTooltip:function(){i.trigger("tooltip:hide")},onMentionsUpdate:function(e){this.isMentionFilterOn=e.data,e.data?(this.$("#chat-mentions-button i").removeClass("icon-mention-off").addClass("icon-mention"),this.$("#chat-messages").children().not(".mention").hide(),this.$chatMessages.scrollTop(this.$chatMessages[0].scrollHeight)):(this.$("#chat-mentions-button i").removeClass("icon-mention").addClass("icon-mention-off"),this.$("#chat-messages").children().not(".mention").show(),this.$chatMessages.scrollTop(this.$chatMessages[0].scrollHeight))},onEmojiUpdate:function(){p.settings.emoji?this.$("#chat-emoji-button i").removeClass("icon-emoji-off").addClass("icon-emoji-on"):this.$("#chat-emoji-button i").removeClass("icon-emoji-on").addClass("icon-emoji-off")},onTimestampUpdate:function(t){e("#chat .timestamp").each(function(){var n=e(this);n.text(y.convertChatTimestamp(n.text(),t.data))}),t.data?e("#chat .timestamp").show():e("#chat .timestamp").hide(),t.data==12?this.$("#chat-timestamp-button i").removeClass("icon-timestamps-off").removeClass("icon-timestamps-24").addClass("icon-timestamps-12"):t.data==24?this.$("#chat-timestamp-button i").removeClass("icon-timestamps-off").removeClass("icon-timestamps-12").addClass("icon-timestamps-24"):this.$("#chat-timestamp-button i").removeClass("icon-timestamps-12").removeClass("icon-timestamps-24").addClass("icon-timestamps-off")},onSoundUpdate:function(){p.settings.chatSound?this.$("#chat-sound-button i").removeClass("icon-chat-sound-off").addClass("icon-chat-sound-on"):this.$("#chat-sound-button i").removeClass("icon-chat-sound-on").addClass("icon-chat-sound-off")},onRefocusInput:function(){this.chatInput.focus()},onClear:function(){this.$chatMessages.html("").scrollTop(0)},onFocus:function(e){this.chatInput.placeholder=""},onBlur:function(e){this.chatInput.placeholder=S.chat.placeholder},onInputMention:function(n){var r=this.chatInput.value;r||(r=""),this.chatInput.value=r+"@"+n+" ";var i=this.chatInput;t.delay(function(){e(i).focus(),i.selectionStart=i.selectionEnd=i.value.length},100)},onKeyDown:function(e){var t;if(!e)return!0;t=e.which||e.keyCode;if((t==13||t==9)&&this.suggestionView.suggestions.length>0)return e.preventDefault(),e.stopImmediatePropagation(),this.submitSuggestion(),!1;if(t==13&&this.chatInput.value!=""){var n=u.sendChat(this.chatInput.value);return n&&(this.chatInput.value="",e.preventDefault()),this.$chatMessages.scrollTop(this.$chatMessages[0].scrollHeight),!1}return!0},onKeyUp:function(e){var t;if(!e)return!0;t=e.which||e.keyCode,this.suggestionView.suggestions=[];var n=this.getCaratPosition();if(n>0){var r=this.chatInput.value.substr(0,n);this.suggestionView.check(r,n)}return t==9&&this.suggestionView.suggestions.length>0?(e.preventDefault(),e.stopImmediatePropagation(),!1):(t==40||t==38?this.suggestionView.upDown(t):this.suggestionView.updateSuggestions(),!0)},onReceived:function(t){var n=e("<div/>").addClass(t.type);if(t.type=="mention"){var r="is-";l.hasPermission(c.ADMIN)?r+="admin":l.hasPermission(c.VOLUNTEER)?r+="ambassador":l.hasPermission(c.BOUNCER)?r+="staff":l.hasPermission(c.DJ)?r+="dj":r+="you",n.addClass(r),t.text=t.text.split("@"+l.get("username")).join('<span class="name">@'+l.get("username")+"</span>")}else t.type=="system"?n.append('<i class="icon icon-chat-system"></i>'):this.isMentionFilterOn&&n.hide();if(t.from){var i=e("<span/>").addClass(t.from.class).text(t.from.value+" ");t.from.clickable&&i.addClass("clickable").data("fromID",t.from.id).click(this.fromClickBind),t.from.admin?n.append('<i class="icon icon-chat-admin"></i>'):t.from.ambassador?n.append('<i class="icon icon-chat-ambassador"></i>'):t.from.owner?n.append('<i class="icon icon-chat-host"></i>'):t.from.staff&&(t.from.staff==c.COHOST?n.append('<i class="icon icon-chat-host"></i>'):t.from.staff==c.MANAGER?n.append('<i class="icon icon-chat-manager"></i>'):t.from.staff==c.BOUNCER?n.append('<i class="icon icon-chat-bouncer"></i>'):t.from.staff==c.DJ&&n.append('<i class="icon icon-chat-dj"></i>'));if(t.from.id){t.chatID&&(n.addClass("cid-"+t.chatID),t.deletable&&n.addClass("deletable").on("mouseenter",this.chatOverBind).on("mouseleave",this.chatOutBind).append(e("<div/>").addClass("delete-button").data("chatID",t.chatID).on("click",this.chatDeleteClickBind).append(e("<span/>").text(S.chat.delete))));var s=e("<div/>").addClass("timestamp").text(t.timestamp);n.append(s),t.showTimestamp&&s.show()}n.append(i)}n.append(e("<span/>").addClass("text").html(t.text)),t.lang&&n.append(e("<span/>").addClass("language").html(t.lang.html).attr("title",t.lang.title));var o=this.$chatMessages.scrollTop()>this.$chatMessages[0].scrollHeight-this.$chatMessages.height()-20;this.$chatMessages.append(n),this.$chatMessages.children().size()>512&&this.$chatMessages.children().first().remove(),o&&this.$chatMessages.scrollTop(this.$chatMessages[0].scrollHeight),t.sound&&(this.$el.is(":visible")&&!this._popout?this.$chatInput.is(":focus")||this.playSound(t.sound):this._popout&&(this.$chatInput.is(":focus")||this.playSound(t.sound)))},playSound:function(e){if(e=="chat")try{document.getElementById("chat-sound").playChatSound()}catch(t){}else try{document.getElementById("chat-sound").playMentionSound()}catch(t){}},onDelete:function(t){e(".cid-"+t.data.chatID).each(function(){var n=e(this).removeClass("deletable cid-"+t.data.chatID+" emote message admin ambassador host moderator mention").attr("title","").html("").off("mouseenter",this.chatOverBind).off("mouseleave",this.chatOutBind).remove()})},onFromClick:function(t){var n=e(t.currentTarget).data("fromID");if(n){var r=a.getUserByID(n);r?this.onShowChatUser(r,{x:this.getPosX(),y:e(t.currentTarget).offset().top}):this.getExternalUser(n,{x:this.getPosX(),y:e(t.currentTarget).offset().top},this.showChatUserBind),m.event("Chat","Username Click")}},getPosX:function(){return e("#chat").offset().left},onShowChatUser:function(e,t){i.dispatch(new o(o.SHOW,e,t))},getExternalUser:function(e,t,n){var r=new h([e],t);r.successCallback=n},onChatOver:function(t){e(t.currentTarget).find(".delete-button").show()},onChatOut:function(t){e(t.currentTarget).find(".delete-button").hide()},onDeleteClick:function(t){u.deleteChat(e(t.currentTarget).off("click",this.chatDeleteClickBind).data("chatID")),e(t.currentTarget).remove(),m.event("Chat","Delete")},submitSuggestion:function(){var e=this.getMentionRange(),t=this.chatInput.value.substr(0,e[0]),n=this.chatInput.value.substr(e[1]),r=this.suggestionView.getSelected();this.chatInput.value=t+r+" "+n,this.chatInput.setSelectionRange(e[0]+r.length+1,e[0]+r.length+1),this.suggestionView.reset(),this.suggestionView.updateSuggestions()},show:function(){this.$el.show(),this.onResize()},hide:function(){this.$el.hide()},getMentionRange:function(){var e=this.getCaratPosition();if(e>0){var t=this.chatInput.value.substr(0,e),n=t.lastIndexOf(" @");return n==-1?n=t.indexOf("@"):++n,[n+1,e]}return},getCaratPosition:function(){if(this.chatInput.createTextRange){var e=document.selection.createRange().duplicate();return e.moveEnd("character",this.chatInput.value.length),e.text==""?this.chatInput.value.length:this.chatInput.value.lastIndexOf(e.text)}return this.chatInput.selectionStart},onReconnecting:function(){this.hideSpinner(),this.$el.append(this.$disco),this.spinner=new w({size:w.MEDIUM}),this.$disco.append(this.spinner.$el),this.spinner.render().$el.css("left","50%").css("top","45%").css("z-index",301)},onReconnected:function(){this.hideSpinner(),this.$disco.remove()},hideSpinner:function(){this.spinner&&(this.spinner.remove(),this.spinner=undefined)}});return x}),define("ac785/abf10/e9abd/d57c6/b2c9f",["ac785/abf10/e9abd/eccfb/bf47e"],function(e){var t=e.extend({});return t}),define("hbs!template/room/popout/PopoutChat",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="header">\r\n    <i class="icon icon-chat"></i>\r\n    <span>'+a((o=(o=t.header,o==null||o===!1?o:o.chat),typeof o===u?o.apply(t):o))+'</span>\r\n    <div id="chat-timestamp-button" class="chat-header-button">\r\n        <i class="icon icon-timestamps-12"></i>\r\n    </div>\r\n    <div id="chat-sound-button" class="chat-header-button">\r\n        <i class="icon icon-chat-sound-on"></i>\r\n    </div>\r\n    <div id="chat-emoji-button" class="chat-header-button">\r\n        <i class="icon icon-emoji-on"></i>\r\n    </div>\r\n    <div id="chat-mentions-button" class="chat-header-button">\r\n        <i class="icon icon-mention-off"></i>\r\n    </div>\r\n</div>\r\n<div id="chat-messages"></div>\r\n<div id="chat-input">\r\n    <form class="chat-input-form" onsubmit="return false">\r\n        <input id="chat-input-field" type="text" value="" placeholder="'+a((o=(o=t.chat,o==null||o===!1?o:o.placeholder),typeof o===u?o.apply(t):o))+'" maxlength="256"/>\r\n    </form>\r\n</div>',s});return t.registerPartial("template_room_popout_PopoutChat",n),n}),define("ac785/abf10/e9abd/d57c6/f20f1",["jquery","underscore","ac785/bc190/cd0b8","ac785/d94e0/bad16","ac785/d94e0/a2e23","ac785/f04be/c8b95","ac785/f6dac/d17c3","ac785/abf10/e9abd/eccfb/b59f0","ac785/abf10/e9abd/d57c6/b2c9f","hbs!template/room/popout/PopoutChat","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l){var c=u.extend({initialize:function(){this.suggestionView=new a,this.suggestionView.on("refocus",t.bind(this.onRefocusInput,this)).on("submitSuggestion",t.bind(this.submitSuggestion,this)),this.chatOverBind=t.bind(this.onChatOver,this),this.chatOutBind=t.bind(this.onChatOut,this),this.chatDeleteClickBind=t.bind(this.onDeleteClick,this),this.fromClickBind=t.bind(this.onFromClick,this),this.showChatUserBind=t.bind(this.onShowChatUser,this)},render:function(){this.$el.html(f(l)).append(this.suggestionView.$el),this.suggestionView.render(),this.$chatInput=this.$("#chat-input-field").keydown(t.bind(this.onKeyDown,this)).keyup(t.bind(this.onKeyUp,this)).focus(t.bind(this.onFocus,this)).blur(t.bind(this.onBlur,this)),this.chatInput=this.$chatInput[0],this.$chatMessages=this.$("#chat-messages"),this.$chatMessages.append(e("#chat-messages").children().clone(!0,!0)),this.$chatSound=this.$("#chat-sound-button"),this.$chatEmoji=this.$("#chat-emoji-button"),this.$chatMentions=this.$("#chat-mentions-button"),this.$chatHeader=this.$("#chat-header"),n.on("chat:receive",this.onReceived,this).on("chat:mention",this.onInputMention,this).on(r.DELETE,this.onDelete,this).on(r.CLEAR,this.onClear,this).on(r.SOUND,this.onSoundUpdate,this).on(r.EMOJI,this.onEmojiUpdate,this).on(r.MENTIONS,this.onMentionsUpdate,this).on(r.TIMESTAMP,this.onTimestampUpdate,this),s.onSoundUpdate().onTimestampUpdate().onEmojiUpdate().onMentionsUpdate();var i=this;return t.delay(function(){i.$chatMessages.scrollTop(i.$chatMessages[0].scrollHeight)},250),this},remove:function(){this._super(),n.off("chat:receive",this.onReceived,this).off("chat:mention",this.onInputMention,this).off(r.DELETE,this.onDelete,this).off(r.CLEAR,this.onClear,this).off(r.SOUND,this.onSoundUpdate,this).off(r.EMOJI,this.onEmojiUpdate,this).off(r.MENTIONS,this.onMentionsUpdate,this).off(r.TIMESTAMP,this.onTimestampUpdate,this),this.$el&&this.$el.empty()},scrollToBottom:function(){this.$chatMessages.scrollTop(this.$chatMessages[0].scrollHeight)},onTimestampUpdate:function(t){this.$("#chat-messages .timestamp").each(function(){var n=e(this);n.text(o.convertChatTimestamp(n.text(),t.data))}),t.data?this.$("#chat-messages .timestamp").show():this.$("#chat-messages .timestamp").hide(),t.data==12?this.$("#chat-timestamp-button i").removeClass("icon-timestamps-off").removeClass("icon-timestamps-24").addClass("icon-timestamps-12"):t.data==24?this.$("#chat-timestamp-button i").removeClass("icon-timestamps-off").removeClass("icon-timestamps-12").addClass("icon-timestamps-24"):this.$("#chat-timestamp-button i").removeClass("icon-timestamps-12").removeClass("icon-timestamps-24").addClass("icon-timestamps-off")},playSound:function(e){},onSoundEnter:function(){},onTimestampEnter:function(){},onPopoutEnter:function(){},onEmojiEnter:function(){},onMentionsEnter:function(){}});return c}),define("hbs!template/room/playback/Volume",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="button">\n    <i class="icon icon-volume-on"></i>\n</div>\n<span>100%</span>\n<div class="slider">\n    <div class="line"></div>\n    <div class="circle"></div>\n    <div class="hit"></div>\n</div>'});return t.registerPartial("template_room_playback_Volume",n),n}),define("ac785/abf10/e9abd/ec35c/c28fa",["underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/ec425","ac785/ab6db/ffb2a","hbs!template/room/playback/Volume"],function(e,t,n,r,i,s){var o=t.View.extend({id:"volume",$document:$(document),events:{mouseenter:"onEnter",mouseleave:"onLeave"},initialize:function(){this.moveBind=e.bind(this.onUpdate,this),this.stopBind=e.bind(this.onStop,this),this.clickBind=e.bind(this.onClick,this)},render:function(){return this.$el.html(s()),this.$icon=this.$(".button i"),this.$hit=this.$(".hit").mousedown(e.bind(this.onStart,this)),this.$slider=this.$(".slider"),this.$circle=this.$(".circle"),this.$span=this.$("span"),this.max=this.$hit.width()-this.$circle.width(),this.$circle.css("left",parseInt(this.$hit.css("left"))+this.max*(r.get("volume")/100)-this.$circle.width()/2),this.$(".button").on("click",this.clickBind),r.on("change:volume change:muted",this.onChange,this),this.onChange(),this},remove:function(){this._super(),this.$(".button").off("click",this.clickBind),r.off("change:volume change:muted",this.onChange,this),this.$el.empty(),this.$el.off(),this.off(),this.$el=undefined,this.el=undefined,this.$icon=this.$hit=this.$slider=this.$circle=undefined},onEnter:function(){this.drag||(this.$slider.show(),this.max=this.$hit.width()-this.$circle.width(),this.onChange()),this.over=!0},onLeave:function(){this.drag||this.$slider.hide(),this.over=!1},onClick:function(){r.get("muted")?r.set("volume",r.get("lastVolume")):r.set({lastVolume:r.get("volume"),volume:0})},onStart:function(e){return this.drag=!0,this.min=this.$hit.offset().left,this.max=this.$hit.width()-this.$circle.width(),n.trigger("playback:block"),this.$document.on("mouseup",this.stopBind).on("mousemove",this.moveBind),this.onUpdate(e)},onUpdate:function(e){var t=Math.max(0,Math.min(100,~~(100*((e.pageX-this.min)/this.max))));return r.set("volume",t),i.settings.volume=t,e.preventDefault(),e.stopPropagation(),!1},onStop:function(e){return this.drag=!1,n.trigger("playback:unblock"),this.$document.off("mouseup",this.stopBind).off("mousemove",this.moveBind),i.saveSettings(),e.preventDefault(),e.stopPropagation(),this.over||this.onLeave(),!1},onChange:function(){var e=r.get("volume");this.$span.text(e+"%"),this.$circle.css("left",parseInt(this.$hit.css("left"))+this.max*(e/100)-this.$circle.width()/2),e>60?this.$icon.hasClass("icon-volume-on")||this.$icon.removeClass().addClass("icon icon-volume-on"):e>0?this.$icon.hasClass("icon-volume-half")||this.$icon.removeClass().addClass("icon icon-volume-half"):this.$icon.hasClass("icon-volume-off")||this.$icon.removeClass().addClass("icon icon-volume-off")}});return o}),define("hbs!template/room/popout/PopoutMeta",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-current-dj"></i>\r\n<div id="now-playing-media">\r\n    <span class="bar-value"></span>\r\n</div>\r\n<div id="now-playing-dj">\r\n    <span class="dark-label">'+a((o=(o=t.header,o==null||o===!1?o:o.currentDJ),typeof o===u?o.apply(t):o))+': </span><span class="username"></span>\r\n</div>\r\n<div id="now-playing-time">\r\n    <i class="icon icon-time"></i>\r\n    <span></span>\r\n</div>',s});return t.registerPartial("template_room_popout_PopoutMeta",n),n}),define("ac785/abf10/e9abd/d57c6/d2231",["jquery","underscore","backbone","ac785/ca252/f89d8","ac785/ca252/ec425","ac785/f6dac/d17c3","ac785/abf10/e9abd/ec35c/c28fa","hbs!template/room/popout/PopoutMeta","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({id:"meta",render:function(){return this.$el.html(u(a)),this.$media=this.$("#now-playing-media .bar-value"),this.$dj=this.$("#now-playing-dj .username"),this.$time=this.$("#now-playing-time span"),this.volume=new o,this.$el.append(this.volume.$el),this.volume.render(),i.on("change:media",this.onMediaChange,this).on("change:remaining",this.onTimeChange,this),r.on("reset change:username",this.onDJChange,this),t.defer(t.bind(this.onDraw,this)),this},onDraw:function(){this.onMediaChange(),this.onDJChange(),this.onTimeChange(),this.volume.onChange(),this.resize()},remove:function(){this._super(),i.off("change:media",this.onMediaChange,this).off("change:remaining",this.onTimeChange,this),r.off("reset change:username",this.onDJChange,this),this.volume.remove(),this.volume=undefined,this.$el&&this.$el.empty()},onMediaChange:function(){var e=i.get("media");e?this.$media.html('<span class="author">'+e.get("author")+"</span> - "+e.get("title")):this.$media.html("<span>"+a.playback.noDJTitle+"</span>"),this.resize()},onDJChange:function(){this.$dj.text(r.length>0?r.at(0).get("username"):a.playback.noDJ)},onTimeChange:function(){var e=i.get("remaining");e<0||!i.get("media")?this.$time.text("").css("color","#eee"):this.$time.text(s.formatTimeLeading(e)).css("color",e>5?"#eee":"#C00"),this.resize()},resize:function(t){t=t||Math.max(345,e(this._window).width()),t=t-this.$("#now-playing-media").offset().left-this.$("#now-playing-time").width()-15;if(isNaN(t)||t<0)t=240;this.$("#now-playing-media").width(t)}});return f}),define("ac785/e734f/e9abd/eff78",["ac785/e734f/b669d","ac785/c3562/f9d8b"],function(e,t){var n=e.extend({init:function(e,t){this.positive=e,this.historyID=t,this._super()},execute:function(){t.execute("room.cast",this,this.positive,this.historyID,!0)},parse:function(e){e.status!=0&&this.onStatusError&&this.onStatusError(e.status)}});return n}),define("hbs!template/room/Vote",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div id="woot" class="crowd-response">\n    <div class="top">\n        <i class="icon icon-woot"></i>\n        <span class="label">'+a((o=(o=t.vote,o==null||o===!1?o:o.woot),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="bottom">\n        <span class="value"></span>\n    </div>\n</div>\n<div id="curate" class="crowd-response">\n    <div class="top">\n        <i class="icon icon-curate"></i>\n        <span class="label">'+a((o=(o=t.vote,o==null||o===!1?o:o.curate),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="bottom">\n        <span class="value"></span>\n    </div>\n</div>\n<div id="meh" class="crowd-response">\n    <div class="top">\n        <i class="icon icon-meh"></i>\n        <span class="label">'+a((o=(o=t.vote,o==null||o===!1?o:o.meh),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="bottom">\n        <span class="value"></span>\n    </div>\n</div>',s});return t.registerPartial("template_room_Vote",n),n}),define("ac785/abf10/e9abd/a6d98",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/ec425","ac785/ca252/c0f8f","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/e9abd/eff78","ac785/ab6db/e1b12","ac785/f6dac/bf313","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/ddb98/f882d","hbs!template/room/Vote","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b=t.View.extend({id:"vote",template:g(y),initialize:function(){this.checkBind=e.bind(this.onCheck,this)},render:function(){return this.$el.html(this.template),this.$woot=this.$("#woot").click(e.bind(this.onWootClick,this)).on("mouseenter",e.bind(this.onWootEnter,this)),this.$meh=this.$("#meh").click(e.bind(this.onMehClick,this)).on("mouseenter",e.bind(this.onMehEnter,this)),this.$curate=this.$("#curate").click(e.bind(this.onCurateClick,this)).data("curate",!0).on("mouseenter",e.bind(this.onCurateEnter,this)),this.$(".crowd-response").on("mouseleave",e.bind(this.onHideTooltip,this)),this.$wootValue=this.$("#woot .value"),this.$mehValue=this.$("#meh .value"),this.$curateValue=this.$("#curate .value"),this.$wootIcon=this.$("#woot i"),this.$mehIcon=this.$("#meh i"),this.$curateIcon=this.$("#curate i"),o.on("update",this.onDJUpdate,this),u.on("change:remaining",this.onTimeChange,this),i.on("change:positive",this.onPositiveChange,this).on("change:negative",this.onNegativeChange,this).on("change:curates",this.onCuratesChange,this),n.on("userPlaying:update",this.onCheck,this),this.onPositiveChange(),this.onNegativeChange(),this.onCuratesChange(),this.enabled=!0,this},onPositiveChange:function(){var e=i.get("positive")||0;this.$wootValue.text(e),e>0?this.$woot.hasClass("active")||this.$woot.addClass("active"):this.$woot.hasClass("active")&&this.$woot.removeClass("active")},onNegativeChange:function(){var e=i.get("negative")||0;this.$mehValue.text(e),e>0?this.$meh.hasClass("active")||this.$meh.addClass("active"):this.$meh.hasClass("active")&&this.$meh.removeClass("active")},onCuratesChange:function(){var e=i.get("curates")||0;this.$curateValue.text(e),e>0?this.$curate.hasClass("active")||this.$curate.addClass("active"):this.$curate.hasClass("active")&&this.$curate.removeClass("active"),f.get("curates")[l.get("id")]&&!this.$curate.hasClass("selected")&&(this.setCurate("selected"),this.onWootClick())},onWootClick:function(){u.get("media")&&!s.isTheUserPlaying&&l.get("vote")!=1&&(u.get("duration")==0||u.get("remaining")>5)&&(new h(!0,u.get("historyID")),i.voteUpdate({id:l.get("id"),vote:1}),this.setWoot("selected"),this.setMeh(),d.event("Vote","Positive"))},onMehClick:function(e){if(u.get("media")&&!s.isTheUserPlaying&&l.get("vote")!=-1&&u.get("remaining")>5)if(l.hasPermission(c.DJ)||Date.now()-f.get("joinTime")>12e4)new h(!1,u.get("historyID")),i.voteUpdate({id:l.get("id"),vote:-1}),this.setMeh("selected"),this.setWoot(),d.event("Vote","Negative");else{var t=String((Date.now()-f.get("joinTime"))/1e3);n.trigger("notify","icon-meh-disabled",y.messages.mehTimer.split("%COUNT%").join(t))}},onCurateClick:function(e){if(u.get("media")&&!s.isTheUserPlaying&&!this.$curate.hasClass("disabled")&&u.get("remaining")>5){var t=a.find(function(e){return e.get("selected")}),i=[u.get("media")];t?(this.showPopMenu(i),this.onHideTooltip()):n.dispatch(new r(r.SHOW,new v({media:i})))}},showPopMenu:function(e){m.show(this.$curate,e)},onMehEnter:function(){this.$meh.hasClass("disabled")||n.trigger("tooltip:show",y.tooltips.voteMeh,this.$meh)},onWootEnter:function(){this.$woot.hasClass("disabled")||n.trigger("tooltip:show",y.tooltips.voteWoot,this.$woot)},onCurateEnter:function(){this.$curate.hasClass("disabled")||n.trigger("tooltip:show",y.tooltips.voteCurate,this.$curate)},onHideTooltip:function(){n.trigger("tooltip:hide")},onTimeChange:function(){!s.isTheUserPlaying&&u.get("media")&&(u.get("duration")==0||u.get("remaining")>5?this.enable():this.enabled&&(l.get("vote")!=1&&this.setWoot("disabled"),l.get("vote")!=-1&&this.setMeh("disabled"),f.get("curates")[l.get("id")]||this.setCurate("disabled"),this.enabled=!1))},enable:function(){l.get("vote")==1?(u.get("duration")>0?this.setMeh():this.setMeh("disabled"),this.setWoot("selected")):l.get("vote")==-1?(this.setMeh("selected"),this.setWoot()):(u.get("duration")>0?l.hasPermission(c.DJ)||Date.now()-f.get("joinTime")>12e4?this.setMeh():this.setMeh("disabled"):this.setMeh("disabled"),this.setWoot()),f.get("curates")[l.get("id")]?this.setCurate("selected"):this.setCurate()},onCheck:function(){s.isTheUserPlaying||!u.get("media")||s.length==0?(this.setMeh("disabled"),this.setWoot("disabled"),this.setCurate("disabled"),this.enabled=!1):this.enable()},onDJUpdate:function(){e.delay(this.checkBind,500)},setWoot:function(e){e?e=="selected"?(this.$woot.removeClass("disabled").addClass("selected"),this.$wootIcon.removeClass().addClass("icon icon-woot-disabled")):e=="disabled"&&(this.$woot.removeClass("selected").addClass("disabled"),this.$wootIcon.removeClass().addClass("icon icon-woot-disabled")):(this.$woot.removeClass("disabled selected"),this.$wootIcon.removeClass().addClass("icon icon-woot"))},setMeh:function(e){e?e=="selected"?(this.$meh.removeClass("disabled").addClass("selected"),this.$mehIcon.removeClass().addClass("icon icon-meh-disabled")):e=="disabled"&&(this.$meh.removeClass("selected").addClass("disabled"),this.$mehIcon.removeClass().addClass("icon icon-meh-disabled")):(this.$meh.removeClass("disabled selected"),this.$mehIcon.removeClass().addClass("icon icon-meh"))},setCurate:function(e){e?e=="selected"?(this.$curate.removeClass("disabled").addClass("selected"),this.$curateIcon.removeClass().addClass("icon icon-curate-disabled")):e=="disabled"&&(this.$curate.removeClass("selected").addClass("disabled"),this.$curateIcon.removeClass().addClass("icon icon-curate-disabled")):(this.$curate.removeClass("disabled selected"),this.$curateIcon.removeClass().addClass("icon icon-curate"))}});return b}),define("ac785/abf10/e9abd/d57c6/edd4a",["ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/c0f8f","ac785/ca252/ec425","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/a6d98","ac785/abf10/e9abd/ddb98/f882d","hbs!template/room/Vote","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=a.extend({template:l(c),render:function(){this._super(),this.onCheck()},remove:function(){this._super(),i.off("update",this.onDJUpdate,this),o.off("change:remaining",this.onTimeChange,this),n.off("change:positive",this.onPositiveChange,this).off("change:negative",this.onNegativeChange,this).off("change:curates",this.onCuratesChange,this),e.off("userPlaying:update",this.onCheck,this),f.hide(),this.$el.empty()},setWidth:function(e){this.$el.width(e);var t=e/3;this.$("#curate").width(t),this.$("#woot").width(--t),this.$("#meh").width(t)},showPopMenu:function(e){f.show(this.$curate,e,this.$body)},onMehEnter:function(){},onWootEnter:function(){},onCurateEnter:function(){},onHideTooltip:function(){}});return h}),define("ac785/abf10/e9abd/d57c6/fe544",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/f6dac/abcc8","ac785/f6dac/c41ff","ac785/abf10/e9abd/ea1d8/a04e5","ac785/abf10/e9abd/d57c6/f20f1","ac785/abf10/e9abd/d57c6/d2231","ac785/abf10/e9abd/d57c6/edd4a"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({initialize:function(){this._window=undefined,this.$document=undefined,this.resizeBind=t.bind(this.onResize,this);var e=this;window.onbeforeunload=function(t){e.close()},r.on("popout:show",t.bind(this.show,this))},show:function(){this.chat||(this.chat=new f,this.meta=new l,this.vote=new c,this.chat._popout=this,this.$modal=e("<div/>").addClass("user-panel-modal").mousedown(t.bind(a.cleanup,a)).hide());if(!this._window){var n=this,r=window.screenY+e("#chat").offset().top+4,i=window.screenX+e("#chat").offset().left-5,s=e("#chat").height()+54;this._window=window.open("about:blank","plugdjpopout","width=350,height="+s+",location=no,menubar=no,titlebar=no,status=no,toolbar=no,resizable=yes,left="+i+",top="+r),this._window.onbeforeunload=function(e){n.clear()},o.isFirefox?this._window.onload=t.bind(this.render,this):t.defer(t.bind(this.render,this))}},render:function(){this._window.focus(),e(this._window.document.head).append(e('<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">')).append(e('<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Roboto:300,400,700">')).append(e('<link rel="stylesheet" type="text/css"/>').attr("href",window.location.origin+u.csspopout)).append(e('<link rel="stylesheet" type="text/css"/>').attr("href",window.location.origin+u["css_"+s.get("language")]||u.css_en)),this.$document=e(this._window.document),this.$document.attr("title","plug.dj - "+i.get("name")),this.meta._document=this.chat.suggestionView.$document=this.$document,this.meta._window=this._window,this.vote.$body=e(this._window.document.body),e(this._window.document.body).append(this.chat.$el).append(this.meta.$el).append(this.vote.$el).append(this.$modal),e(this._window.document.body).addClass("popout"),o.isMac?e(this._window.document.body).addClass("osx"):e(this._window.document.body).addClass("win");var n;o.isChrome?n="chrome":o.isFirefox?n="firefox":o.isSafari?n="safari":o.isIE&&(n="ie"),e(this._window.document.body).addClass(n),this.chat.render(),this.meta.render(),this.vote.render(),this.meta.volume.$document=this.$document,e(this._window).on("resize",this.resizeBind),t.delay(this.resizeBind,100),e("#chat-button").hide(),e("#users-button").click()},onResize:function(){var e;try{e=this._window.innerHeight}catch(t){this.clear()}if(e){var n=Math.max(345,this._window.innerWidth);e=Math.max(450,e);var r=this.meta.$el.height()+this.vote.$el.height();this.chat.$el.width(n).height(e-r),this.chat.$chatMessages.height(this.chat.$el.height()-this.chat.$chatMessages.offset().top-this.chat.$chatInput.height()-34),this.chat.scrollToBottom(),this.vote.setWidth(n),this.meta.$el.width(n),this.meta.resize(n),this.meta.$el.css("top",e-r),this.vote.$el.css("top",e-this.vote.$el.height())}},clear:function(){this.chat.remove(),this.meta.remove(),this.vote.remove(),this._window&&(e(this._window).off("resize",this.resizeBind),this._window.onload=undefined,this._window.onbeforeunload=undefined),this.$document=this.meta._document=this.vote._document=undefined,this.chat=undefined,this.meta=undefined,this.vote=undefined,this.$modal.off(),this.$modal.remove(),this.$modal=undefined,t.defer(t.bind(this.cleanup,this)),e("#chat-button").show().click()},showModal:function(){this.$modal.width(Math.max(345,this._window.innerWidth)).height(Math.max(450,this._window.innerHeight)).show()},hideModal:function(){this.$modal.hide()},cleanup:function(){this._window=undefined},close:function(){this._window&&(this._window.close(),this.clear())}});return new h}),define("ac785/b1ca1/d7621",["ac785/bc190/d22bb","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/abf10/e9abd/d57c6/fe544","ac785/abf10/e9abd/ea1d8/a04e5"],function(e,t,n,r,i){var s=e.extend({execute:function(){!this.event.room&&r.$document&&(this.event.pos.x=32),this.event.user&&!t.get("users")[this.event.user.id]&&n.getOrCreateUserModel(this.event.user,!0),this.event.pos.staff?i.showStaff(this.event.user,this.event.pos,undefined):i.showChat(this.event.user,this.event.pos,!this.event.room&&r.$document?r:undefined),this._super()}});return s}),define("ac785/e734f/ea1d8/face6",["ac785/e734f/b669d","ac785/c3562/f9d8b","ac785/f6dac/d17c3"],function(e,t,n){var r=e.extend({init:function(e){this.displayName=e,this._super(!0)},execute:function(){n.isValidUsername(this.displayName)?t.execute("user.change_name",this,this.displayName):this.parse({status:5})},parse:function(e){e.status==0?this.successCallback(this.displayName):e.status==5?this.trigger("notify","icon-chat-system",Lang.alerts.usernameUnavailable):e.status==9?this.trigger("notify","icon-chat-system",Lang.alerts.usernameInvalid):this.onStatusError(e.status)}});return r}),define("ac785/e734f/ea1d8/c0de5",["underscore","ac785/bc190/cd0b8","ac785/c3562/d4511","ac785/e734f/b669d"],function(e,t,n,r){var i=r.extend({init:function(e){this.language=e,this._super()},execute:function(){n.execute("user.set_language",this,this.language)},parse:function(e){e.status==0?this.successCallback(this.language):this.errorCallback(e.status)}});return i}),define("ac785/e734f/ea1d8/e358d",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.userStatus=e,this._super()},execute:function(){t.execute("user.set_status",this,this.userStatus)},parse:function(e){e.status==0?this.successCallback(this.userStatus):this.onStatusError(e.status)}});return n}),define("ac785/b1ca1/a714f",["underscore","ac785/bc190/fea39","ac785/d94e0/fb1a1","ac785/f04be/c8b95","ac785/ca252/fae6c","ac785/e734f/ea1d8/face6","ac785/e734f/ea1d8/c0de5","ac785/e734f/ea1d8/e358d","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f){var l=t.extend({execute:function(){this.count=0;if(this.event.username&&i.get("username")!=this.event.username){var t=new s(this.event.username);t.successCallback=e.bind(this.onUsernameResponse,this),t.errorCallback=e.bind(this.onUsernameError,this),++this.count}if(this.event.language&&i.get("language")!=this.event.language){var t=new o(this.event.language);t.successCallback=e.bind(this.onLanguageResponse,this),t.errorCallback=e.bind(this.onLanguageError,this),++this.count}if(i.get("status")!=this.event.status){var t=new u(this.event.status);t.successCallback=e.bind(this.onStatusResponse,this),t.errorCallback=e.bind(this.onStatusError,this),++this.count}this.count==0&&this.finish()},onUsernameResponse:function(e){e.username=e.split("<").join("").split(">").join("").split("&gt;").join("").split("&lt;").join("").split("&#60;").join("").split("&#62;").join(""),i.set("username",e),this.trigger("name:changed"),this.serviceComplete()},onLanguageResponse:function(t){i.set("language",t),(t=="en"&&r.uiLanguageMap[i.get("language")]||t!="en"&&r.uiLanguageMap[t])&&this.dispatch(new n(n.ALERT,f.alerts.update,f.alerts.languageChangedMessage,e.bind(a.forceRefresh,a),!0)),this.serviceComplete()},onStatusResponse:function(e){i.set("status",e),this.serviceComplete()},onUsernameError:function(e){e==5?this.dispatch(new n(n.ALERT,undefined,f.alerts.usernameError+e)):this.dispatch(new n(n.ALERT,undefined,f.alerts.displayNameNotAvailable)),this.serviceComplete()},onLanguageError:function(e){this.dispatch(new n(n.ALERT,undefined,f.alerts.language+e)),this.serviceComplete()},onStatusError:function(e){this.serviceComplete()},serviceComplete:function(){--this.count==0&&this.finish()}});return l}),define("ac785/a53b0/e583a",["ac785/bc190/b8b17","ac785/b1ca1/ef8bb","ac785/d94e0/fb1a1","ac785/b1ca1/a5a33","ac785/d94e0/a461e","ac785/b1ca1/fa883","ac785/d94e0/a781b","ac785/b1ca1/cdb20","ac785/d94e0/c672e","ac785/b1ca1/a8750","ac785/d94e0/fd72e","ac785/b1ca1/e09fd","ac785/b1ca1/b7975","ac785/d94e0/b5c70","ac785/b1ca1/d4828","ac785/d94e0/c4bc0","ac785/b1ca1/a4f5a","ac785/d94e0/d4a09","ac785/b1ca1/ea43b","ac785/d94e0/b1cfb","ac785/b1ca1/a9f55","ac785/d94e0/f5b19","ac785/b1ca1/d010a","ac785/d94e0/a133c","ac785/b1ca1/dc25c","ac785/d94e0/dfc42","ac785/b1ca1/f6f6b","ac785/d94e0/b0721","ac785/b1ca1/ece5b","ac785/b1ca1/ecb3c","ac785/d94e0/fc0ee","ac785/b1ca1/db9d0","ac785/d94e0/a0710","ac785/b1ca1/acabb","ac785/d94e0/e001a","ac785/b1ca1/e36af","ac785/d94e0/e3c1f","ac785/b1ca1/cba6e","ac785/b1ca1/a17a2","ac785/d94e0/e089a","ac785/b1ca1/f7f1e","ac785/d94e0/ae10c","ac785/b1ca1/a5c8f","ac785/d94e0/ca90f","ac785/b1ca1/ce3bb","ac785/d94e0/c7cab","ac785/b1ca1/eb193","ac785/d94e0/e8fc4","ac785/b1ca1/c1320","ac785/d94e0/ea5f9","ac785/b1ca1/c90e3","ac785/d94e0/d90fb","ac785/b1ca1/e8023","ac785/d94e0/dcf27","ac785/b1ca1/b9816","ac785/d94e0/ab74a","ac785/b1ca1/d9a57","ac785/d94e0/bcf57","ac785/b1ca1/cdf7e","ac785/d94e0/df73d","ac785/b1ca1/ad5d8","ac785/b1ca1/f6756","ac785/d94e0/a7d9d","ac785/b1ca1/d5a1d","ac785/d94e0/cb4b7","ac785/b1ca1/fa2b3","ac785/d94e0/a045f","ac785/b1ca1/c2595","ac785/d94e0/bc747","ac785/b1ca1/d7621","ac785/d94e0/a2e23","ac785/b1ca1/a714f","ac785/d94e0/ac2bb"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt){return e.mapEvent(n.ALERT,t,n),e.mapEvent(n.CONFIRM,t,n),e.mapEvent(i.CHANGE,r,i),e.mapEvent(o.CUSTOM,s,o),e.mapEvent(a.JOIN,u,a),e.mapEvent(a.LEAVE,u,a),e.mapEvent(a.SKIP,u,a),e.mapEvent(l.SYNC,f,l),e.mapEvent(p.IMPORT,c,p),e.mapEvent(p.PARSE,h,p),e.mapEvent(g.IMPORT,m,g),e.mapEvent(v.IMPORT,d,v),e.mapEvent(b.SETS,y,b),e.mapEvent(b.FAVORITES,y,b),e.mapEvent(b.TRACKS,y,b),e.mapEvent(E.ADD,w,E),e.mapEvent(E.DELETE,w,E),e.mapEvent(E.EDIT,w,E),e.mapEvent(E.MOVE_TO_TOP,w,E),e.mapEvent(E.PLAY_NEXT,w,E),e.mapEvent(E.RELATED,w,E),e.mapEvent(x.CURATE,S,x),e.mapEvent(N.DELETE,T,N),e.mapEvent(k.INSERT,C,k),e.mapEvent(_.RECOVER,M,_),e.mapEvent(O.MOVE,L,O),e.mapEvent(O.SHUFFLE,L,O),e.mapEvent(O.TOP,A,O),e.mapEvent(P.SYNC,D,P),e.mapEvent(B.UPDATE,H,B),e.mapEvent(I.ADD_DJ,j,I),e.mapEvent(I.CHAT_DELETE,j,I),e.mapEvent(I.SKIP,j,I),e.mapEvent(I.BAN,j,I),e.mapEvent(I.PERMISSION,j,I),e.mapEvent(I.REMOVE_DJ,j,I),e.mapEvent(I.UNBAN,F,I),e.mapEvent(R.ACTIVATE,q,R),e.mapEvent(R.RENAME,q,R),e.mapEvent(R.DELETE,q,R),e.mapEvent(z.ACTIVATE,U,z),e.mapEvent(X.CREATE,W,X),e.mapEvent($.DELETE,V,$),e.mapEvent(K.RENAME,J,K),e.mapEvent(G.SYNC,Q,G),e.mapEvent(Z.PLAY,Y,Z),e.mapEvent(tt.PREVIEW,et,tt),e.mapEvent(rt.BACK,nt,rt),e.mapEvent(st.SEARCH,it,st),e.mapEvent(at.BANS,ot,at),e.mapEvent(at.STAFF,ut,at),e.mapEvent(lt.CREATE,ft,lt),e.mapEvent(ht.JOIN,ct,ht),e.mapEvent(dt.UPDATE,pt,dt),e.mapEvent(mt.SHOW,vt,mt),e.mapEvent(yt.UPDATE,gt,yt),!0}),define("ac785/abf10/d9a0c/eed0c",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/f6dac/ffe62"],function(e,t,n,r,i){var s=t.View.extend({id:"dialog-container",initialize:function(){n.on(r.SHOW,e.bind(this.onShow,this)),this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.empty(),this},onShow:function(e){this.dialog=e.dialog,this.$el.html('<div class="modal-background"></div>').append(this.dialog.$el),this.dialog.render(),this.dialog.on("close",this.onClose,this),this.$el.show(),i.resize(this.resizeBind)},onClose:function(){i.off("resize",this.resizeBind),this.dialog.off(),this.dialog.remove(),this.dialog=undefined,this.$el.hide()},onResize:function(e){this.$el.css("width",e.width).css("height",e.height)}});return s}),define("hbs!template/room/footer/FacebookMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-facebook"></i>\n<i class="icon icon-facebook-selected"></i>\n<div class="menu">\n    <ul>\n        <li>\n            <div id="facebook-like" class="fb-like-box"\n                 data-href="https://www.facebook.com/plugdj"\n                 data-width="292"\n                 data-height="60"\n                 data-show-faces="false"\n                 data-stream="false"\n                 data-show-border="false"\n                 data-color-scheme="dark"\n                 data-header="false">\n            </div>\n        </li>\n        <li>\n            <i class="icon icon-share"></i>\n            <span class="share">'+a((o=(o=t.social,o==null||o===!1?o:o.shareVideo),typeof o===u?o.apply(t):o))+'</span>\n        </li>\n        <li>\n            <i class="icon icon-invite"></i>\n            <span class="invite">'+a((o=(o=t.social,o==null||o===!1?o:o.inviteFriends),typeof o===u?o.apply(t):o))+'</span>\n        </li>\n    </ul>\n    <div class="arrow-down"></div>\n</div>',s});return t.registerPartial("template_room_footer_FacebookMenu",n),n}),define("ac785/abf10/e9abd/abc95/d438f",["underscore","backbone","ac785/ca252/f89d8","ac785/ca252/ec425","ac785/ca252/c512b","ac785/e734f/a3e81","ac785/f6dac/bf313","hbs!template/room/footer/FacebookMenu","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.View.extend({id:"facebook-menu",className:"social-menu",render:function(){return this.$el.html(u(a)),this.$(".share").on("click",e.bind(this.onShare,this)),this.$(".invite").on("click",e.bind(this.onInvite,this)),this.$menu=this.$(".menu"),this.$share=this.$(".share"),r.on("change:media",this.onMediaChange,this),this.onMediaChange(),this},onMediaChange:function(){var e=r.get("media");e?(this.$menu.removeClass("invite-only"),this.$share.text(e.get("format")==2?a.social.shareSong:a.social.shareVideo)):this.$menu.addClass("invite-only")},onShare:function(){var t=r.get("media");return t&&(t.get("format")==1?this.openShare("http://youtu.be/"+t.get("cid")):t.get("format")==2&&s.scPermalink(t.get("cid"),e.bind(this.openShare,this))),!1},openShare:function(e){if(e){var t=r.get("media"),n="https://www.facebook.com/dialog/feed?app_id=216041638480603&redirect_uri=http%3A%2F%2Fplug.dj%2F_%2Ffbcallback&link="+encodeURIComponent(e)+"&picture"+encodeURIComponent(t.get("image"))+"&caption="+encodeURIComponent(a.social.facebookShareCaption)+"&description="+encodeURIComponent(a.social.facebookShareDescription)+"&name="+encodeURIComponent(t.get("author")+" - "+t.get("title"));this.openPopup(1015,495,n,"plugdjshare"),o.event("Social","Facebook Share")}},onInvite:function(){var e="http://plug.dj/"+i.get("id"),t="http://plug.dj/_/static/images/facebook01.5ee108d.png",s;n.isTheUserInBooth?s=a.social.facebookInviteNameDJ.split("%ROOM%").join(i.get("name")):s=a.social.facebookInviteName.split("%ROOM%").join(i.get("name"));var u="";r.get("media")&&(u=a.social.nowPlaying.split("%MEDIA%").join(r.get("media").get("author")+" - "+r.get("media").get("title")));var f="https://www.facebook.com/dialog/feed?app_id=216041638480603&redirect_uri=http%3A%2F%2Fplug.dj%2F_%2Ffbcallback&link="+encodeURIComponent(e)+"&picture="+encodeURIComponent(t)+"&caption="+encodeURIComponent(a.social.facebookInviteCaption)+"&description="+encodeURIComponent(u)+"&name="+encodeURIComponent(s);return this.openPopup(1015,495,f,"plugdjshare"),o.event("Social","Facebook Invite"),!1},openPopup:function(e,t,n,r){window.open(n,r,"status=1,width="+e+",height="+t+",left="+(screen.width-e)/2+",top="+(screen.height-t)/2)}});return f}),define("hbs!template/room/footer/TwitterMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-twitter"></i>\n<i class="icon icon-twitter-selected"></i>\n<div class="menu">\n    <ul>\n        <li>\n            <iframe id="twitter-follow" allowtransparency="true" frameborder="0" scrolling="no"\n                    src="http://platform.twitter.com/widgets/follow_button.html?screen_name=plugdj&show_screen_name=false&show_count=true"\n                    style="width:148px; height:20px;">\n            </iframe>\n        </li>\n        <li>\n            <i class="icon icon-share"></i>\n            <span class="share">'+a((o=(o=t.social,o==null||o===!1?o:o.shareVideo),typeof o===u?o.apply(t):o))+'</span>\n        </li>\n        <li>\n            <i class="icon icon-invite"></i>\n            <span class="invite">'+a((o=(o=t.social,o==null||o===!1?o:o.inviteFriends),typeof o===u?o.apply(t):o))+'</span>\n        </li>\n    </ul>\n    <div class="arrow-down"></div>\n</div>',s});return t.registerPartial("template_room_footer_TwitterMenu",n),n}),define("ac785/abf10/e9abd/abc95/a8bd5",["underscore","backbone","ac785/ca252/f89d8","ac785/ca252/ec425","ac785/ca252/c512b","ac785/e734f/a3e81","ac785/f6dac/bf313","hbs!template/room/footer/TwitterMenu","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.View.extend({id:"twitter-menu",className:"social-menu",render:function(){return this.$el.html(u(a)),this.$(".share").on("click",e.bind(this.onShare,this)),this.$(".invite").on("click",e.bind(this.onInvite,this)),this.$menu=this.$(".menu"),this.$share=this.$(".share"),r.on("change:media",this.onMediaChange,this),this.onMediaChange(),this},onMediaChange:function(){var e=r.get("media");e?(this.$menu.removeClass("invite-only"),this.$share.text(e.get("format")==2?a.social.shareSong:a.social.shareVideo)):this.$menu.addClass("invite-only")},onShare:function(){var t=r.get("media");return t&&(t.get("format")==1?this.openShare("http://youtu.be/"+t.get("cid")):t.get("format")==2&&s.scPermalink(t.get("cid"),e.bind(this.openShare,this))),!1},openShare:function(e){if(e){var t=r.get("media"),n="https://twitter.com/intent/tweet?text="+encodeURIComponent(a.social.twitterShare.split("%MEDIA%").join(t.get("author")+" - "+t.get("title")))+"&url="+encodeURIComponent(e);this.openPopup(575,420,n,"plugdjshare"),o.event("Social","Twitter Share")}},onInvite:function(){var e;n.isTheUserPlaying?e=a.social.twitterInviteDJ.split("%ROOM%").join(i.get("name")):e=a.social.twitterInvite.split("%ROOM%").join(i.get("name")),r.get("media")&&(e+=" "+a.social.nowPlaying.split("%MEDIA%").join(r.get("media").get("author")+" - "+r.get("media").get("title")));var t="http://plug.dj/"+encodeURIComponent(i.get("id")),s="https://twitter.com/intent/tweet?text="+encodeURIComponent(e+" "+t);return this.openPopup(575,420,s,"plugdjshare"),o.event("Social","Twitter Invite"),!1},openPopup:function(e,t,n,r){window.open(n,r,"status=1,width="+e+",height="+t+",left="+(screen.width-e)/2+",top="+(screen.height-t)/2)}});return f}),define("ac785/ca252/a4ec0",["backbone","ac785/ca252/cc7a2"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/ca252/ef1d8",["backbone","ac785/ca252/cc7a2","ac785/ca252/a4ec0","ac785/ab6db/e1b12"],function(e,t,n,r){var i=e.Model.extend({defaults:{query:""},initialize:function(){this.on("change:query",this.onQueryChange,this)},onQueryChange:function(){this.get("query")?n.reset(r.localSearch(this.get("query"))):n.reset()}});return new i}),define("hbs!template/room/playlist/help/PlaylistHelp",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="playlist-overlay-help">\r\n    <span>\r\n      <h2>'+a((o=(o=t.help,o==null||o===!1?o:o.playing),typeof o===u?o.apply(t):o))+"</h2>\r\n      <p>\r\n         "+a((o=(o=t.help,o==null||o===!1?o:o.playing1),typeof o===u?o.apply(t):o))+"<br>\r\n         "+a((o=(o=t.help,o==null||o===!1?o:o.playing2),typeof o===u?o.apply(t):o))+'<br>\r\n         <span class="help-activate-playlist"> '+a((o=(o=t.help,o==null||o===!1?o:o.playing3),typeof o===u?o.apply(t):o))+'</span><br>\r\n         <span class="help-activate-reverse"> '+a((o=(o=t.help,o==null||o===!1?o:o.playing4),typeof o===u?o.apply(t):o))+"</span>\r\n      </p>\r\n      <h2>"+a((o=(o=t.help,o==null||o===!1?o:o.selecting),typeof o===u?o.apply(t):o))+"</h2>\r\n      <p>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting1),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting2),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting3),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting4),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting5),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.selecting6),typeof o===u?o.apply(t):o))+"\r\n      </p>\r\n      <h2>"+a((o=(o=t.help,o==null||o===!1?o:o.filtering),typeof o===u?o.apply(t):o))+"</h2>\r\n      <p>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.filtering1),typeof o===u?o.apply(t):o))+"<br>\r\n          "+a((o=(o=t.help,o==null||o===!1?o:o.filtering2),typeof o===u?o.apply(t):o))+"\r\n      </p>\r\n    </span>\r\n</div>",s});return t.registerPartial("template_room_playlist_help_PlaylistHelp",n),n}),define("ac785/abf10/e9abd/b19be/f4a7e/a9b6e",["underscore","backbone","ac785/f6dac/ffe62","hbs!template/room/playlist/help/PlaylistHelp","lang/Lang"],function(e,t,n,r,i){var s=t.View.extend({className:"media-list",initialize:function(){this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.html(r(i)),n.resize(this.resizeBind),this},onResize:function(e){e=e||n.getSize(),this.$el.height(Math.max(550,e.height-this.$el.offset().top))},remove:function(){n.off("resize",this.resizeBind),this._super()}});return s}),define("ac785/ca252/f0735",["backbone"],function(e){var t=e.Model.extend({defaults:{name:undefined,username:undefined,playlistID:undefined,count:undefined}});return t}),define("ac785/ca252/fba13",["backbone","ac785/ca252/f0735"],function(e,t){var n=e.Collection.extend({model:t});return new n}),define("ac785/f04be/d2a1f",["underscore","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/ca252/fba13","ac785/e734f/a3e81","ac785/f04be/b23bd","ac785/d94e0/c7cab","ac785/d94e0/fb1a1","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.extend({load:function(t){r.reset(),n.trigger("import:ytplaylists",t),this.data=[],i.ytPlaylist(t,e.bind(this.onComplete,this))},onComplete:function(e){this.data=e,r.reset(e)},"import":function(){this.data.length>0&&(this.importMediaFacade||(this.importMediaFacade=new s,this.importMediaFacade.updateCallback=e.bind(this.onImportMediaComplete,this)),this.importIndex=0,this.importNextPlaylist(),e.delay(e.bind(this.importAlert,this),100))},importNextPlaylist:function(){this.timeoutID&&clearTimeout(this.timeoutID),this.importMediaFacade.load(this.data[this.importIndex])},onImportMediaComplete:function(t){this.createPlaylist(t,1),++this.importIndex<this.data.length&&(this.timeoutID=e.delay(e.bind(this.importNextPlaylist,this),10))},createPlaylist:function(e,t){if(e.length>0){var r=this.data[this.importIndex].playlistID?this.data[this.importIndex].name:"YouTube Favorites";t>1&&(r+=" "+t);if(e.length<=200)n.dispatch(new o(o.CREATE,r,e));else{var i=e.slice(0,200);n.dispatch(new o(o.CREATE,r,i)),e.splice(0,200),this.createPlaylist(e,++t)}}},importAlert:function(){n.trigger("notify","icon-import",a.alerts.youtubeImporting)}});return new f}),RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(e){"use strict";e.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(e,t){var n=/\./;if(isNaN(e))return e;if(n.test(e))return parseFloat(e);var r=parseInt(e);return isNaN(r)?null:r}},parsers:{parse:function(e,t){function f(){o=0,u="";if(t.start&&t.state.rowNum<t.start){s=[],t.state.rowNum++,t.state.colNum=1;return}if(t.onParseEntry===undefined)i.push(s);else{var e=t.onParseEntry(s,t.state);e!==!1&&i.push(e)}s=[],t.end&&t.state.rowNum>=t.end&&(a=!0),t.state.rowNum++,t.state.colNum=1}function l(){if(t.onParseValue===undefined)s.push(u);else{var e=t.onParseValue(u,t.state);e!==!1&&s.push(e)}u="",o=0,t.state.colNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var i=[],s=[],o=0,u="",a=!1,c=RegExp.escape(n),h=RegExp.escape(r),p=/(D|S|\n|\r|[^DS\r\n]+)/,d=p.source;return d=d.replace(/S/g,c),d=d.replace(/D/g,h),p=RegExp(d,"gm"),e.replace(p,function(e){if(a)return;switch(o){case 0:if(e===n){u+="",l();break}if(e===r){o=1;break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;u+=e,o=3;break;case 1:if(e===r){o=2;break}u+=e,o=1;break;case 2:if(e===r){u+=e,o=1;break}if(e===n){l();break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){l();break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;if(e===r)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),s.length!==0&&(l(),f()),i},splitLines:function(e,t){function a(){s=0;if(t.start&&t.state.rowNum<t.start){o="",t.state.rowNum++;return}if(t.onParseEntry===undefined)i.push(o);else{var e=t.onParseEntry(o,t.state);e!==!1&&i.push(e)}o="",t.end&&t.state.rowNum>=t.end&&(u=!0),t.state.rowNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1);var i=[],s=0,o="",u=!1,f=RegExp.escape(n),l=RegExp.escape(r),c=/(D|S|\n|\r|[^DS\r\n]+)/,h=c.source;return h=h.replace(/S/g,f),h=h.replace(/D/g,l),c=RegExp(h,"gm"),e.replace(c,function(e){if(u)return;switch(s){case 0:if(e===n){o+=e,s=0;break}if(e===r){o+=e,s=1;break}if(e==="\n"){a();break}if(/^\r$/.test(e))break;o+=e,s=3;break;case 1:if(e===r){o+=e,s=2;break}o+=e,s=1;break;case 2:var i=o.substr(o.length-1);if(e===r&&i===r){o+=e,s=1;break}if(e===n){o+=e,s=0;break}if(e==="\n"){a();break}if(e==="\r")break;throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");case 3:if(e===n){o+=e,s=0;break}if(e==="\n"){a();break}if(e==="\r")break;if(e===r)throw new Error("CSVDataError: Illegal quote [Row:"+t.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+t.state.rowNum+"]")}}),o!==""&&a(),i},parseEntry:function(e,t){function u(){if(t.onParseValue===undefined)i.push(o);else{var e=t.onParseValue(o,t.state);e!==!1&&i.push(e)}o="",s=0,t.state.colNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var i=[],s=0,o="";if(!t.match){var a=RegExp.escape(n),f=RegExp.escape(r),l=/(D|S|\n|\r|[^DS\r\n]+)/,c=l.source;c=c.replace(/S/g,a),c=c.replace(/D/g,f),t.match=RegExp(c,"gm")}return e.replace(t.match,function(e){switch(s){case 0:if(e===n){o+="",u();break}if(e===r){s=1;break}if(e==="\n"||e==="\r")break;o+=e,s=3;break;case 1:if(e===r){s=2;break}o+=e,s=1;break;case 2:if(e===r){o+=e,s=1;break}if(e===n){u();break}if(e==="\n"||e==="\r")break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){u();break}if(e==="\n"||e==="\r")break;if(e===r)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),u(),i}},toArray:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter;var s=n.state!==undefined?n.state:{},n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,state:s},o=e.csv.parsers.parseEntry(t,n);if(!i.callback)return o;i.callback("",o)},toArrays:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter;var s=[],n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1}};s=e.csv.parsers.parse(t,n);if(!i.callback)return s;i.callback("",s)},toObjects:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,i.headers="headers"in n?n.headers:e.csv.defaults.headers,n.start="start"in n?n.start:1,i.headers&&n.start++,n.end&&i.headers&&n.end++;var s=[],o=[],n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1},match:!1},u={delimiter:i.delimiter,separator:i.separator,start:1,end:1,state:{rowNum:1,colNum:1}},a=e.csv.parsers.splitLines(t,u),f=e.csv.toArray(a[0],n),s=e.csv.parsers.splitLines(t,n);n.state.colNum=1,f?n.state.rowNum=2:n.state.rowNum=1;for(var l=0,c=s.length;l<c;l++){var h=e.csv.toArray(s[l],n),p={};for(var d in f)p[f[d]]=h[d];o.push(p),n.state.rowNum++}if(!i.callback)return o;i.callback("",o)},fromArrays:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,i.escaper="escaper"in n?n.escaper:e.csv.defaults.escaper,i.experimental="experimental"in n?n.experimental:!1;if(!i.experimental)throw new Error("not implemented");var s=[];for(var o in t)s.push(t[o]);if(!i.callback)return s;i.callback("",s)},fromObjects2CSV:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,i.experimental="experimental"in n?n.experimental:!1;if(!i.experimental)throw new Error("not implemented");var s=[];for(var o in t)s.push(arrays[o]);if(!i.callback)return s;i.callback("",s)}},e.csvEntry2Array=e.csv.toArray,e.csv2Array=e.csv.toArrays,e.csv2Dictionary=e.csv.toObjects}(jQuery),define("jquery-csv",["jquery"],function(e){return function(){var t,n;return t||e.$}}(this)),define("ac785/abf10/d9a0c/afa2e",["jquery-csv","underscore","ac785/abf10/d9a0c/fbb95","ac785/d94e0/c4bc0","ac785/d94e0/fb1a1","ac785/f6dac/bf313","lang/Lang"],function(e,t,n,r,i,s,o){var u=n.extend({id:"dialog-import-tt",className:"dialog no-submit",initialize:function(){this._super(),this.items=[],this.status=0;try{this.items=e.csv.toObjects(this.options.data)}catch(t){this.status=-1}},render:function(){return this.$el.append(this.getHeader("Turntable Import")).append(this.getBody().append(this.getInputField("name",o.dialog.name,o.dialog.playlistName,"",24))).append(this.getButtons(o.import.importThis,!0)),t.defer(t.bind(this.deferFocus,this)),this._super()},deferFocus:function(){this.$field=this.$el.find("input").on("keyup",t.bind(this.onKeyUp,this)).focus()},onKeyUp:function(){this.$field[0].value.length>0?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},show:function(){this._super(),this.items.length==0&&t.defer(this.dispatch(new i(i.ALERT,undefined,this.status==0?"No Songs Were Found":"Invalid Playlist File")))},submit:function(){var t=this.$el.find("input")[0].value;t.length>0&&(this.$(".button").hide(),this.$el.addClass("importing"),this.$(".dialog-body").append(e("<div/>").addClass("import-progress-bar").append(e("<div/>").addClass("progress-bar")).append(e("<span/>").addClass("import-item")).append(e("<span/>").addClass("import-count").text("0 / "+this.items.length))).append(e("<span/>").addClass("import-time")),this.dispatch(new r(r.IMPORT,t,this.items)),s.event("Dialog","Import Turntable",this.items.length))},close:function(){this.$el.hasClass("importing")||(this.options.data=undefined,this.$field.off(),this.$field=undefined,this._super())}});return u}),define("hbs!template/room/playlist/import/PlaylistImport",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div id="import-youtube">\r\n    <i class="icon icon-youtube-big"></i>\r\n    <div class="youtube-input">\r\n        <form class="youtube-input-form" onsubmit="return false">\r\n            <input id="youtube-input-field" type="text" value="" placeholder="'+a((o=(o=t["import"],o==null||o===!1?o:o.ytUsername),typeof o===u?o.apply(t):o))+'" maxlength="64"/>\r\n        </form>\r\n        <div class="button">\r\n            <span>'+a((o=(o=t["import"],o==null||o===!1?o:o["import"]),typeof o===u?o.apply(t):o))+'</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="bar-divider"></div>\r\n<div id="import-soundcloud">\r\n    <i class="icon icon-soundcloud-big"></i>\r\n    <div id="import-soundcloud-favorites" class="button">\r\n        <i class="icon icon-soundcloud-favorites"></i>\r\n        <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.favorites),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div id="import-soundcloud-tracks" class="button">\r\n        <i class="icon icon-soundcloud-tracks"></i>\r\n        <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.tracks),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div id="import-soundcloud-sets" class="button">\r\n        <i class="icon icon-soundcloud-sets"></i>\r\n        <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.sets),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n</div>\r\n<div id="import-turntable" class="button">\r\n    <i class="icon icon-tt"></i>\r\n    <span>Import turntable.fm</span>\r\n    <input id="tt-import" value="TT" name="ttfile" type="file">\r\n</div>',s});return t.registerPartial("template_room_playlist_import_PlaylistImport",n),n}),define("ac785/abf10/e9abd/b19be/ae12c/b6157",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/b1cfb","ac785/d94e0/bd874","ac785/f04be/d2a1f","ac785/f6dac/ffe62","ac785/f6dac/aa843","ac785/f6dac/bf313","ac785/abf10/d9a0c/afa2e","hbs!template/room/playlist/import/PlaylistImport","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=t.View.extend({id:"playlist-import-panel",template:l(c),initialize:function(){this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.html(this.template),u.sc?this.$("#import-soundcloud .button").on("click",e.bind(this.onSCClick,this)):this.$el.addClass("no-soundcloud"),this.$("#import-youtube .button").on("click",e.bind(this.onYTClick,this)),this.$("#youtube-input-field").keyup(e.bind(this.onYTKeyUp,this)).focus(e.bind(this.onYTFocus,this)).blur(e.bind(this.onYTBlur,this)),this.$(".icon-youtube-big").css("left",(this.$("#import-youtube").width()-this.$(".icon-youtube-big").width())/2),this.$(".icon-soundcloud-big").css("left",(this.$("#import-soundcloud").width()-this.$(".icon-soundcloud-big").width())/2),this.$("#tt-import").on("change",e.bind(this.onTTClick,this)),o.resize(this.resizeBind),this},remove:function(){this.$(".button").off(),this.$("#youtube-input-field").off(),this.$("#tt-import").off(),this.$el.empty(),o.off("resize",this.resizeBind),this._super()},onResize:function(){var e=$("#media-panel").width()-18;this.$el.width(e),e/=2,this.$(".bar-divider").css("left",e),this.$("#import-youtube").css("left",(e-250)/2-4.5),this.$("#import-soundcloud").css("left",e+(e-250)/2-4.5),this.$("#import-turntable").css("left",(this.$el.width()-this.$("#import-turntable").width())/2)},onYTClick:function(){var e=this.$("#youtube-input-field")[0].value;e.length>0&&(s.load(e),a.event("Import","YouTube"))},onSCClick:function(e){var t,i=$(e.currentTarget).attr("id");i=="import-soundcloud-favorites"?t=r.FAVORITES:i=="import-soundcloud-tracks"?t=r.TRACKS:i=="import-soundcloud-sets"&&(t=r.SETS),n.dispatch(new r(t)),a.event("Import","SoundCloud "+t)},onYTKeyUp:function(e){var t;return e?(t=e.which||e.keyCode,t==13?(e.preventDefault(),e.stopImmediatePropagation(),this.onYTClick(),!1):!0):!0},onYTFocus:function(e){this.$("#youtube-input-field")[0].placeholder=""},onYTBlur:function(e){this.$("#youtube-input-field")[0].placeholder=c.import.ytUsername},onTTClick:function(e){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var t=e.target.files;if(t.length>0){var r=new FileReader;r.onload=function(e){n.dispatch(new i(i.SHOW,new f({data:e.target.result})))},r.readAsText(t[0])}}else alert("This browser does not support the feature required to import from turntable.")}});return h}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d",["underscore","backbone","ac785/f6dac/ffe62"],function(e,t,n){var r=t.View.extend({className:"header",initialize:function(){this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.html(this.template),n.resize(this.resizeBind),this},remove:function(){n.off("resize",this.resizeBind),this._super()},setTitle:function(e){return this.$(".title span").text(e||""),this},onResize:function(e){this.$(".title").width(this.$el.width()-parseInt(this.$(".title").css("left"))*2)}});return r}),define("hbs!template/room/playlist/media/headers/HistoryHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-room-history"></i>\n<div class="title">\n    <span>'+a((o=(o=t.playlist,o==null||o===!1?o:o.history),typeof o===u?o.apply(t):o))+"</span>\n</div>",s});return t.registerPartial("template_room_playlist_media_headers_HistoryHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/deb9c",["ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/HistoryHeader","lang/Lang"],function(e,t,n){var r=e.extend({template:t(n),className:"header history"});return r}),define("hbs!template/room/playlist/media/headers/ImportHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<i class="icon icon-import-big"></i>\n<div class="title">\n    <span></span>\n</div>'});return t.registerPartial("template_room_playlist_media_headers_ImportHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/d4a01",["ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportHeader"],function(e,t){var n=e.extend({template:t(),className:"header import"});return n}),define("hbs!template/room/playlist/media/headers/ImportSoundCloudHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-import-big"></i>\r\n<div class="title">\r\n    <span></span>\r\n</div>\r\n<div class="button import-button">\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.importThis),typeof o===u?o.apply(t):o))+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_headers_ImportSoundCloudHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/f275b",["ac785/f04be/f1000","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportSoundCloudHeader","lang/Lang"],function(e,t,n,r){var i=t.extend({template:n(r),className:"header import",render:function(){return this._super(),this.$(".import-button").on("click",_.bind(this.onImportClick,this)),this},remove:function(){this.$(".import-button").off(),this._super()},onImportClick:function(){e.importSC(this.$(".title span").text()),this.$(".import-button").hide()}});return i}),define("hbs!template/room/playlist/media/headers/ImportMediaHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="button back">\r\n    <i class="icon icon-back"></i>\r\n    <span>'+a((o=(o=t.playlist,o==null||o===!1?o:o.back),typeof o===u?o.apply(t):o))+'</span>\r\n</div>\r\n<i class="icon icon-import-big"></i>\r\n<div class="title">\r\n    <span></span>\r\n</div>\r\n<div class="button import-button">\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.importThis),typeof o===u?o.apply(t):o))+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_headers_ImportMediaHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/c7147",["underscore","ac785/f04be/e84bd","ac785/ca252/baa5d","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportMediaHeader","lang/Lang"],function(e,t,n,r,i,s){var o=r.extend({template:i(s),className:"header import-with-back",render:function(){return this._super(),this.setTitle(n.selectedSet.get("title")),this.$(".back").on("click",e.bind(this.onBackClick,this)),this.$(".import-button").on("click",e.bind(this.onImportClick,this)),this.$(".import-button span").text(s.import.importThisSet),this},remove:function(){this.$(".back").off(),this.$(".import-button").off(),this._super()},onBackClick:function(){this.trigger("back")},onImportClick:function(){t.importSelected(),this.$(".import-button").hide()}});return o}),define("hbs!template/room/playlist/media/headers/ImportSoundCloudSetsHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-import-big"></i>\r\n<div class="title">\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.sets),typeof o===u?o.apply(t):o))+'</span>\r\n</div>\r\n<div class="button import-button">\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.importSets),typeof o===u?o.apply(t):o))+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_headers_ImportSoundCloudSetsHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/b0965",["underscore","ac785/f04be/e84bd","ac785/ca252/baa5d","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportSoundCloudSetsHeader","lang/Lang"],function(e,t,n,r,i,s){var o=r.extend({template:i(s),className:"header import",render:function(){this._super(),n.selectedSet=undefined,this.$(".import-button").on("click",e.bind(this.onImportClick,this))},remove:function(){this.$(".import-button").off(),this._super()},onImportClick:function(){t.importAll(),this.$(".import-button").hide()},onResize:function(e){this.$(".title").width(this.$el.width()-parseInt(this.$(".title").css("left"))-parseInt(this.$(".import-button").width())-10)}});return o}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/fb7d7",["ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/d4a09","ac785/f04be/d2a1f","ac785/f04be/b23bd","ac785/ca252/a996a","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportMediaHeader","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=o.extend({template:u(a),className:"header import-with-back",render:function(){return this._super(),this.setTitle(this.title||""),this.$(".back").on("click",_.bind(this.onBackClick,this)),this.$(".import-button").on("click",_.bind(this.onImportClick,this)),this},remove:function(){s.reset(),this.$(".back").off(),this.$(".import-button").off(),this.title=undefined,this.username=undefined,this._super()},onImport:function(e){this.title=e.name,this.username=e.username,this.setTitle(e.name)},onBackClick:function(){r.load(this.username)},onImportClick:function(){i.instance.import(),this.$(".import-button").hide(),e.trigger("notify","icon-import",a.alerts.playlistImporting.split("%PLAYLIST%").join(this.title))},onResize:function(e){this.$(".title").width(this.$el.width()-parseInt(this.$(".title").css("left"))-parseInt(this.$(".import-button").width())-10)}});return f}),define("hbs!template/room/playlist/media/headers/ImportYouTubePlaylistsHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-import-big"></i>\r\n<div class="title">\r\n    <span></span>\r\n</div>\r\n<div class="button import-button">\r\n    <span>'+a((o=(o=t["import"],o==null||o===!1?o:o.importAll),typeof o===u?o.apply(t):o))+"</span>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_headers_ImportYouTubePlaylistsHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/d07c1",["underscore","ac785/bc190/cd0b8","ac785/f04be/d2a1f","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/ImportYouTubePlaylistsHeader","lang/Lang"],function(e,t,n,r,i,s){var o=r.extend({template:i(s),className:"header import",initialize:function(){t.on("import:ytplaylists",this.onImport,this),this._super()},onImport:function(e){this.username=e,this.setTitle(e)},render:function(){return this._super(),this.setTitle(this.username||""),this.$(".import-button").on("click",e.bind(this.onImportClick,this)),this},remove:function(){this.$(".import-button").off(),this._super()},onImportClick:function(){n.import(),this.$(".import-button").hide()},onResize:function(e){this.$(".title").width(this.$el.width()-parseInt(this.$(".title").css("left"))-parseInt(this.$(".import-button").width())-10)}});return o}),define("ac785/ca252/ea4a8",["backbone","ac785/ca252/de5df","ac785/ca252/dba93"],function(e,t,n){var r=e.Collection.extend({model:t,initialize:function(){n.on("reset",this.onReset,this).on("update",this.onUpdate,this),this.setFilter()},onReset:function(){this.setFilter()},onUpdate:function(){this.setFilter(this.currentFilter)},setFilter:function(e){this.currentFilter=e,n.length>0?e?this.reset(n.filter(function(t){return t.get("author")&&t.get("title")&&(t.get("author").toLowerCase().indexOf(e)>-1||t.get("title").toLowerCase().indexOf(e)>-1)})):this.reset(n.toArray()):this.reset()},isActualFirst:function(){return this.first()==n.first()}});return new r}),define("hbs!template/room/playlist/media/headers/PlaylistMediaHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="title">\r\n    <span></span>\r\n</div>\r\n<div id="playlist-activate-button" class="button">\r\n    <i class="icon icon-active-selected"></i>\r\n    <span></span>\r\n</div>\r\n<div id="playlist-edit-button" class="button">\r\n    <i class="icon icon-edit-white"></i>\r\n</div>\r\n<div id="playlist-shuffle-button" class="button">\r\n    <i class="icon icon-shuffle"></i>\r\n</div>\r\n<div id="playlist-delete-button" class="button">\r\n    <i class="icon icon-delete"></i>\r\n</div>'});return t.registerPartial("template_room_playlist_media_headers_PlaylistMediaHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/f0fa5",["underscore","ac785/bc190/cd0b8","ac785/d94e0/fc0ee","ac785/d94e0/ae10c","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/ea4a8","ac785/ca252/c0f8f","ac785/f6dac/bf313","ac785/f6dac/c41ff","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/PlaylistMediaHeader","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=l.extend({template:c(h),className:"header no-icon",initialize:function(){u.on("change:visible change:name change:selected",this.onTitleUpdate,this).on("change:items",this.onItemsUpdate,this).on("change:visible",this.clearFilter,this),s.on("update",this.onDJUpdate,this),this._super()},render:function(){this._super(),this.$("#playlist-activate-button").on("click",e.bind(this.onActivateClick,this)),this.$("#playlist-edit-button").on("click",e.bind(this.onEditClick,this)),this.$("#playlist-delete-button").on("click",e.bind(this.onDeleteClick,this)),this.$("#playlist-shuffle-button").on("click",e.bind(this.onShuffleClick,this)),this.onTitleUpdate()},remove:function(){this.$("#playlist-activate-button").off(),this.$("#playlist-edit-button").off(),this.$("#playlist-delete-button").off(),this.$("#playlist-shuffle-button").off(),this._super()},onTitleUpdate:function(){var e=u.find(function(e){return e.get("visible")});e&&(this.setTitle(e.get("name")),e.get("selected")?(this.$("#playlist-activate-button").addClass("selected"),this.$("#playlist-activate-button span").text(h.playlist.active),this.$("#playlist-activate-button .icon").removeClass("icon-active-selected").addClass("icon-active-circle")):(this.$("#playlist-activate-button").removeClass("selected"),this.$("#playlist-activate-button span").text(h.playlist.activate),this.$("#playlist-activate-button .icon").removeClass("icon-active-circle").addClass("icon-active-selected")),this.disableButton(this.$("#playlist-shuffle-button"),e.get("items").length>2))},onItemsUpdate:function(){var e=u.find(function(e){return e.get("visible")});this.disableButton(this.$("#playlist-shuffle-button"),e&&e.get("items").length>2)},onDJUpdate:function(){var e=u.find(function(e){return e.get("visible")});this.disableButton(this.$("#playlist-delete-button"),i.isTheUserInBooth&&e&&e.get("selected"))},disableButton:function(e,t){t?e.removeClass("disabled"):e.addClass("disabled")},onActivateClick:function(){var e=u.find(function(e){return e.get("visible")});e&&!e.get("selected")&&(t.dispatch(new r(r.ACTIVATE)),a.event("Playlist","Activate Header"))},onEditClick:function(){t.dispatch(new r(r.RENAME))},onDeleteClick:function(){t.dispatch(new r(r.DELETE))},onShuffleClick:function(){var e=u.find(function(e){return e.get("visible")});e&&e.get("items").length>2&&(t.dispatch(new n(n.SHUFFLE)),a.event("Playlist","Shuffle"))},onResize:function(e){this.$(".title").width(this.$el.width()-parseInt(this.$(".title").css("left"))*2-parseInt(this.$("#playlist-activate-button").css("left")))}});return p}),define("hbs!template/room/playlist/media/headers/SearchMediaHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<i class="icon icon-search"></i>\r\n<div class="title">\r\n    <span></span>\r\n</div>'});return t.registerPartial("template_room_playlist_media_headers_SearchMediaHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/a55f1",["ac785/ca252/ef1d8","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/SearchMediaHeader"],function(e,t,n){var r=t.extend({template:n(),render:function(){this._super(),e.on("change:query",this.onQueryChange,this),this.setTitle(e.get("query"))},remove:function(){this._super(),e.off("change:query",this.onQueryChange,this)},onQueryChange:function(e,t){this.setTitle(t)}});return r}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/a1980",["ac785/ca252/f4f89","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/SearchMediaHeader"],function(e,t,n){var r=t.extend({template:n(),render:function(){return this._super(),e.on("change:query",this.onQueryUpdate,this),this.setTitle(e.get("query")),this},remove:function(){this._super(),e.off("change:query",this.onQueryUpdate,this)},onQueryUpdate:function(e,t){this.setTitle(t)}});return r}),define("hbs!template/room/playlist/media/headers/SearchRelatedHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="button back">\r\n    <i class="icon icon-back"></i>\r\n    <span>'+a((o=(o=t.playlist,o==null||o===!1?o:o.back),typeof o===u?o.apply(t):o))+'</span>\r\n</div>\r\n<i class="icon icon-search"></i>\r\n<div class="title">\r\n    <span></span>\r\n</div>',s});return t.registerPartial("template_room_playlist_media_headers_SearchRelatedHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/e5b8b",["underscore","ac785/bc190/cd0b8","ac785/d94e0/bcf57","ac785/ca252/f4f89","ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/SearchRelatedHeader","lang/Lang"],function(e,t,n,r,i,s,o){var u=i.extend({template:s(o),className:"header with-back",render:function(){return this._super(),r.on("change:related",this.onRelatedUpdate,this),this.$(".back").on("click",e.bind(this.onBackClick,this)),this.setTitle(r.get("related")),this},remove:function(){this.$(".back").off(),r.off("change:related",this.onRelatedUpdate,this),this._super()},onRelatedUpdate:function(e,t){this.setTitle(t)},onBackClick:function(){t.dispatch(new n(n.BACK))}});return u}),define("hbs!template/room/playlist/media/headers/SimpleTitleHeader",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="title">\n    <span></span>\n</div>'});return t.registerPartial("template_room_playlist_media_headers_SimpleTitleHeader",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/cacb0/a22ee",["ac785/abf10/e9abd/b19be/bbe20/cacb0/d772d","hbs!template/room/playlist/media/headers/SimpleTitleHeader"],function(e,t){var n=e.extend({template:t(),initialize:function(){this._super(),this.$el.addClass("no-icon")}});return n}),define("ac785/ca252/bc4cb",["backbone","ac785/ca252/b276e","ac785/ca252/de5df"],function(e,t,n){var r=e.Collection.extend({model:n,initialize:function(){t.on("reset",_.bind(this.onReset,this))},onReset:function(){this.setFilter()},setFilter:function(e){t.length>0?e?this.reset(t.filter(function(t){return t.get("media").get("author")&&t.get("media").get("title")&&(t.get("media").get("author").toLowerCase().indexOf(e)>-1||t.get("media").get("title").toLowerCase().indexOf(e)>-1||t.get("user").username.toLowerCase().indexOf(e)>-1)})):this.reset(t.toArray()):this.reset()},comparator:function(e){return-e.get("timestamp")}});return new r}),define("hbs!template/room/playlist/media/list/HistoryMediaRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<img src="',(o=n.image)?o=o.call(t,{hash:{}}):(o=t.image,o=typeof o===u?o.apply(t):o),s+=a(o)+'"/>\r\n<div class="meta">\r\n    <span class="author">',(o=n.author)?o=o.call(t,{hash:{}}):(o=t.author,o=typeof o===u?o.apply(t):o),s+=a(o)+" - ",(o=n.title)?o=o.call(t,{hash:{}}):(o=t.title,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="dj">',(o=n.username)?o=o.call(t,{hash:{}}):(o=t.username,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="timestamp">',(o=n.timestamp)?o=o.call(t,{hash:{}}):(o=t.timestamp,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n</div>\r\n<div class="score">\r\n    <div class="item positive">\r\n        <i class="icon icon-history-positive"></i><span>'+a((o=(o=t.score,o==null||o===!1?o:o.positive),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div class="item curates">\r\n        <i class="icon icon-history-curates"></i><span>'+a((o=(o=t.score,o==null||o===!1?o:o.curates),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div class="item negative">\r\n        <i class="icon icon-history-negative"></i><span>'+a((o=(o=t.score,o==null||o===!1?o:o.negative),typeof o===u?o.apply(t):o))+'</span>\r\n    </div>\r\n    <div class="item listeners">\r\n        <i class="icon icon-history-listeners"></i><span>'+a((o=(o=t.score,o==null||o===!1?o:o.listeners),typeof o===u?o.apply(t):o))+"</span>\r\n    </div>\r\n</div>",s});return t.registerPartial("template_room_playlist_media_list_HistoryMediaRow",n),n}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/b0e75",["underscore","ac785/ca252/bed74","ac785/f6dac/d17c3","ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb","hbs!template/room/playlist/media/list/HistoryMediaRow"],function(e,t,n,r,i){var s=r.extend({render:function(){var e=this.model.get("media"),t=this.model.get("room");return this.$el.html(i({image:e.get("image"),author:e.get("author"),title:e.get("title"),timestamp:n.convertTimestampToReadableDate(this.model.get("timestamp"),!0),username:this.model.get("user").username,score:t})),this.updateScore(t),this.update(),this},onChange:function(){this.updateScore(this.model.get("room"))},updateScore:function(e){this.$(".positive span").text(e.positive),this.$(".curates span").text(e.curates),this.$(".negative span").text(e.negative),this.$(".listeners span").text(e.listeners||t.length-1);var n=0;e.positive>999?n=18:e.positive>99?n=11:e.positive>9&&(n=3),this.$(".curates").css("left",36+n),e.curates>999?n+=18:e.curates>99?n+=11:e.curates>9&&(n+=3),this.$(".negative").css("left",73+n),e.negative>999?n+=18:e.negative>99?n+=11:e.negative>9&&(n+=3),this.$(".listeners").css("left",111+n)},getAction:function(){return"history"}});return s}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/e2765",["jquery","ac785/bc190/cd0b8","ac785/d94e0/ab74a","ac785/ca252/bc4cb","ac785/f6dac/ffe62","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/b0e75"],function(e,t,n,r,i,s,o){var u=s.extend({collection:r,RowClass:o,listClass:"history",doubleClickRow:function(r){e(document).off("mousemove",this.thresholdBind),this.resetDrag(),this.lastClickedRow=r,t.dispatch(new n(n.PREVIEW,r.model.get("media")))},getSelectedRows:function(){var e=[],t,n={};for(t in this.selectedRows)n[this.selectedRows[t].model.get("media").get("cid")]||(e.push(this.selectedRows[t]),n[this.selectedRows[t].model.get("media").get("cid")]=!0);return e.sort(this.sortSelectedRows),e},selectMultipleRows:function(e,t){for(var n=e;n>=t;n--)this.selectedRows[this.collection.at(n).get("media").get("cid")]=this.rows[n];this.updateSelectedRows()},updateSelectedRows:function(){var e=this;_.each(this.rows,function(t){t.select(e.selectedRows[t.model.get("media").get("cid")]!=undefined)})},toggleRow:function(e){e.select(!e.options.selected),e.options.selected?this.selectedRows[e.model.get("media").get("cid")]=e:delete this.selectedRows[e.model.get("media").get("cid")]},checkForZero:function(){this.collection.length==0&&this.hideLoadSpinner()}});return u}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/dbc83",["underscore","ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb","hbs!template/room/playlist/media/list/PlaylistMediaRow","ac785/f6dac/d17c3","ac785/bc190/cd0b8","ac785/ab6db/e1b12","ac785/ab6db/ffb2a","ac785/ca252/c0f8f"],function(e,t,n,r,i,s,o,u){var a=t.extend({render:function(){this.$el.html(n({image:this.model.get("image"),author:this.model.get("author"),title:this.model.get("title"),duration:r.formatTime(this.model.get("duration"),!1)}));var e=this.model.get("id");if(String(e).indexOf(":")>-1&&s.exists(e)){this.$el.addClass("has-playlists");var t=o.getMediaPlaylists(this.model.get("cid")),i=t.length,a=$("<span/>").addClass("playlists");for(var f=0;f<i;++f)a.append($('<a href="javascript:void(0)"/>').html($("<span/>").text(t[f].name).html()).data("id",t[f].id).data("media",e).click(function(){var e=$(this);u.jumpToMedia(e.data("id"),e.data("media"))})),f<i-1&&a.append(", ");this.$(".meta").append($("<i/>").addClass("icon icon-playlist-small")).append(a)}return this.update(),this},getAction:function(){return"searchMedia"}});return a}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/e5dad",["ac785/abf10/e9abd/b19be/bbe20/d2a6f/dbc83"],function(e){var t=e.extend({getAction:function(){return"importMedia"}});return t}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/dd1f0",["underscore","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/e5dad","ac785/ca252/baa5d"],function(e,t,n,r){var i=t.extend({collection:r,RowClass:n,listClass:"import-media",render:function(){return this.$el.empty().append(this.$div),this.onCollectionReset(),this},remove:function(){this.clear(),this.clearSelection(),this._super()},drawList:function(){e.each(this.collection.selectedSet.get("tracks"),this.drawRowBind)},checkForZero:function(){}});return i}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/d5525",["jquery","underscore","backbone","ac785/f6dac/ffe62","ac785/abf10/bc8c0/e31ab"],function(e,t,n,r,i){var s=n.View.extend({className:"media-list",listClass:"import-playlist-list",initialize:function(){this.drawRowBind=t.bind(this.drawRow,this),this.rows=[],this.$el.scrollTop(0),this.resizeBind=t.bind(this.onResize,this)},onCollectionReset:function(){this.clear(),this.collection.each(this.drawRowBind),this.$el.scrollTop(0)},onResize:function(e){e=e||r.getSize(),this.$el.height(Math.max(350,e.height-this.$el.offset().top))},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.$el.empty(),this.hideLoadSpinner()},render:function(){return this.collection.on("reset",this.onCollectionReset,this),this.onCollectionReset(),this.showLoadSpinner(),r.resize(this.resizeBind),this},remove:function(){this.clear(),this.collection.off("reset",this.onCollectionReset,this),r.off("resize",this.resizeBind),this._super()},showLoadSpinner:function(){this.hideLoadSpinner(),this.loadSpinner=new i({size:i.MEDIUM}),this.$el.append(this.loadSpinner.$el),this.loadSpinner.render().$el.css("left","50%").css("top","40%").css("z-index",9999)},hideLoadSpinner:function(){this.loadSpinner&&(this.loadSpinner.remove(),this.loadSpinner=undefined)},drawRow:function(e,t){var n=new this.RowClass({model:e,index:t});return this.$el.append(n.$el),n.render(),n.on("over",this.onRowOver,this).on("out",this.onRowOut,this).on("release",this.onRowRelease,this),this.rows.push(n),n},onRowOver:function(e){e.row.select(!0)},onRowOut:function(e){e.row.select(!1)},onRowRelease:function(e){},checkForZero:function(){}});return s}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/dc98a",["backbone"],function(e){var t=e.View.extend({className:"row",events:{mouseenter:"onRowEnter",mouseleave:"onRowLeave",mouseup:"onRowRelease"},remove:function(){this._super(),this.off(),this.model=undefined,this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},render:function(){return this.$el.html('<div class="meta"><span>'+(this.model.get("name")||this.model.get("title"))+"</span></div>"),this.update(),this},select:function(e){this.options.selected!=e&&(this.options.selected=e,this.update())},update:function(){this.options.selected?this.$el.addClass("selected"):this.$el.removeClass("selected")},onRowEnter:function(e){this.trigger("over",{event:e,row:this})},onRowLeave:function(e){this.trigger("out",{event:e,row:this})},onRowRelease:function(e){this.trigger("release",{event:e,row:this})}});return t}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/f6295",["ac785/abf10/e9abd/b19be/bbe20/d2a6f/d5525","ac785/abf10/e9abd/b19be/bbe20/d2a6f/dc98a","ac785/ca252/baa5d"],function(e,t,n){var r=e.extend({RowClass:t,collection:n,onRowRelease:function(e){n.selectedSet=e.row.model,this.trigger("select")}});return r}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/de952",["underscore","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/e5dad","ac785/ca252/a996a"],function(e,t,n,r){var i=t.extend({collection:r,RowClass:n,listClass:"import-media"});return i}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/b9ebc",["ac785/abf10/e9abd/b19be/bbe20/d2a6f/d5525","ac785/abf10/e9abd/b19be/bbe20/d2a6f/dc98a","ac785/ca252/fba13","ac785/d94e0/d4a09","ac785/bc190/cd0b8"],function(e,t,n,r,i){var s=e.extend({RowClass:t,collection:n,onRowRelease:function(e){i.dispatch(new r(r.IMPORT,e.row.model.toJSON()))}});return s}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/b5d3c",["underscore","ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb","hbs!template/room/playlist/media/list/PlaylistMediaRow","ac785/f6dac/d17c3"],function(e,t,n,r){var i=t.extend({isNowPlaying:!1,isActualFirst:!1,onChange:function(e){var t=e.changedAttributes();if(t)for(var n in t)n==="image"?this.$(".thumbnail img").attr("src",t[n]):n==="author"?this.$(".author").text(t[n]):n==="title"?this.$(".title").text(t[n]):n==="duration"&&this.$(".duration").text(r.formatTime(t[n],!1))},render:function(){return this.$el.html(n({image:this.model.get("image"),author:this.model.get("author"),title:this.model.get("title"),duration:r.formatTime(this.model.get("duration"),!1)})),this.$duration=this.$(".duration"),this.update(),this},setDuration:function(e){return this.$duration.text(r.formatTime(Math.max(e,0))),this},nowPlaying:function(e){return this.$el&&(e?this.$el.addClass("now-playing").css("cursor","not-allowed"):this.$el.removeClass("now-playing").css("cursor","default"),this.isNowPlaying=e),this},actualFirst:function(e){this.isActualFirst=e},getAction:function(){return this.options.index!=0?"playlistMedia":this.isNowPlaying?"playlistMediaLocked":this.isActualFirst?"playlistMediaFirst":"playlistMedia"}});return i}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/f733b",["underscore","ac785/bc190/cd0b8","ac785/d94e0/f5b19","ac785/d94e0/fc0ee","ac785/ca252/ea4a8","ac785/ca252/ec425","ac785/ca252/c0f8f","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/b5d3c"],function(e,t,n,r,i,s,o,u,a){var f=u.extend({collection:i,RowClass:a,listClass:"playlist-media",initialize:function(){this._super(),this.firstRow=undefined,this.targetDropIndex=0,this.drawSubRowBind=e.bind(this.drawSubRow,this),this.drawRemainingRowsBind=e.bind(this.drawRemainingRows,this),this.drawRemainingRowBind=e.bind(this.drawRemainingRow,this),s.on("change:historyID",this.onFirstRowLockCheck,this),o.on("change:visible",this.onFirstRowLockCheck,this),t.on("jumpto:index",this.jumpToIndex,this)},drawList:function(){this.scrollLock||this.$el.scrollTop()>0||this.collection.length<30?this.collection.each(this.drawRowBind):this.collection.every(this.drawSubRowBind),this.onFirstRowLockCheck()},drawSubRow:function(t,n){return n>29?(e.delay(this.drawRemainingRowsBind,500),!1):(this.drawRow(t,n),!0)},drawRemainingRows:function(){this.collection.every(this.drawRemainingRowBind),this.onResize()},drawRemainingRow:function(e,t){return t>29&&this.drawRow(e,t),!0},drawRow:function(e,t){var n=this._super(e,t);t==0&&(this.firstRow=n)},getRowClassName:function(e){return e!==0||!this.collection.isActualFirst()?"playlist-media-item":"playlist-media-first-item"},onFirstRowLockCheck:function(){this.firstRow&&(s.get("historyID")&&s.get("playlistID")===o.getVisibleID()?(s.on("change:remaining",this.onRemainingChange,this),this.firstRow.nowPlaying(!0),this.lockFirstItem=!0):(s.off("change:remaining",this.onRemainingChange,this),this.firstRow.nowPlaying(!1),this.lockFirstItem=!1),this.firstRow.actualFirst(this.collection.isActualFirst()))},onRemainingChange:function(){this.firstRow&&this.firstRow.setDuration(s.get("remaining"))},startDrag:function(e){this._super(),this.$el.append(this.$dragRowLine),this.$dragRowLine.show(),this.$el.addClass("drag-over")},resetDrag:function(){this._super(),this.$el.removeClass("drag-over")},onDragUpdate:function(e){this._super(e);var t=this.$el.offset().top,n=this.$el.scrollTop();if(this.currentDragRow){var r=0,i=this.currentDragRow.options.index;if(!this.lockFirstItem||i>0){this.targetDropIndex=i;var s=this.currentDragRow.$el.offset().top;this.mouseY>=s+this.currentDragRow.$el.height()/2?(r=s-t+n+this.currentDragRow.$el.height(),i==this.lastClickedIndex-1?this.targetDropIndex=this.lastClickedIndex:this.targetDropIndex=i+1):(r=s-t+n,i==this.lastClickedIndex+1?this.targetDropIndex=this.lastClickedIndex:this.targetDropIndex=i),this.$dragRowLine.css("top",r)}else i==0&&(r=this.currentDragRow.$el.offset().top-t+n+this.currentDragRow.$el.height(),this.targetDropIndex=1,this.$dragRowLine.css("top",r))}var o=this.onCheckListScroll(this.$el);this.withinBounds?(o>-10&&(!this.lockFirstItem||i>0)&&this.$dragRowLine.css("top",o),this.$dragRowLine.show()):this.$dragRowLine.hide()},onRowRelease:function(e){this.isDragging||this._super(e)},onDocumentRelease:function(e){if(this.withinBounds){var n=this.getSelectedRows();if(n&&n.length>0){var i=this.getRowsAreSequential(n);if(!i||i&&this.targetOutsideRange(this.targetDropIndex,n[0].options.index,n[n.length-1].options.index)){var s=this.beforeMediaID();if(!i||n[0].id!=s)this.scrollLock=!0,t.dispatch(new r(r.MOVE,n,s))}}}this.resetDrag()},beforeMediaID:function(){return this.targetDropIndex>this.collection.length-1?0:this.collection.at(Math.max(this.lockFirstItem?1:0,this.targetDropIndex)).get("id")},getRowsAreSequential:function(e){if(e.length>1){var t=e.length,n=e[0].options.index;for(var r=1;r<t;++r)if(++n!=e[r].options.index)return!1}return!0},targetOutsideRange:function(e,t,n){var r=!1;return e==n+1?r=!1:r=e<t||e>n,r},deleteSelectedRows:function(){var e=this.getSelectedRows();e.length>0&&t.dispatch(new n(n.DELETE,e,e[0].model,e[0].options.index))}});return f}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/c53f8",["underscore","ac785/abf10/e9abd/b19be/bbe20/d2a6f/cf0eb","hbs!template/room/playlist/media/list/PlaylistMediaRow","ac785/f6dac/d17c3","ac785/bc190/cd0b8","ac785/ab6db/e1b12","ac785/ab6db/ffb2a","ac785/ca252/c0f8f"],function(e,t,n,r,i,s,o,u){var a=t.extend({render:function(){var e=this.model.get("media");this.$el.html(n({image:e.image,author:e.author,title:e.title,duration:r.formatTime(e.duration,!1)})).addClass("has-playlists");var t=$('<a href="javascript:void(0)"/>').html($("<span/>").text(this.model.get("playlist").name).html()).data("id",this.model.get("playlist").id).data("media",e.id).click(function(){var e=$(this);u.jumpToMedia(e.data("id"),e.data("media"))});return this.$(".meta").append($("<i/>").addClass("icon icon-playlist-small")).append($("<span/>").addClass("playlists").append(t)),this.update(),this},getAction:function(){return"searchLocal"}});return a}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/c5a43",["jquery","ac785/bc190/cd0b8","ac785/d94e0/ab74a","ac785/ca252/aeeec","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/c53f8","ac785/ca252/a4ec0"],function(e,t,n,r,i,s,o){var u=i.extend({collection:o,RowClass:s,listClass:"search-local",doubleClickRow:function(i){e(document).off("mousemove",this.thresholdBind),this.resetDrag(),this.lastClickedRow=i,t.dispatch(new n(n.PREVIEW,new r(i.model.get("media"))))},getSelectedRows:function(){var e=[],t,n={};for(t in this.selectedRows)n[this.selectedRows[t].model.get("media").cid]||(e.push(this.selectedRows[t]),n[this.selectedRows[t].model.get("media").cid]=!0);return e.sort(this.sortSelectedRows),e},selectMultipleRows:function(e,t){for(var n=e;n>=t;n--)this.selectedRows[this.collection.at(n).get("media").cid]=this.rows[n];this.updateSelectedRows()},updateSelectedRows:function(){var e=this;_.each(this.rows,function(t){t.select(e.selectedRows[t.model.get("media").cid]!=undefined)})},toggleRow:function(e){e.select(!e.options.selected),e.options.selected?this.selectedRows[e.model.get("media").cid]=e:delete this.selectedRows[e.model.get("media").cid]}});return u}),define("ac785/abf10/e9abd/b19be/bbe20/d2a6f/f34dd",["jquery","underscore","ac785/f04be/f1000","ac785/ca252/c3969","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f2065","ac785/abf10/e9abd/b19be/bbe20/d2a6f/dbc83","ac785/abf10/bc8c0/e31ab"],function(e,t,n,r,i,s,o){var u=i.extend({collection:r,RowClass:s,listClass:"search",initialize:function(){this._super(),this.scrollBind=t.bind(this.onScroll,this)},render:function(){return this._super(),this.collection.on("add",this.onCollectionAdd,this).on("update",this.onCollectionUpdate,this),this.$el.on("scroll",this.scrollBind),this.searching=!1,this},remove:function(){this.collection.off("add",this.onCollectionAdd,this).off("update",this.onCollectionUpdate,this),this.$el.off("scroll",this.scrollBind),this.hideRowSpinner(),this.searching=!1,this._super()},onCollectionAdd:function(e,t){this.hideRowSpinner(),this.hideLoadSpinner(),this.drawRow(e,t.indexOf(e))},onCollectionUpdate:function(){this.onResize(),this.hideRowSpinner();var e=this;t.delay(function(){e.searching=!1},500)},onScroll:function(){!this.searching&&this.collection.length<200&&n.lastCount>0&&this.$el.scrollTop()>this.$el[0].scrollHeight-this.$el.height()-2&&(this.searching=!0,n.more()?this.showRowSpinner():this.hideRowSpinner())},showRowSpinner:function(){this.hideRowSpinner(),this.rowSpinner=new o({size:o.SMALL}),this.$loadrow=e("<div/>").addClass("row"),this.$el.append(this.$loadrow),this.$loadrow.append(this.rowSpinner.$el),this.rowSpinner.render().$el.css("left","50%").css("top","40%")},hideRowSpinner:function(){this.rowSpinner&&(this.rowSpinner.remove(),this.rowSpinner=undefined),this.$loadrow&&(this.$loadrow.remove(),this.$loadrow=undefined)}});return u}),define("ac785/abf10/e9abd/b19be/bbe20/d53ce",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/b1cfb","ac785/d94e0/d4a09","ac785/ca252/ef1d8","ac785/ca252/deacc","ac785/ca252/aeeec","ac785/ca252/f4f89","ac785/ca252/c0f8f","ac785/ca252/a99f8","ac785/ca252/c3969","ac785/f6dac/ffe62","ac785/abf10/e9abd/b19be/f4a7e/a9b6e","ac785/abf10/e9abd/b19be/ae12c/b6157","ac785/abf10/e9abd/b19be/bbe20/cacb0/deb9c","ac785/abf10/e9abd/b19be/bbe20/cacb0/d4a01","ac785/abf10/e9abd/b19be/bbe20/cacb0/f275b","ac785/abf10/e9abd/b19be/bbe20/cacb0/c7147","ac785/abf10/e9abd/b19be/bbe20/cacb0/b0965","ac785/abf10/e9abd/b19be/bbe20/cacb0/fb7d7","ac785/abf10/e9abd/b19be/bbe20/cacb0/d07c1","ac785/abf10/e9abd/b19be/bbe20/cacb0/f0fa5","ac785/abf10/e9abd/b19be/bbe20/cacb0/a55f1","ac785/abf10/e9abd/b19be/bbe20/cacb0/a1980","ac785/abf10/e9abd/b19be/bbe20/cacb0/e5b8b","ac785/abf10/e9abd/b19be/bbe20/cacb0/a22ee","ac785/abf10/e9abd/b19be/bbe20/d2a6f/e2765","ac785/abf10/e9abd/b19be/bbe20/d2a6f/dd1f0","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f6295","ac785/abf10/e9abd/b19be/bbe20/d2a6f/de952","ac785/abf10/e9abd/b19be/bbe20/d2a6f/b9ebc","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f733b","ac785/abf10/e9abd/b19be/bbe20/d2a6f/c5a43","ac785/abf10/e9abd/b19be/bbe20/d2a6f/f34dd","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){var j=n.View.extend({id:"media-panel",initialize:function(){this.playlistMedia={header:new x,list:new D},this.searchMedia={header:new N,list:new H},this.searchLocal={header:new T,list:new P},this.searchRelated={header:new C,list:this.searchMedia.list},this.help={header:new k,list:new d},l.on("change:visible",this.onPlaylistVisible,this).on("reset add remove",this.onPlaylistsChange,this),f.on("change:query",this.onSearchMedia,this).on("change:related",this.onSearchRelated,this),o.on("change:query",this.onSearchLocal,this),r.on("help:show",this.onPlaylistHelp,this).on("import:show",this.onImport,this).on("import:ytplaylists",this.onImportYouTubePlaylists,this).on("history:show",this.onRoomHistory,this).on("keycmd:selectall",this.onSelectAllCmd,this).on("keycmd:delete",this.onDeleteCmd,this).on(s.IMPORT,this.onImportYouTubeMedia,this).on(i.SETS,this.onImportSoundCloudSets,this).on(i.TRACKS,this.onImportSoundCloud,this).on(i.FAVORITES,this.onImportSoundCloud,this),this.header=undefined,this.list=undefined},render:function(){this.$el.empty();var e=this;return this.onPlaylistVisible()||t.delay(function(){e.onPlaylistHelp()},1e3),this},onPlaylistVisible:function(){var e=l.find(function(e){return e.get("visible")});return e?(this.playlistMedia.list.clearSelection(),this.show(this.playlistMedia),this.playlistMedia.list.hideLoadSpinner(),r.trigger("filter:show",!0),r.trigger("search:clear"),!0):!1},onPlaylistsChange:function(){l.length==0&&this.onPlaylistHelp()},onSearchMedia:function(e,t){t!=undefined&&this.show(this.searchMedia)&&(l.setVisible(),r.trigger("filter:show",!1))},onSearchLocal:function(){this.show(this.searchLocal)&&(l.setVisible(),r.trigger("filter:show",!1))},onSearchRelated:function(e,t){t!=undefined&&this.show(this.searchRelated)&&(l.setVisible(),r.trigger("filter:show",!1))},onPlaylistHelp:function(){this.show(this.help)&&(this.header.setTitle(B.help.title),l.setVisible(),r.trigger("filter:show",!1))},onImport:function(){this.import||(this.import={header:new g,list:new v}),this.show(this.import)&&(this.header.setTitle(B.import.title),l.setVisible(),r.trigger("filter:show",!1))},onImportYouTubePlaylists:function(e){this.importYouTubePlaylists||(this.importYouTubePlaylists={header:new S,list:new _}),this.show(this.importYouTubePlaylists)&&(this.header.setTitle(e),l.setVisible(),r.trigger("filter:show",!1))},onImportYouTubeMedia:function(e){this.importYouTubeMedia||(this.importYouTubeMedia={header:new E,list:new M}),this.show(this.importYouTubeMedia)&&(this.header.onImport(e.playlist),l.setVisible(),r.trigger("filter:show",!1))},onImportSoundCloudSets:function(){this.importSoundCloudSets||(this.importSoundCloudSets={header:new w,list:new O},this.importSoundCloudSets.list.on("select",this.onImportSoundCloudSetMedia,this)),this.show(this.importSoundCloudSets)&&(l.setVisible(),r.trigger("filter:show",!1))},onImportSoundCloudSetMedia:function(){this.importSoundCloudSetMedia||(this.importSoundCloudSetMedia={header:new b,list:new A},this.importSoundCloudSetMedia.header.on("back",this.onImportSoundCloudSetsBack,this)),this.show(this.importSoundCloudSetMedia)&&(l.setVisible(),r.trigger("filter:show",!1))},onImportSoundCloudSetsBack:function(){this.onImportSoundCloudSets(),this.importSoundCloudSets.list.hideLoadSpinner()},onImportSoundCloud:function(e){this.importSoundCloud||(this.importSoundCloud={header:new y,list:this.searchMedia.list}),this.show(this.importSoundCloud)&&(l.setVisible(),this.importSoundCloud.header.setTitle(e.type==i.TRACKS?B.import.tracks:B.import.favorites),r.trigger("filter:show",!1))},onRoomHistory:function(){this.history||(this.history={header:new m,list:new L}),this.show(this.history)&&(l.setVisible(),r.trigger("filter:show",!0))},onSelectAllCmd:function(){this.list&&this.list.selectAll()},onDeleteCmd:function(){this.list==this.playlistMedia.list&&this.list.deleteSelectedRows()},show:function(e){return this.header!=e.header||this.list!=e.list?(this.header&&this.header.remove(),this.list&&this.list.remove(),this.header=e.header,this.list=e.list,this.$el.empty().append(this.header.$el).append(this.list.$el),this.header.render(),this.list.render(),e!=this.searchMedia&&r.trigger("search:clear"),!0):!1}});return j}),define("hbs!template/room/playlist/search/SearchMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="bar-divider"></div>\n<div class="selected">\n    <i id="search-menu-icon" class="icon icon-youtube"></i>\n    <i class="icon icon-menu-arrow"></i>\n    <span></span>\n</div>\n<div class="menu">\n    <ul>\n        <li class="youtube">\n            <i class="icon icon-youtube"></i>\n        </li>\n        <li class="soundcloud">\n            <i class="icon icon-soundcloud"></i>\n        </li>\n        <li class="playlists">\n            <i class="icon icon-playlist-small"></i>\n            <span>'+a((o=(o=t.search,o==null||o===!1?o:o.menuPlaylists),typeof o===u?o.apply(t):o))+"</span>\n        </li>\n    </ul>\n</div>",s});return t.registerPartial("template_room_playlist_search_SearchMenu",n),n}),define("ac785/abf10/e9abd/b19be/e946d/d2ced",["jquery","underscore","backbone","hbs!template/room/playlist/search/SearchMenu","lang/Lang"],function(e,t,n,r,i){var s=n.View.extend({id:"search-menu",initialize:function(){this.format="1",this.ytBind=t.bind(this.onYouTubeClick,this),this.scBind=t.bind(this.onSoundCloudClick,this),this.plBind=t.bind(this.onPlaylistsClick,this)},render:function(){return this.$el.html(r(i)),this.$(".youtube").click(this.ytBind),this.$(".soundcloud").click(this.scBind),this.$(".playlists").click(this.plBind),this.update(),this},update:function(n){this.$("li").removeClass("last"),this.format=="1"?(this.$("ul").children().not(".youtube").show(),this.$(".youtube").hide(),this.$(".playlists").addClass("last"),this.$("#search-menu-icon").removeClass().addClass("icon icon-youtube"),this.$(".selected span").text("")):this.format=="2"?(this.$("ul").children().not(".soundcloud").show(),this.$(".soundcloud").hide(),this.$(".playlists").addClass("last"),this.$("#search-menu-icon").removeClass().addClass("icon icon-soundcloud"),this.$(".selected span").text("")):this.format=="0"&&(this.$("ul").children().not(".playlists").show(),this.$(".playlists").hide(),this.$(".soundcloud").addClass("last"),this.$("#search-menu-icon").removeClass().addClass("icon icon-playlist-small"),this.$(".selected span").text(i.search.menuPlaylists)),e("#search-menu").hide(),t.defer(function(){e("#search-menu").show()}),n||this.trigger("select",this.format)},onYouTubeClick:function(){this.format="1",this.update()},onSoundCloudClick:function(){this.format="2",this.update()},onPlaylistsClick:function(){this.format="0",this.update()}});return s}),define("ac785/e734f/a93fe/fbad3",["jquery-jsonp","underscore","ac785/bc190/b96e1","ac785/ca252/fae6c"],function(e,t,n,r){var i=n.extend({init:function(){this.callback=undefined},load:function(n){var i="http://clients1.google.com/complete/search?client=youtube&hl="+r.get("language")+"&ds=yt&cp=3&gs_id=d&q="+encodeURIComponent(n)+"&callback=?";e.jsonp({url:i,success:t.bind(this.onComplete,this),error:t.bind(this.onError,this)})},onComplete:function(e){var t=e[1].length,n=[];for(var r=0;r<t;++r)n.push(e[1][r][0]);this.callback(n)},onError:function(e,t){console.log("YouTube Suggest Error"),console.log(e,t),this.callback([])}});return i}),define("ac785/abf10/e9abd/b19be/e946d/ba188",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/e734f/a93fe/fbad3"],function(e,t,n,r,i){var s=n.View.extend({id:"search-suggestion",initialize:function(){this.query="",this.ytSuggestService=new i,this.ytSuggestService.callback=t.bind(this.onSuggestUpdate,this),this.documentClickBind=t.bind(this.onDocumentClick,this),this.suggestBind=t.bind(this.onSuggestTimeout,this),this.suggestIndex=-1,this.suggestTimeoutID=-1,this.suggestHideTimeoutID=-1,this.submitPending=!1,r.on("suggestions:hide",this.hideSuggestions,this)},render:function(){this.$el.empty()},clear:function(e){this.query="",this.submitPending=e,this.onSuggestUpdate(),clearTimeout(this.suggestTimeoutID)},onUpDown:function(t){t?++this.suggestIndex:--this.suggestIndex,this.suggestIndex==-2?this.suggestIndex=this.suggestions.length-1:this.suggestIndex==this.suggestions.length&&(this.suggestIndex=-1);var n=this.suggestIndex,r=this;e(".search-suggestion-item").each(function(t){t==n?(e(this).addClass("selected"),r.trigger("select",e(this).data("value"))):e(this).removeClass("selected")})},setQuery:function(e){this.query=e,this.suggestTimeoutID>-1&&clearTimeout(this.suggestTimeoutID),e!=""?this.suggestTimeoutID=setTimeout(this.suggestBind,100):this.onSuggestUpdate()},onSuggestTimeout:function(){clearTimeout(this.suggestTimeoutID),this.query.length>0?this.ytSuggestService.load(this.query):this.onSuggestUpdate([])},onSuggestUpdate:function(n){this.suggestIndex=-1;if(n&&n.length>0&&!this.submitPending){this.suggestions=n;var r=e("<ul/>"),i=n.length;for(var s=0;s<i;++s){var o=e("<li/>").addClass("search-suggestion-item").data("value",n[s]).data("index",s).append(e('<span class="query"/>').html(this.query+'<span class="bold">'+n[s].substr(this.query.length)+"</span>"));r.append(o)}this.$el.html(r),r.height(i*30-15),this.$el.show(),e(".search-suggestion-item").on("click",t.bind(this.onSuggestionClick,this)).on("mouseenter",t.bind(this.onSuggestionOver,this)).on("mouseleave",t.bind(this.onSuggestionOut,this)),e(document).on("mousedown",this.documentClickBind)}else this.hideSuggestions()},onSuggestionClick:function(t){this.trigger("submit",e(t.currentTarget).data("value"))},onSuggestionOver:function(t){this.suggestIndex=e(t.currentTarget).data("index");var n=this.suggestIndex;e(".search-suggestion-item").each(function(t){t==n?e(this).addClass("selected"):e(this).removeClass("selected")})},onSuggestionOut:function(t){e(t.currentTarget).removeClass("selected")},onDocumentClick:function(e){this.$el.is(":visible")&&(clearTimeout(this.suggestHideTimeoutID),this.suggestHideTimeoutID=t.delay(t.bind(this.hideSuggestions,this),150))},hideSuggestions:function(){this.suggestIndex=-1,this.suggestions=[],clearTimeout(this.suggestHideTimeoutID),this.$el.is(":visible")&&this.$el.html("").hide(),e(document).off("mousedown",this.documentClickBind)}});return s}),define("hbs!template/room/playlist/search/Search",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div id="search-bar">\n    <i class="icon icon-search"></i>\n    <div id="search-input">\n        <form class="search-form" onsubmit="return false">\n            <input id="search-input-field" type="text" value="" placeholder="'+a((o=(o=t.search,o==null||o===!1?o:o.youTube),typeof o===u?o.apply(t):o))+'" maxlength="64"/>\n        </form>\n    </div>\n    <div id="clear-search">\n        <i class="icon icon-clear-input"></i>\n    </div>\n</div>\n<div id="filter">\n    <span class="filter-or">'+a((o=(o=t.search,o==null||o===!1?o:o.or),typeof o===u?o.apply(t):o))+'</span>\n    <div id="filter-bar">\n        <i class="icon icon-filter"></i>\n        <div id="filter-input">\n            <form class="filter-form" onsubmit="return false">\n                <input id="filter-input-field" type="text" value="" placeholder="'+a((o=(o=t.search,o==null||o===!1?o:o.filter),typeof o===u?o.apply(t):o))+'" maxlength="8"/>\n            </form>\n        </div>\n        <div id="clear-filter">\n            <i class="icon icon-clear-input"></i>\n        </div>\n    </div>\n</div>',s});return t.registerPartial("template_room_playlist_search_Search",n),n}),define("ac785/abf10/e9abd/b19be/e946d/c8735",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/f04be/f1000","ac785/ca252/bc4cb","ac785/ca252/ea4a8","ac785/ca252/ef1d8","ac785/abf10/e9abd/b19be/e946d/d2ced","ac785/abf10/e9abd/b19be/e946d/ba188","ac785/f6dac/ffe62","ac785/f6dac/aa843","ac785/f6dac/d17c3","hbs!template/room/playlist/search/Search","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=t.View.extend({id:"search",initialize:function(){this.isFilter=!0,this.menu=new a,this.menu.on("select",this.onFormatSelect,this),this.suggest=new f,this.suggest.on("select",this.onSuggestSelect,this).on("submit",this.onSuggestSubmit,this)},render:function(){return this.$el.html(p(d)),$("#playlist-panel").append(this.suggest.$el).append(this.menu.$el),this.suggest.render(),this.$bar=this.$("#search-bar"),this.$filter=this.$("#filter"),this.$searchInput=this.$("#search-input-field").keyup(e.bind(this.onSearchKeyUp,this)).focus(e.bind(this.onSearchFocus,this)).blur(e.bind(this.onSearchBlur,this)),this.searchInput=this.$searchInput[0],this.$clearSearch=this.$("#clear-search").click(e.bind(this.onClearSearchClick,this)),this.$filterInput=this.$("#filter-input-field").keyup(e.bind(this.onFilterKeyUp,this)).focus(e.bind(this.onFilterFocus,this)).blur(e.bind(this.onFilterBlur,this)),this.filterInput=this.$filterInput[0],this.$clearFilter=this.$("#clear-filter").click(e.bind(this.onClearFilterClick,this)),n.on("filter:show",this.onShowFilter,this),l.resize(e.bind(this.onResize,this)),this.menu.render(),n.on("search:clear",this.clearSearch,this),this},onResize:function(e){e=e||l.getSize(),this.$el.width(e.availWidth-e.barHeight-9);var t=this.$el.width()-parseInt(this.$bar.css("left"))*3-this.$filter.width();this.isFilter?(t=this.$el.width()-parseInt(this.$bar.css("left"))*3-this.$filter.width(),this.$filter.css("right",0)):(t=this.$el.width()-parseInt(this.$bar.css("left"))*3,this.$filter.css("right",-this.$filter.width())),this.$bar.width(t),this.menu.$el.css("left",t-this.menu.$el.width()+e.barHeight),this.$("#search-input").width(t-this.menu.$el.width()-e.barHeight),this.suggest.$el.width(this.menu.$el.offset().left-59)},onShowFilter:function(e){this.isFilter=e,this.clearFilter();var t=l.getSize(),n;e?(this.$filter.animate({right:0},350,"easeInOutExpo"),n=this.$el.width()-parseInt(this.$bar.css("left"))*3-this.$filter.width()):(this.$filter.animate({right:-this.$filter.width()},350,"easeInOutExpo"),n=this.$el.width()-parseInt(this.$bar.css("left"))*3),this.$bar.animate({width:n},350,"easeInOutExpo"),this.menu.$el.animate({left:n-this.menu.$el.width()+t.barHeight},350,"easeInOutExpo"),this.$("#search-input").animate({width:n-this.menu.$el.width()-t.barHeight},350,"easeInOutExpo")},onFormatSelect:function(e){if(e=="2"&&!c.sc){n.trigger("notify","icon-chat-system",d.alerts.soundcloudUnavailable);return}this.updateSearchPlaceholder(),this.searchInput.value="",this.$clearSearch.hide(),this.suggest.clear(!0)},updateSearchPlaceholder:function(){this.menu.format=="1"?this.searchInput.placeholder=d.search.youtube:this.menu.format=="2"?this.searchInput.placeholder=d.search.soundcloud:this.menu.format=="0"&&(this.searchInput.placeholder=d.search.playlists)},clearSearch:function(){this.searchInput.value="",this.$clearSearch.hide()},onClearSearchClick:function(e){this.searchInput.value="",this.suggest.clear(),this.$clearSearch.hide(),this.menu.format=="0"&&u.set("query","")},onSearchKeyUp:function(e){var t;if(!e)return!0;t=e.which||e.keyCode;if(this.menu.format!="0"){this.suggest.submitPending=!1;if(t==40||t==38)return this.suggest.onUpDown(t==40),this.suggest.suggestIndex==-1&&(this.searchInput.value=this.suggest.query),this.searchInput.setSelectionRange(this.searchInput.value.length,this.searchInput.value.length),this.searchInput.value.length==0?this.$clearSearch.hide():this.$clearSearch.show(),!1;if(t!=27)return t==13&&this.searchInput.value!=""?(e.preventDefault(),this.onSubmitSearch(),!1):(this.suggest.setQuery(this.searchInput.value),this.searchInput.value.length==0?this.$clearSearch.hide():this.$clearSearch.show(),!1);this.searchInput.value="",this.suggest.clear(),this.$clearSearch.hide()}else{if(t!=27)return t==13&&this.searchInput.value!=""?(e.preventDefault(),this.menu.format="1",this.menu.update(!0),this.updateSearchPlaceholder(),this.onSubmitSearch(),!1):(this.suggest.query=this.searchInput.value,this.searchInput.value.length==0?this.$clearSearch.hide():this.$clearSearch.show(),u.set("query",this.suggest.query.toLowerCase()),!1);this.searchInput.value="",this.suggest.clear(),this.$clearSearch.hide(),this.suggest.onSuggestUpdate(),this.suggest.$el.width(this.menu.$el.offset().left-59)}return this.searchInput.value.length==0?this.$clearSearch.hide():this.$clearSearch.show(),!0},onSubmitSearch:function(){var e=this.searchInput.value;if(e.indexOf("http")==0){var t=h.validateIncomingURL(e);t&&(e=t)}this.suggest.submitPending=!0,this.suggest.onSuggestUpdate(null),this.menu.format=="0"&&(this.menu.format="1",this.menu.update(!0),this.updateSearchPlaceholder()),i.load(e,this.menu.format)},onSearchFocus:function(e){this.searchInput.placeholder=""},onSearchBlur:function(e){this.updateSearchPlaceholder()},onSuggestSelect:function(e){this.searchInput.value=e},onSuggestSubmit:function(e){this.searchInput.value=e,this.onSubmitSearch()},clearFilter:function(){return this.filterInput.value="",this.$clearFilter.hide(),this},onClearFilterClick:function(){this.clearFilter(),o.setFilter("")},onFilterFocus:function(){this.filterInput.placeholder=""},onFilterBlur:function(){this.filterInput.placeholder=d.search.filter},onFilterKeyUp:function(e){var t;return e?(t=e.which||e.keyCode,t==27&&(this.filterInput.value=""),$("#room-history").hasClass("selected")?s.setFilter(this.filterInput.value.toLowerCase()):o.setFilter(this.filterInput.value.toLowerCase()),this.filterInput.value.length>0?this.$clearFilter.show():this.$clearFilter.hide(),!0):!0}});return v}),define("ac785/abf10/e9abd/b19be/c3276",["underscore","backbone","ac785/abf10/e9abd/b19be/bbe20/d53ce","ac785/abf10/e9abd/b19be/fbb07/b8ba1","ac785/abf10/e9abd/b19be/e946d/c8735"],function(e,t,n,r,i){var s=t.View.extend({id:"playlist-panel",initialize:function(){this.search=new i,this.media=new n},render:function(){return this.$el.append(this.search.$el).append(r.$el).append(this.media.$el),this.search.render(),r.render(),this.media.render(),this}});return s}),define("hbs!template/room/footer/PlaylistMeta",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div id="playlist-button">\n    <i class="icon icon-playlist"></i>\n</div>\n<div id="playlist-bar" class="bar-button">\n    <i class="icon icon-next-track"></i>\n    <div id="next-media-title">\n        <span class="bar-value"></span>\n    </div>\n    <div id="next-media-label">\n        <span class="dark-label"></span>\n    </div>\n</div>'});return t.registerPartial("template_room_footer_PlaylistMeta",n),n}),define("ac785/abf10/e9abd/abc95/f353b",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/deacc","ac785/ca252/ec425","ac785/ca252/c0f8f","ac785/ab6db/ca525","ac785/abf10/d9a0c/f324c","ac785/abf10/e9abd/abc95/d438f","ac785/abf10/e9abd/abc95/a8bd5","ac785/abf10/e9abd/b19be/c3276","ac785/f6dac/abcc8","ac785/f6dac/ffe62","hbs!template/room/footer/PlaylistMeta","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b=n.View.extend({id:"playlist-meta",className:"left-meta",initialize:function(){this.playlist=new d,this.twitter=new p,this.facebook=new h,this.keyDownBind=t.bind(this.onKeyDown,this),this.keyUpBind=t.bind(this.onKeyUp,this),this.ctrlDown=!1},render:function(){return this.$el.html(g(y)).append(this.playlist.$el).append(this.twitter.$el).append(this.facebook.$el),this.twitter.render(),this.facebook.render(),this.playlist.render(),this.$("#playlist-button").click(t.bind(this.onIconClick,this)),this.$icon=this.$("#playlist-button .icon"),this.$bar=this.$("#playlist-bar").click(t.bind(this.onBarClick,this)),this.$media=this.$("#next-media-title .bar-value"),this.$label=this.$("#next-media-label .dark-label"),this.$nextTitle=this.$("#next-media-title"),this.$nextLabel=this.$("#next-media-label"),o.on("update",this.onChange,this),f.on("reset change:selected change:items",this.onChange,this),u.on("change:author change:title",this.onChange,this),a.on("change:media",this.onChange,this),this.onChange(),m.resize(t.bind(this.onResize,this)),r.on("lobby:show",this.onLobbyShow,this).on("playlist:first",this.onPlaylistFirst,this).on("playlist:open",this.onPlaylistOpen,this),this},onResize:function(e){this.$nextTitle.width(e.barWidth-this.facebook.$el.width()-this.$nextTitle.offset().left-10),this.$nextLabel.width(e.barWidth-this.facebook.$el.width()-this.$nextLabel.offset().left-10),this.playlist.$el.width(e.availWidth-10).is(":visible")&&parseInt(this.$el.css("top"))!=0&&(this.$el.css("top",-(e.height-m.PLAYLIST_OFFSET)),this.playlist.$el.height(e.height-m.PLAYLIST_OFFSET+e.barHeight),this.$bar.width(e.barWidth-this.facebook.$el.width()-this.$bar.offset().left-10))},onIconClick:function(){if(this.playlist.$el.is(":visible")){this.$icon.removeClass().addClass("icon icon-playlist"),this.playlist.$el.show().animate({height:e("#header").height()},{duration:250,easing:"easeInOutExpo",progress:function(){r.trigger("anim:playlist:progress",m.getSize())}}),this.$el.animate({top:0},250,"easeInOutExpo");var t=this;setTimeout(function(){e("#playlist-panel").hide(),e("#playlist-bar").show(),e(".social-menu").show(),t.onResize(m.getSize())},250),e(document).off("keydown",this.keyDownBind).off("keyup",this.keyUpBind),r.trigger("audience:pause",!1)}else this.onBarClick()},onBarClick:function(){e("#playlist-panel").show(),this.$icon.removeClass().addClass("icon icon-playlist-close"),m.onResize(),r.trigger("lobby:hide"),t.delay(t.bind(this.animateUp,this),10)},onLobbyShow:function(){this.playlist.$el.is(":visible")&&this.onIconClick()},onPlaylistFirst:function(){this.onPlaylistOpen(),t.delay(function(){r.dispatch(new i(i.SHOW,new c({media:undefined})))},250)},onPlaylistOpen:function(){this.playlist.$el.is(":visible")||this.onBarClick()},animateUp:function(){var t=Math.max(m.MIN_HEIGHT,e(window).height());e("#playlist-panel").animate({height:t-m.PLAYLIST_OFFSET+e("#header").height()},{duration:350,easing:"easeInOutExpo",progress:function(){r.trigger("anim:playlist:progress",m.getSize())}}),this.$el.animate({top:-(t-m.PLAYLIST_OFFSET)},350,"easeInOutExpo"),e("#playlist-bar").hide(),e(".social-menu").hide(),e(document).on("keydown",this.keyDownBind).on("keyup",this.keyUpBind),r.trigger("audience:pause",!0)},onChange:function(){var e=f.getSelectedID(),t;if(e){var n=l.firstMedia(e),r;s.isTheUserPlaying&&a.get("playlistID")==e&&n.length==2?r=u.get(n[1]):n.length>0&&(r=u.get(n[0])),r&&(t=r.get("author")+" - "+r.get("title"))}t?(this.$label.text(y.footer.yourNextTurn),this.$media.text(t)):(this.$label.text(y.footer.cannotPlay),this.$media.text(y.footer.clickToMake))},onKeyDown:function(t){if(!m.currentDialog&&e(document.activeElement)[0].nodeName=="BODY"){var n;t&&(n=t.which||t.keyCode);if(n==17||v.isMac&&(n==91||n==93||n==224))this.ctrlDown=!0;else{if(this.ctrlDown&&n==65)return t.preventDefault(),t.stopImmediatePropagation(),r.trigger("keycmd:selectall"),!1;if(!this.ctrlDown&&(n==8||n==46))return t.preventDefault(),t.stopImmediatePropagation(),r.trigger("keycmd:delete"),!1}}return!0},onKeyUp:function(e){var t;e&&(t=e.which||e.keyCode);if(t==17||v.isMac&&(t==91||t==93||t==224))this.ctrlDown=!1;else if(!this.ctrlDown&&(t==8||t==46))return e.preventDefault(),!1;return!0}});return b}),define("ac785/e734f/ea1d8/f2810",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.displayName=e,this._super(!0)},execute:function(){this.displayName.length>1?t.execute("user.name_available",this,this.displayName):this.parse({status:5})},parse:function(e){this.successCallback(e.status==0)}});return n}),define("ac785/abf10/d9a0c/faba8",["underscore","ac785/d94e0/c7cab","ac785/d94e0/ac2bb","ac785/f04be/c8b95","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/ea1d8/f2810","ac785/f6dac/d17c3","ac785/abf10/d9a0c/fbb95","ac785/abf10/bc8c0/e31ab","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l){var c=a.extend({id:"dialog-user-profile",className:"dialog",initialize:function(){this._super(),this.checkBind=e.bind(this.checkAvailability,this),this.responseBind=e.bind(this.onAvailabilityResponse,this)},render:function(){var t=[].concat(s.STATUSES);return--t.length,this.$el.append(this.getHeader(l.dialog.userProfile)).append(this.getBody().append(this.getInputField("name",l.dialog.name,l.dialog.displayName,i.get("username"),24)).append($("<span/>").attr("id","username-availability").text(l.setup.available)).append(this.getMenu(l.dialog.userStatus,"userstatus",t,s.STATUSES[Math.max(i.get("status"),0)])).append($("<div/>").addClass("divider")).append(this.getLanguageMenu())).append(this.getButtons(l.dialog.save,!0)),this.nameAvailable=!0,e.defer(e.bind(this.deferFocus,this)),this._super()},deferFocus:function(){var e=this.$el.find("input");e.focus(),e[0].selectionStart=e[0].selectionEnd=e[0].value.length},submit:function(){if(this.nameAvailable){var e=this.nameAvailable?$("#dialog-user-profile").find("input")[0].value:i.get("username"),t=Math.max(0,s.STATUSES.indexOf($("#dialog-menu-userstatus").val())),r=$("#dialog-menu-language").val();this.dispatch(new n(n.UPDATE,e,t,r)),this.close()}},onKeyCustom:function(t){this.availableTimeoutID&&clearTimeout(this.availableTimeoutID),this.availableTimeoutID=e.delay(this.checkBind,500);var n=$("#dialog-user-profile").find("input")[0].value;this.nameAvailable=n==i.get("username"),this.nameAvailable?($("#username-availability").text(l.setup.available),this.$el.removeClass("unavailable"),this.hideSpinner()):(this.$el.addClass("unavailable"),u.isValidUsername(n)?($("#username-availability").text(""),this.spinner||this.showSpinner()):(n.length<3?$("#username-availability").text(l.setup.tooShort):$("#username-availability").text(l.setup.invalid),this.hideSpinner()))},checkAvailability:function(){clearTimeout(this.availableTimeoutID);var e=$("#dialog-user-profile").find("input")[0].value;if(e!=this.lastUsername){this.lastUsername=e;if(e==i.get("username"))$("#username-availability").text(l.setup.available),this.$el.removeClass("unavailable"),this.nameAvailable=!0,this.hideSpinner();else if(u.isValidUsername(e)){$("#username-availability").text("");var t=new o(e);t.successCallback=this.responseBind}else this.hideSpinner(),this.$el.addClass("unavailable"),e.length<3?$("#username-availability").text(l.setup.tooShort):$("#username-availability").text(l.setup.invalid)}else this.lastUsername==i.get("username")&&($("#username-availability").text(l.setup.available),this.$el.removeClass("unavailable"),this.nameAvailable=!0,this.hideSpinner())},onAvailabilityResponse:function(e){this.hideSpinner(),e?($("#username-availability").text(l.setup.available),this.$el.removeClass("unavailable")):($("#username-availability").text(l.setup.unavailable),this.$el.addClass("unavailable")),this.nameAvailable=e},showSpinner:function(){this.hideSpinner(),this.spinner=new f({size:f.SMALL}),this.$el.append(this.spinner.$el),this.spinner.render().$el.css("right",31).css("top",140).css("z-index",9999)},hideSpinner:function(){this.spinner&&(this.spinner.remove(),this.spinner=undefined)},close:function(){this.hideSpinner(),this.availableTimeoutID&&clearTimeout(this.availableTimeoutID),this.availableTimeoutID=undefined,this.checkBind=undefined,this.responseBind=undefined,this.nameAvailable=undefined,this._super()},getLanguageMenu:function(){var e="en",t=$("<select disabled/>").attr("id","dialog-menu-language"),n=$("<optgroup/>").attr("label",l.dialog.userInterface),i=r.uiLanguages.length,s;for(s=0;s<i;++s)e==r.uiLanguages[s].value?n.append($('<option selected="selected" value="'+r.uiLanguages[s].value+'">'+r.uiLanguages[s].label+"</option>")):n.append($('<option value="'+r.uiLanguages[s].value+'">'+r.uiLanguages[s].label+"</option>"));return t.append(n),$("<div/>").addClass("dialog-menu-container-language").addClass("dialog-menu-container").append($("<label/>").attr("for","dialog-menu-language").text(l.dialog.language)).append(t)}});return c}),define("hbs!template/room/footer/UserMeta",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="bar-divider"></div>\n<div class="avatar-thumb">\n    <div class="avitmb"></div>\n</div>\n<div class="username">\n    <span></span>\n</div>\n<div class="points">\n    <i class="icon icon-meta-points"></i>\n    <span class="value"></span>\n    <span class="label">'+a((o=(o=t.userPanel,o==null||o===!1?o:o.points),typeof o===u?o.apply(t):o))+'</span>\n</div>\n<div class="fans">\n    <i class="icon icon-meta-fans"></i>\n    <span class="value"></span>\n    <span class="label">'+a((o=(o=t.userPanel,o==null||o===!1?o:o.fans),typeof o===u?o.apply(t):o))+'</span>\n</div>\n<div class="hit"></div>\n<div id="store-button">\n    <i class="icon icon-store"></i>\n</div>',s});return t.registerPartial("template_room_footer_UserMeta",n),n}),define("ac785/abf10/e9abd/abc95/e30f6",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/ca252/d83c7","ac785/ca252/f89d8","ac785/ca252/fae6c","ac785/f6dac/d17c3","ac785/abf10/d9a0c/faba8","hbs!template/room/footer/UserMeta","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({id:"user-meta",className:"right-meta",render:function(){return this.avatarInterval=0,this.$el.html(l(c)),this.$avatar=this.$(".avitmb"),this.$name=this.$(".username span"),this.$points=this.$(".points .value"),this.$fans=this.$(".fans .value"),this.$hit=this.$(".hit").click(t.bind(this.onHitClick,this)).on("mouseenter",t.bind(this.onHitEnter,this)).on("mouseleave",t.bind(this.onHideTooltip,this)),this.$store=this.$("#store-button").click(t.bind(this.onStoreClick,this)).on("mouseenter",t.bind(this.onStoreEnter,this)).on("mouseleave",t.bind(this.onHideTooltip,this)),u.on("change:username change:status",this.onUsernameChange,this).on("change:avatarID",this.onAvatarChange,this).on("change:fans",this.onFansChange,this).on("change:djPoints change:listenerPoints change:curatorPoints",this.onPointsChange,this),s.on("change",this.onPointsChange,this),this.storeOpen=!1,this.onPointsChange(),this.onFansChange(),this},onUsernameChange:function(){this.$name.text(u.get("username"))},onAvatarChange:function(e,t){this.$avatar.removeClass().addClass("avitmb avitmb-"+t)},onFansChange:function(){this.$fans.text(a.commafy(u.get("fans")))},onPointsChange:function(){var e=u.getTotalPoints();u.get("id")==o.currentDJ?e+=s.djPoints+s.curatePoints:isNaN(s.listenerPoints[u.get("id")])||(e+=s.listenerPoints[u.get("id")]),this.$points.text(a.commafy(e))},onHitClick:function(){r.dispatch(new i(i.SHOW,new f))},onStoreClick:function(){this.storeOpen?(r.trigger("store:hide"),this.$store.empty().removeClass("back").append(e("<i/>").addClass("icon icon-store"))):(r.trigger("settings:hide").trigger("store:show"),this.$store.empty().addClass("back").append(e("<i/>").addClass("icon icon-back")).append(e("<span/>").text(c.store.close)),this.onHideTooltip()),this.storeOpen=!this.storeOpen},onHitEnter:function(){r.trigger("tooltip:show",c.tooltips.profile,this.$hit,!0)},onStoreEnter:function(){this.$store.hasClass("back")||r.trigger("tooltip:show",c.tooltips.store,this.$store,!0)},onHideTooltip:function(){r.trigger("tooltip:hide")}});return h}),define("ac785/abf10/e9abd/abc95/fbf80",["jquery","backbone","ac785/bc190/cd0b8","ac785/abf10/e9abd/abc95/f353b","ac785/abf10/e9abd/abc95/e30f6"],function(e,t,n,r,i){var s=t.View.extend({id:"footer",className:"avail-width",initialize:function(){this.playlist=new r,this.user=new i,n.on("room:joined",this.draw,this)},render:function(){return this.$el.empty().append(this.playlist.$el).append(this.user.$el),this.playlist.render(),this.user.render(),this},draw:function(){n.off("room:joined",this.draw,this),e("head").append('<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>').append('<script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s); js.id = id;js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=216041638480603";fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));(function(d,s,id) {var js,fjs=d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s);js.id = id;js.src = "//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}(document,"script","twitter-wjs"));</script>')}});return s}),define("hbs!template/room/header/PlugMenu",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-plug-dj"></i>\n<div id="plug-menu">\n    <div class="item room-list clickable">\n        <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.roomList),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item settings clickable">\n        <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.settings),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <a href="http://support.plug.dj" target="_blank">\n        <div class="item support">\n            <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.support),typeof o===u?o.apply(t):o))+'</span>\n        </div>\n    </a>\n    <a href="http://plug.dj/about" target="_blank">\n        <div class="item about">\n            <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.about),typeof o===u?o.apply(t):o))+'</span>\n        </div>\n    </a>\n    <a href="http://blog.plug.dj" target="_blank">\n        <div class="item blog">\n            <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.blog),typeof o===u?o.apply(t):o))+'</span>\n        </div>\n    </a>\n    <a href="http://support.plug.dj/entries/30455216-Documentation" target="_blank">\n        <div class="item api">\n            <span>'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.api),typeof o===u?o.apply(t):o))+'</span>\n        </div>\n    </a>\n    <div class="legal">\n        <span class="terms"><a href="/terms" target="_blank">'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.terms),typeof o===u?o.apply(t):o))+'</a></span>\n        <span class="privacy"><a href="/privacy" target="_blank">'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.privacy),typeof o===u?o.apply(t):o))+'</a></span>\n        <span class="privacy"><a href="/logout" target="_self">'+a((o=(o=t.plugMenu,o==null||o===!1?o:o.logout),typeof o===u?o.apply(t):o))+"</a></span>\n    </div>\n</div>",s});return t.registerPartial("template_room_header_PlugMenu",n),n}),define("ac785/abf10/e9abd/feb9f/fc918",["jquery","underscore","backbone","ac785/bc190/cd0b8","hbs!template/room/header/PlugMenu","lang/Lang"],function(e,t,n,r,i,s){var o=n.View.extend({id:"plug-dj",initialize:function(){this.itemBind=t.bind(this.onItemClick,this),this.documentBind=t.bind(this.onDocumentClick,this),this.showing=!1},render:function(){return this.$el.html(i(s)),this.$el.on("mousedown",t.bind(this.onButtonClick,this)),this.$menu=this.$("#plug-menu").remove(),this},onButtonClick:function(){this.showing?this.hide():this.show()},show:function(){this.showing=!0,r.trigger("settings:hide").trigger("playback:block"),e("body").append(this.$menu),e("#plug-menu .clickable").on("mousedown",this.itemBind);var n=this;t.defer(function(){e(document).on("mousedown",n.documentBind)})},hide:function(){this.showing=!1,e(document).off("mousedown",this.documentBind),e("#plug-menu .item").off("mousedown",this.itemBind),r.trigger("playback:unblock"),this.$menu.remove()},onItemClick:function(t){var n=e(t.target);n.is("span")&&(n=n.parent()),n.hasClass("room-list")?r.trigger("lobby:show"):n.hasClass("settings")&&r.trigger("settings:show")},onDocumentClick:function(n){var r=e(n.target);r.is("span")&&(r=r.parent());if(!r.is("a")&&!r.hasClass("item"))this.hide();else{var i=this;t.delay(function(){i.hide()},250)}}});return o}),define("hbs!template/room/header/RoomBar",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-room"></i>\n<div id="room-name">\n    <span class="bar-value"></span>\n</div>\n<div id="room-host">\n    <span class="dark-label">'+a((o=(o=t.header,o==null||o===!1?o:o.hostedBy),typeof o===u?o.apply(t):o))+': </span><span class="username"></span>\n</div>',s});return t.registerPartial("template_room_header_RoomBar",n),n}),define("ac785/abf10/e9abd/feb9f/c4b77",["underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/c512b","ac785/f6dac/ffe62","hbs!template/room/header/RoomBar","lang/Lang"],function(e,t,n,r,i,s,o){var u=t.View.extend({id:"room-bar",className:"bar-button",render:function(){return this.$el.html(s(o)).click(e.bind(this.onClick,this)),this.$room=this.$("#room-name span"),this.$host=this.$("#room-host .username"),r.on("change:name",this.onNameChange,this).on("change:ownerName",this.onHostChange,this),i.resize(e.bind(this.onResize,this)),this},onClick:function(){n.trigger("roomInfo:show")},onNameChange:function(){this.$room.text(r.get("name"))},onHostChange:function(){this.$host.text(r.get("ownerName"))},onResize:function(e){var t=Math.min(e.barWidth-452,392);this.$el.width(t),this.$("#room-name").width(t-$("#room-name").offset().left-10)}});return u}),define("hbs!template/room/header/NowPlayingBar",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="bar-divider"></div>\n<i class="icon icon-current-dj"></i>\n<div id="now-playing-media">\n    <span class="bar-value"></span>\n</div>\n<div id="now-playing-dj">\n    <span class="dark-label">'+a((o=(o=t.header,o==null||o===!1?o:o.currentDJ),typeof o===u?o.apply(t):o))+': </span><span class="username"></span>\n</div>\n<div id="now-playing-time">\n    <i class="icon icon-time"></i>\n    <span></span>\n</div>',s});return t.registerPartial("template_room_header_NowPlayingBar",n),n}),define("ac785/abf10/e9abd/feb9f/abedb",["underscore","backbone","ac785/ca252/f89d8","ac785/ca252/ec425","ac785/f6dac/ffe62","ac785/f6dac/d17c3","ac785/abf10/e9abd/ec35c/c28fa","hbs!template/room/header/NowPlayingBar","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.View.extend({id:"now-playing-bar",render:function(){return this.$el.html(u(a)),this.$media=this.$("#now-playing-media .bar-value"),this.$dj=this.$("#now-playing-dj .username"),this.$time=this.$("#now-playing-time span"),this.volume=new o,this.$el.append(this.volume.$el),this.volume.render(),r.on("change:media",this.onMediaChange,this).on("change:remaining",this.onTimeChange,this),n.on("reset change:username",this.onDJChange,this),i.resize(e.bind(this.onResize,this)),this.onMediaChange(),this},onResize:function(e){var t=Math.min(e.barWidth-452,392),n=e.barWidth-t;this.$el.width(n).css("left",e.barHeight+t),this.$("#now-playing-media").width(this.$("#now-playing-time").offset().left-this.$("#now-playing-media").offset().left-10)},onMediaChange:function(){var e=r.get("media");e?(this.$media.html('<span class="author">'+s.cleanTypedString(e.get("author"))+"</span> - "+s.cleanTypedString(e.get("title"))),this.$("#now-playing-time").show()):(this.$media.html("<span>"+a.playback.noDJTitle+"</span>"),this.$("#now-playing-time").hide()),this.onResize(i.getSize())},onDJChange:function(){this.$dj.text(n.length>0?n.at(0).get("username"):a.playback.noDJ)},onTimeChange:function(){var e=r.get("remaining");e<0||!r.get("media")?this.$time.text("00:00"):this.$time.text(s.formatTimeLeading(e)),e<5?this.$time.hasClass("elapsing")||this.$time.addClass("elapsing"):this.$time.hasClass("elapsing")&&this.$time.removeClass("elapsing"),this.$("#now-playing-media").width(this.$("#now-playing-time").offset().left-this.$("#now-playing-media").offset().left-10)}});return f}),define("ac785/abf10/e9abd/feb9f/cf7e2",["backbone","ac785/abf10/e9abd/feb9f/fc918","ac785/abf10/e9abd/feb9f/c4b77","ac785/abf10/e9abd/feb9f/abedb"],function(e,t,n,r){var i=e.View.extend({id:"room-meta",className:"left-meta",initialize:function(){this.menu=new t,this.room=new n,this.playing=new r},render:function(){return this.$el.append(this.menu.$el).append(this.room.$el).append(this.playing.$el),this.menu.render(),this.room.render(),this.playing.render(),this}});return i}),define("hbs!template/room/header/PanelBar",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div id="chat-button" class="header-panel-button selected">\n    <div class="bar-divider"></div>\n    <i class="icon icon-chat"></i>\n    <span>'+a((o=(o=t.header,o==null||o===!1?o:o.chat),typeof o===u?o.apply(t):o))+'</span>\n</div>\n<div id="users-button" class="header-panel-button">\n    <i class="icon icon-population"></i>\n    <span class="bar-count"></span>\n</div>\n<div id="waitlist-button" class="header-panel-button">\n    <i class="icon icon-waitlist"></i>\n    <div class="position">\n        <span class="current"></span><span class="count"></span>\n    </div>\n</div>',s});return t.registerPartial("template_room_header_PanelBar",n),n}),define("ac785/abf10/e9abd/feb9f/b5f79",["underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/ab49c","ac785/ca252/bed74","hbs!template/room/header/PanelBar","lang/Lang"],function(e,t,n,r,i,s,o){var u=t.View.extend({id:"header-panel-bar",className:"right-meta",render:function(){return this.$el.html(s(o)),this.$chatButton=this.$("#chat-button").on("click",e.bind(this.onChatClick,this)).on("mouseenter",e.bind(this.onChatEnter,this)),this.$usersButton=this.$("#users-button").on("click",e.bind(this.onUsersClick,this)).on("mouseenter",e.bind(this.onUsersEnter,this)),this.$waitButton=this.$("#waitlist-button").on("click",e.bind(this.onWaitListClick,this)).on("mouseenter",e.bind(this.onWaitListEnter,this)),this.$(".header-panel-button").on("mouseleave",e.bind(this.onHideTooltip,this)),this.$users=this.$("#users-button span"),this.$count=this.$(".position .count"),this.$current=this.$(".position .current"),this.$position=this.$(".position"),this.$usersIcon=this.$("#users-button i"),this.$waitIcon=this.$("#waitlist-button i"),n.on("chat:mention",this.onChatClick,this),i.on("add remove",this.onUsersUpdate,this),r.on("update",this.onWaitListUpdate,this),this.onUsersUpdate(),this.onWaitListUpdate(),this},onUsersUpdate:function(){this.$users.text(i.length);var e=(this.$usersButton.width()-(48+this.$users.width()))/2;this.$usersIcon.css("left",e-1),this.$users.css("left",e+47)},onWaitListUpdate:function(){var e=r.getUserPosition();e>-1?(this.$current.text(e+1),r.length>0?this.$count.text("/"+r.length):this.$count.empty()):(this.$current.text(r.length),this.$count.empty());var t=(this.$waitButton.width()-(48+this.$position.width()))/2;this.$waitIcon.css("left",t-1),this.$position.css("left",t+47)},onChatClick:function(){this.$chatButton.hasClass("selected")||(this.$(".header-panel-button").removeClass("selected"),this.$chatButton.addClass("selected"),n.trigger("show:chat"))},onUsersClick:function(){this.$usersButton.hasClass("selected")||(this.$(".header-panel-button").removeClass("selected"),this.$usersButton.addClass("selected"),n.trigger("show:users"))},onWaitListClick:function(){this.$waitButton.hasClass("selected")||(this.$(".header-panel-button").removeClass("selected"),this.$waitButton.addClass("selected"),n.trigger("show:waitlist"))},onChatEnter:function(){n.trigger("tooltip:show",o.tooltips.headerChat,this.$chatButton,!0)},onUsersEnter:function(){n.trigger("tooltip:show",o.tooltips.headerUsers,this.$usersButton,!0)},onWaitListEnter:function(){n.trigger("tooltip:show",o.tooltips.headerWaitList,this.$waitButton,!0)},onHideTooltip:function(){n.trigger("tooltip:hide")}});return u}),define("ac785/abf10/e9abd/feb9f/bbd15",["backbone","ac785/abf10/e9abd/feb9f/cf7e2","ac785/abf10/e9abd/feb9f/b5f79"],function(e,t,n){var r=e.View.extend({id:"header",className:"avail-width",initialize:function(){this.room=new t,this.panels=new n},render:function(){return this.$el.empty().append(this.room.$el).append(this.panels.$el),this.room.render(),this.panels.render(),this}});return r}),define("ac785/e734f/e9abd/f2dd0",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.description=e,this.description&&this.description.substr(0,Math.min(this.description.length,512)),this._super()},execute:function(){t.execute("moderate.update_description",this,this.description)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/e9abd/e0a21",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.name=e,this.name&&this.name.substr(0,Math.min(this.name.length,24)),this._super()},execute:function(){t.execute("moderate.update_name",this,this.name)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/e9abd/d39df",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e,t){this.id=e,this.cycle=t,this._super()},execute:function(){t.execute("room.cycle_booth",this,this.id,this.cycle)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/e734f/e9abd/aed70",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(e){this.welcome=e,this.welcome&&this.welcome.substr(0,Math.min(this.welcome.length,255)),this._super()},execute:function(){t.execute("moderate.update_welcome",this,this.welcome)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("ac785/abf10/d9a0c/de86d",["underscore","ac785/d94e0/b584a","ac785/ca252/c512b","ac785/e734f/e9abd/b7cfa","ac785/abf10/d9a0c/fbb95","lang/Lang"],function(e,t,n,r,i,s){var o=i.extend({id:"dialog-confirm",className:"dialog destructive",render:function(){return this.clear=!1,this.$el.append(this.getHeader(s.dialog.lockBoothTitle)).append(this.getBody().append(this.getMessage(s.dialog.lockBoothMessage))).append(this.getButtons(s.dialog.lockBoothSubmit,!0)),e.defer(e.bind(this.adjustTop,this)),this._super()},adjustTop:function(){this.$(".dialog-body .message").css("top",(this.$(".dialog-body").height()-this.$(".dialog-body .message").height())/2),this.$(".cancel span").text(s.dialog.lockBoothCancel)},submit:function(){this.clear=!0,this.close()},close:function(){new r(n.get("id"),!0,this.clear),this.clear=undefined,this._super()}});return o}),define("hbs!template/room/header/RoomInfo",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="name panel">\n    <span class="title">'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.name),typeof o===u?o.apply(t):o))+'</span>\n    <div class="edit">\n        <span>'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.edit),typeof o===u?o.apply(t):o))+'</span>\n        <i class="icon icon-edit-grey"></i>\n    </div>\n    <span class="value"></span>\n</div>\n<div class="description panel">\n    <span class="title">'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.description),typeof o===u?o.apply(t):o))+'</span>\n    <div class="edit">\n        <span>'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.edit),typeof o===u?o.apply(t):o))+'</span>\n        <i class="icon icon-edit-grey"></i>\n    </div>\n    <span class="value">'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.noDescription),typeof o===u?o.apply(t):o))+'</span>\n</div>\n<div class="welcome panel">\n    <span class="title">'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.welcome),typeof o===u?o.apply(t):o))+'</span>\n    <div class="edit">\n        <span>'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.edit),typeof o===u?o.apply(t):o))+'</span>\n        <i class="icon icon-edit-grey"></i>\n    </div>\n    <span class="value">'+a((o=(o=t.roomInfo,o==null||o===!1?o:o.noWelcome),typeof o===u?o.apply(t):o))+'</span>\n</div>\n<div class="cycle-toggle button">\n    <div>\n        <i class="icon icon-join-waitlist-big"></i>\n        <span></span>\n    </div>\n</div>\n<div class="lock-toggle button">\n    <div>\n        <i class="icon icon-unlocked"></i>\n        <span></span>\n    </div>\n</div>',s});return t.registerPartial("template_room_header_RoomInfo",n),n}),define("ac785/abf10/e9abd/feb9f/e4737",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/f04be/c8b95","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/e9abd/f2dd0","ac785/e734f/e9abd/e0a21","ac785/e734f/e9abd/d39df","ac785/e734f/e9abd/b7cfa","ac785/e734f/e9abd/aed70","ac785/f6dac/ffe62","ac785/abf10/d9a0c/de86d","hbs!template/room/header/RoomInfo","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=n.View.extend({id:"room-info",initialize:function(){this.keyUpBind=t.bind(this.onKeyUp,this),this.keyDownBind=t.bind(this.onKeyDown,this),this.blurBind=t.bind(this.onBlur,this),this.enterBind=t.bind(this.onEnter,this),this.leaveBind=t.bind(this.onLeave,this),this.documentBind=t.bind(this.onDocumentClick,this),this.editing=!1},render:function(){return this.$el.html(m(g)).on("mouseenter",this.enterBind).on("mouseleave",this.leaveBind),this.$name=this.$(".name .value").on("click",t.bind(this.onNameEdit,this)),this.$description=this.$(".description .value").on("click",t.bind(this.onDescriptionEdit,this)),this.$welcome=this.$(".welcome .value").on("click",t.bind(this.onWelcomeEdit,this)),this.$booth=this.$(".lock-toggle").on("click",t.bind(this.onLockClick,this)),this.$boothLabel=this.$(".lock-toggle span"),this.$boothIcon=this.$(".lock-toggle i"),this.$cycle=this.$(".cycle-toggle").on("click",t.bind(this.onCycleClick,this)).on("mouseenter",t.bind(this.onCycleEnter,this)).on("mouseleave",t.bind(this.onHideTooltip,this)),this.$cycleLabel=this.$(".cycle-toggle span"),this.$cycleIcon=this.$(".cycle-toggle i"),this.$nameEdit=this.$(".name .edit").on("click",t.bind(this.onNameEdit,this)),this.$descriptionEdit=this.$(".description .edit").on("click",t.bind(this.onDescriptionEdit,this)),this.$welcomeEdit=this.$(".welcome .edit").on("click",t.bind(this.onWelcomeEdit,this)),o.on("change:name change:description change:welcome change:boothLocked change:boothCycle",this.onChange,this),u.on("change:permission",this.onChange,this),r.on("roomInfo:show",this.onShow,this),this},onShow:function(){if(!this.$el.is(":visible")){r.trigger("playback:block").trigger("settings:hide"),this.$el.show();var n=this;t.defer(function(){e(document).on("mousedown",n.documentBind)})}else this.onDocumentClick()},onEnter:function(){this.over=!0},onLeave:function(){this.over=!1},onDocumentClick:function(t){if(!this.over&&!d.currentDialog){var n=!0;if(t){var i=e(t.target);if(i.is("span")||i.is("i"))i=i.parent();if(i.attr("id")=="room-name"||i.attr("id")=="room-host"||i.attr("id")=="room-bar")n=!1}n&&(this.$el.hide(),e(document).off("mousedown",this.documentBind),r.trigger("playback:unblock"))}},onChange:function(e){var t=e.changedAttributes();if(t){for(var n in t)n==="description"?this.$description.html(s.parse(t[n]||g.roomInfo.noDescription).split("\n").join("<br/>")):n==="name"?this.$name.text(t[n]):n==="welcome"?this.$welcome.html(s.parse(t[n]||g.roomInfo.noWelcome)):n==="boothLocked"?t[n]?(this.$boothLabel.text(g.roomInfo.waitListLocked),this.$boothIcon.removeClass("icon-unlocked").addClass("icon-locked")):(this.$boothLabel.text(g.roomInfo.waitListUnlocked),this.$boothIcon.removeClass("icon-locked").addClass("icon-unlocked")):n==="boothCycle"&&(t[n]?(this.$cycleLabel.text(g.roomInfo.djCycleEnabled),this.$cycleIcon.removeClass("icon-leave-waitlist-big").addClass("icon-join-waitlist-big")):(this.$cycleLabel.text(g.roomInfo.djCycleDisabled),this.$cycleIcon.removeClass("icon-join-waitlist-big").addClass("icon-leave-waitlist-big")));u.hasPermission(a.COHOST)?(this.$(".name").show(),this.$nameEdit.show(),this.$descriptionEdit.show(),this.$welcomeEdit.show()):(this.$(".name").hide(),this.$nameEdit.hide(),this.$descriptionEdit.hide(),this.$welcomeEdit.hide()),this.$booth.removeClass("enabled disabled"),this.$cycle.removeClass("enabled disabled"),u.hasPermission(a.MANAGER)&&(this.$booth.addClass(o.get("boothLocked")?"disabled":"enabled"),this.$cycle.addClass(o.get("boothCycle")?"enabled":"disabled"))}},onNameEdit:function(){if(u.hasPermission(a.COHOST)&&!this.editing){this.editing=!0,this.$nameInput=e("<div/>").addClass("input-background").append(e('<input id="input-room-name" type="text" maxlength="24" value="'+o.get("name")+'"/>')),this.$nameInput.find("input").on("keyup",this.keyUpBind).on("keydown",this.keyDownBind).on("blur",this.blurBind),this.$name.hide(),this.$(".name .edit span").text(g.roomInfo.save),this.$(".name").append(this.$nameInput);var n=this.$nameInput.find("input").focus()[0];t.defer(function(){n.focus(),n.selectionStart=n.selectionEnd=n.value.length})}},onDescriptionEdit:function(){if(u.hasPermission(a.COHOST)&&!this.editing){this.editing=!0,this.$descriptionInput=e("<div/>").addClass("input-background").append(e('<textarea id="input-room-description" rows="120" cols="5" maxlength="512">'+(o.get("description")||"")+"</textarea>")),this.$descriptionInput.find("textarea").on("keyup",this.keyUpBind).on("keydown",this.keyDownBind).on("blur",this.blurBind),this.$description.hide(),this.$(".description .edit span").text(g.roomInfo.save),this.$(".description").append(this.$descriptionInput);var n=this.$descriptionInput.find("textarea").focus()[0];t.defer(function(){n.focus(),n.selectionStart=n.selectionEnd=n.value.length})}},onWelcomeEdit:function(){if(u.hasPermission(a.COHOST)&&!this.editing){this.editing=!0,this.$welcomeInput=e("<div/>").addClass("input-background").append(e('<textarea id="input-room-welcome" rows="80" cols="5" maxlength="255">'+(o.get("welcome")||"")+"</textarea>")),this.$welcomeInput.find("textarea").on("keyup",this.keyUpBind).on("keydown",this.keyDownBind).on("blur",this.blurBind),this.$welcome.hide(),this.$(".welcome .edit span").text(g.roomInfo.save),this.$(".welcome").append(this.$welcomeInput);var n=this.$welcomeInput.find("textarea").focus()[0];t.defer(function(){n.focus(),n.selectionStart=n.selectionEnd=n.value.length})}},onLockClick:function(){u.hasPermission(a.MANAGER)&&(o.get("boothLocked")?new h(o.get("id"),!1,!1):r.dispatch(new i(i.SHOW,new v)))},onCycleClick:function(){u.hasPermission(a.MANAGER)&&new c(o.get("id"),!o.get("boothCycle"))},onKeyDown:function(e){var t;return e?(t=e.which||e.keyCode,t==13||t==9?e.target.id!="input-room-description"||t==9?(e.preventDefault(),e.stopImmediatePropagation(),e.target.blur(),!1):!0:t==27?(e.preventDefault(),e.stopImmediatePropagation(),e.target.id=="input-room-name"?this.$(e.target)[0].value=o.get("name"):e.target.id=="input-room-description"?this.$(e.target).val(o.get("description")):e.target.id=="input-room-welcome"&&this.$(e.target).val(o.get("welcome")),e.target.blur(),!1):!0):!0},onKeyUp:function(t){var n;if(!t)return!0;n=t.which||t.keyCode;if(n==13||n==9)return t.target.id!="input-room-description"||n==9?(t.preventDefault(),t.stopImmediatePropagation(),!1):!0;if(n==27)return t.preventDefault(),t.stopImmediatePropagation(),!1;if(t.target.id=="input-room-description"||t.target.id=="input-room-welcome"){var r=e(t.target),i=parseInt(r.attr("maxlength"));r.val().length>i&&r.val(r.val().substr(0,r.attr("maxlength")))}return!0},onBlur:function(n){n.target.id=="input-room-name"?(n.target.value!=o.get("name")&&n.target.value.length>2&&(o.set("name",n.target.value),new l(n.target.value)),this.$nameInput.remove(),this.$nameInput=undefined,this.$(".name .edit span").text(g.roomInfo.edit),this.$name.show()):n.target.id=="input-room-description"?(e(n.target).val()!=o.get("description")&&(o.set("description",e(n.target).val()),new f(n.target.value)),this.$descriptionInput.remove(),this.$descriptionInput=undefined,this.$(".description .edit span").text(g.roomInfo.edit),this.$description.show()):n.target.id=="input-room-welcome"&&(e(n.target).val()!=o.get("welcome")&&(o.set("welcome",e(n.target).val()),new p(n.target.value)),this.$welcomeInput.remove(),this.$welcomeInput=undefined,this.$(".welcome .edit span").text(g.roomInfo.edit),this.$welcome.show());var r=this;t.delay(function(){r.editing=!1},100)},onCycleEnter:function(){r.trigger("tooltip:show",g.tooltips.djCycle,this.$cycle)},onHideTooltip:function(){r.trigger("tooltip:hide")}});return y}),define("hbs!template/dialogs/DialogRoomCreate",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="divider"></div>\r\n<ul>\r\n    <li class="type public">\r\n        <div class="radio">\r\n            <i class="icon icon-active-rollover"></i>\r\n        </div>\r\n        <span>'+a((o=(o=t.dialog,o==null||o===!1?o:o.roomPublic),typeof o===u?o.apply(t):o))+'</span>\r\n    </li>\r\n    <li class="type private">\r\n        <div class="radio">\r\n            <i class="icon icon-active-rollover"></i>\r\n        </div>\r\n        <span>'+a((o=(o=t.dialog,o==null||o===!1?o:o.roomPrivate),typeof o===u?o.apply(t):o))+"</span>\r\n    </li>\r\n</ul>",s});return t.registerPartial("template_dialogs_DialogRoomCreate",n),n}),define("ac785/abf10/d9a0c/af637",["jquery","underscore","ac785/d94e0/cb4b7","ac785/f6dac/bf313","ac785/abf10/d9a0c/fbb95","hbs!template/dialogs/DialogRoomCreate","lang/Lang"],function(e,t,n,r,i,s,o){var u=i.extend({id:"dialog-room-create",className:"dialog choice no-submit",render:function(){return this.$el.append(this.getHeader(o.dialog.createRoom)).append(this.getBody().append(this.getInputField("name",o.dialog.name,o.dialog.roomName,"",32)).append(s(o))).append(this.getButtons(o.dialog.createRoom,!0)),this.$(".type").on("click",t.bind(this.onClick,this)),this.$(".public").click(),t.defer(t.bind(this.deferFocus,this)),this._super()},deferFocus:function(){var e=this.$el.find("input");this.$field=e.on("keyup",t.bind(this.onKeyUp,this)).focus(),e[0].selectionStart=e[0].selectionEnd=e[0].value.length},onClick:function(t){var n=e(t.target);if(n.hasClass("radio")||n.hasClass("icon")||n.is("span"))n=n.parent();this.$(".type").removeClass("selected"),n.addClass("selected")},submit:function(){var e=this.$field[0].value;if(e.length>0){var t=!0;this.$("li.selected").hasClass("public")?t=!0:this.$("li.selected").hasClass("private")&&(t=!1),this.dispatch(new n(n.CREATE,e,t)),r.event("Dialog","Create Room",t?"Public":"Private"),this.close()}},onKeyUp:function(){this.$field[0].value.length>0?this.$el.removeClass("no-submit"):this.$el.addClass("no-submit")},close:function(){this.$(".type").off("click"),this.$field.off(),this.$field=undefined,this._super()}});return u}),define("hbs!template/lobby/LobbyRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="people">\r\n    <span class="population">',(o=n.population)?o=o.call(t,{hash:{}}):(o=t.population,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="population-label">',(o=n.populationLabel)?o=o.call(t,{hash:{}}):(o=t.populationLabel,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span alt="',(o=n.friends)?o=o.call(t,{hash:{}}):(o=t.friends,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="friends">',(o=n.friendsCount)?o=o.call(t,{hash:{}}):(o=t.friendsCount,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="friends-label">',(o=n.friendsLabel)?o=o.call(t,{hash:{}}):(o=t.friendsLabel,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n</div>\r\n<div class="meta">\r\n    <span class="name">',(o=n.name)?o=o.call(t,{hash:{}}):(o=t.name,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="media">',(o=n.media)?o=o.call(t,{hash:{}}):(o=t.media,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\r\n    <span class="host">',(o=n.hostedBy)?o=o.call(t,{hash:{}}):(o=t.hostedBy,o=typeof o===u?o.apply(t):o),s+=a(o)+" ",(o=n.host)?o=o.call(t,{hash:{}}):(o=t.host,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\r\n</div>",s});return t.registerPartial("template_lobby_LobbyRow",n),n}),define("ac785/abf10/feed7/f2d57",["jquery","backbone","ac785/bc190/cd0b8","ac785/d94e0/a045f","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/f6dac/bf313","hbs!template/lobby/LobbyRow","lang/Lang"],function(e,t,n,r,i,s,o,u,a){var f=t.View.extend({className:"room",events:{click:"onClick"},initialize:function(){this.model.on("change",this.onChange,this),this.enterBind=_.bind(this.onEnter,this),this.leaveBind=_.bind(this.onLeave,this)},render:function(){var t={population:this.model.get("userCount"),populationLabel:this.model.get("userCount")==1?a.lobby.person:a.lobby.people,name:this.model.get("name"),hostedBy:a.lobby.hostedBy,host:this.model.get("host"),media:this.model.get("media")||a.playback.noDJTitle,friendsLabel:this.model.get("friends").length==1?a.lobby.friend:a.lobby.friends,friendsCount:this.model.get("friends").length};this.$el.html(u(t));if(this.model.get("friends").length==0)this.$el.addClass("no-friends");else{var n=[].concat(this.model.get("friends"));n.length>5?(n.length=5,this.friends=n.join(", ")+a.lobby.more.split("%COUNT%").join(String(this.model.get("friends").length-5))):this.friends=n.join(", "),this.$friends=this.$(".friends").on("mouseenter",this.enterBind).on("mouseleave",this.leaveBind)}return this.model.get("private")&&s.get("username")!=this.model.get("host")&&(this.$el.addClass("private"),this.$(".meta").append(e("<div/>").addClass("icon icon-locked"))),this},remove:function(){this._super(),this.model.off("change",this.onChange,this),this.model=undefined,delete this.model,this.$(".friends").off(),this.$el.empty(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onChange:function(){this.render()},onEnter:function(){this.friends&&n.trigger("tooltip:show",this.friends,this.$friends,!1,!0,"purple")},onLeave:function(){this.friends&&n.trigger("tooltip:hide")},onClick:function(){var e=this.model.get("id");e!=i.get("id")&&(window.location.href="/"+e+"/")}});return f}),define("ac785/abf10/feed7/e41f6",["underscore","backbone","ac785/bc190/cd0b8","ac785/f04be/fac07","ac785/ca252/e503d","ac785/abf10/feed7/f2d57"],function(e,t,n,r,i,s){var o=t.View.extend({className:"list",collection:i,initialize:function(){this.rows=[]},onReset:function(){this.clear(),this.$el.scrollTop(0)},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();this.rows.length=0,this.$el.empty()},onAdd:function(e){var t=new s({model:e});this.$el.append(t.$el),this.rows.push(t),t.render()},render:function(){return this.$el.empty(),this.$el.on("scroll",e.bind(this.onScroll,this)),this.collection.on("reset",this.onReset,this).on("add",this.onAdd,this),this},onScroll:function(){this.$el.scrollTop()>this.$el[0].scrollHeight-this.$el.height()-100&&r.more()}});return o}),define("hbs!template/lobby/RoomLobby",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="header">\n    <i class="icon icon-site-logo"></i>\n    <div class="back">\n        <i class="icon icon-back"></i>\n    </div>\n</div>\n<div class="search">\n    <div class="input-background">\n        <i class="icon icon-search"></i>\n        <input type="text" maxlength="32" placeholder="'+a((o=(o=t.lobby,o==null||o===!1?o:o.placeholder),typeof o===u?o.apply(t):o))+'"/>\n    </div>\n    <div class="create">\n        <i class="icon icon-create-room"></i>\n        <span>'+a((o=(o=t.lobby,o==null||o===!1?o:o.create),typeof o===u?o.apply(t):o))+"</span>\n    </div>\n</div>",s});return t.registerPartial("template_lobby_RoomLobby",n),n}),define("ac785/abf10/feed7/c3297",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/bd874","ac785/f04be/fac07","ac785/f6dac/ffe62","ac785/abf10/d9a0c/af637","ac785/abf10/feed7/e41f6","hbs!template/lobby/RoomLobby","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({className:"lobby",initialize:function(){this.backBind=t.bind(this.onBack,this),this.createBind=t.bind(this.onCreate,this),this.resizeBind=t.bind(this.onResize,this),this.keyUpBind=t.bind(this.onKeyUp,this),this.focusBind=t.bind(this.onFocus,this),this.blurBind=t.bind(this.onBlur,this),this.showing=!1},render:function(){return this.$el.html(f(l)),this.list=new a,this.$el.append(this.list.$el),this.list.render(),r.on("lobby:show",this.show,this),r.on("lobby:hide room:joining",this.hide,this),this},show:function(){this.showing=!0,s.load(),e("body").append(this.$el.animate({left:0},{easing:"easeInOutExpo",duration:350})),this.$(".back").on("click",this.backBind),this.$(".create").on("click",this.createBind),this.$searchInput=this.$(".search input").on("keyup",this.keyUpBind).on("focus",this.focusBind).on("blur",this.blurBind),this.searchInput=this.$searchInput[0],o.resize(this.resizeBind)},hide:function(){this.showing&&(o.off("resize",this.resizeBind),this.$(".back").off("click",this.backBind),this.$(".create").off("click",this.createBind),this.$(".search input").off("keyup",this.keyUpBind).off("focus",this.focusBind).off("blur",this.blurBind),this.$el.animate({left:-this.$el.width()},{easing:"easeInOutExpo",duration:250,complete:this.completeBind}))},onComplete:function(){this.showing=!1,this.$el.remove()},onResize:function(e){this.$el.height(e.height),this.list.$el.height(e.height-this.list.$el.offset().top)},onBack:function(){this.hide()},onCreate:function(){r.dispatch(new i(i.SHOW,new u))},onKeyUp:function(e){var t;if(!e)return!0;t=e.which||e.keyCode;if(t==27)this.searchInput.value="";else if(t==13)return e.preventDefault(),s.load(this.searchInput.value.toLowerCase()),!1;return!0},onFocus:function(e){this.searchInput.placeholder=""},onBlur:function(e){this.searchInput.placeholder=l.lobby.placeholder}});return c}),define("hbs!template/room/notification/Notification",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="left">\n    <i></i>\n</div>\n<div class="right">\n    <span></span>\n</div>'});return t.registerPartial("template_room_notification_Notification",n),n}),define("ac785/abf10/e9abd/df21d/b788d",["underscore","backbone","hbs!template/room/notification/Notification"],function(e,t,n){var r=t.View.extend({className:"notification",events:{click:"onClick"},render:function(){return this.$el.html(n()),this.$("i").addClass("icon "+this.options.icon),this.$("span").text(this.options.message),e.defer(e.bind(this.adjustTop,this)),this},adjustTop:function(){this.$("span").css("top",(this.$(".right").height()-this.$("span").height())/2),this.$el.animate({opacity:1},{duration:r.FADE_IN}),this.interval=e.delay(e.bind(this.fadeOut,this),r.DISPLAY)},fadeOut:function(){clearInterval(this.interval),this.$el&&(this.$el.animate({opacity:0},{duration:r.FADE_OUT}),this.interval=e.delay(e.bind(this.onClick,this),r.FADE_OUT+10))},slideDown:function(){this.$el.animate({top:parseInt(this.$el.css("top"))+this.$el.height()+7},{duration:r.SLIDE,easing:"easeInOutExpo"})},onClick:function(e){clearInterval(this.interval),this.$el.stop(!0,!0),e&&this.options.action&&this.options.action(),this.trigger("close",this),this.remove()},remove:function(){this._super(),clearInterval(this.interval),this.interval=undefined,this.off(),this.options.action=undefined,this.options=undefined,this.$el=undefined,this.el=undefined,delete this.$el,delete this.el}});return r.SLIDE=250,r.FADE_IN=250,r.FADE_OUT=500,r.DISPLAY=6e3,r}),define("ac785/abf10/e9abd/df21d/f56c2",["underscore","backbone","ac785/bc190/cd0b8","ac785/abf10/e9abd/df21d/b788d"],function(e,t,n,r){var i=t.View.extend({id:"notifications",initialize:function(){this.rows=[],this.pushBind=e.bind(this.onPush,this),this.rowCloseBind=e.bind(this.onRowClose,this)},render:function(){return this.$el.empty(),n.on("notify",this.onNotify,this),this},onNotify:function(t,n,i){var s=this.rows.length;if(s>0){s>4&&(this.rows[0].onClick(),--s);for(var o=0;o<s;++o)this.rows[o].slideDown()}var u=new r({icon:t,message:n,action:i});u.on("close",this.rowCloseBind),this.rows.push(u),e.delay(this.pushBind,r.SLIDE-100)},onPush:function(){this.$el.append(this.rows[this.rows.length-1].$el),this.rows[this.rows.length-1].render()},onRowClose:function(e){var t=this.rows.indexOf(e);t>-1&&this.rows.splice(t,1)}});return i}),define("ac785/abf10/e9abd/a0d39",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/a9a95","ac785/f6dac/ae40c","ac785/f6dac/ffe62","ac785/f6dac/bf313","ac785/f6dac/d17c3","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({id:"room-loader",initialize:function(){this.resizeBind=t.bind(this.onResize,this),this.firstTime=!0,this.$avatar=e("<div/>").addClass("avatar");var n=[];i.each(function(e){n.push(e.get("id"))}),this.avatarIDs=a.randomizeArray(n),this.intervalID=0},render:function(){return this.$span=e("<span/>").text(f.roomInfo.loading),this.$el.append(this.$span),r.on("room:joining",this.show,this).on("room:joined",this.onJoined,this),this},show:function(){this.joined=!1,this.showing||(this.showing=!0,e("body").append(this.$el),o.resize(this.resizeBind),this.showAvatar())},hide:function(){this.showing&&(this.hideAvatar(),this.$el.remove(),o.off("resize",this.resizeBind),this.showing=!1)},showAvatar:function(){this.hideAvatar(),this.$avatarImage=e("<img/>").attr("src",s.getAvatarUrl("default",this.getAvatarID(),"")).load(t.bind(this.onAvatarLoaded,this))},onAvatarLoaded:function(){this.showing&&(this.$avatar.append(this.$avatarImage),this.$el.append(this.$avatar),this.avatarFrame=0,this.intervalID=setInterval(t.bind(this.animateAvatar,this),83))},hideAvatar:function(){this.$avatar.empty().remove(),this.$avatarImage=undefined,this.avatarFrame=0,clearInterval(this.intervalID)},animateAvatar:function(){++this.avatarFrame==11&&(this.avatarFrame=0),this.$avatarImage.css("left",this.avatarFrame*-150)},getAvatarID:function(){var e=this.avatarIDs.shift();return this.avatarIDs.push(e),e},onResize:function(e){this.$el.width(e.width).height(e.height),this.$avatar.css("left",(e.width-150)/2).css("top",e.height/2-100),this.$span.css("top",e.height/2+60)},loadBG:function(){u.enabled||(this.firstTime?(this.firstTime=!1,e("<img/>").attr("src","/_/static/images/background.449cb38.jpg").load(t.bind(this.onBGLoaded,this))):this.onBGLoaded())},onBGLoaded:function(){if(!u.enabled){var n=this;t.defer(function(){e(document.body).css("background","#000 url(/_/static/images/background.449cb38.jpg) no-repeat"),o.onResize(),n.joined&&n.hide()})}},onJoined:function(e){e||(this.joined=!0,this.loadBG())},customLoaded:function(){this.joined=!0,this.hide()},customUnload:function(){this.firstTime=!0,this.loadBG()}});return new l}),define("hbs!template/room/Booth",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<canvas id="dj-canvas" width="170" height="220"></canvas>'});return t.registerPartial("template_room_Booth",n),n}),define("ac785/abf10/e9abd/a812b",["underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/a9a95","ac785/ca252/f89d8","ac785/ab6db/ffb2a","ac785/f6dac/ae40c","ac785/f6dac/abcc8","ac785/abf10/e9abd/ea1d8/a04e5","hbs!template/room/Booth"],function(e,t,n,r,i,s,o,u,a,f){var l=t.View.extend({id:"dj-booth",initialize:function(){this.setRenderMode(u.clipRender),n.on("room:joining",this.onRoomJoin,this)},render:function(){this.$el.html(f()).mousemove(e.bind(this.onMouseMove,this)).mouseleave(e.bind(this.onMouseLeave,this)).click(e.bind(a.onAvatarClick,a)),this.djCanvas=document.getElementById("dj-canvas"),this.djContext=this.djCanvas.getContext("2d"),this.djContext.fillStyle="rgba(0,0,0,0)",this.avatarImages={},this.image=undefined,this.frame=0,this.avatarTheme="default",i.on("reset",this.onDJUpdate,this),this.clear()},onRoomJoin:function(){this.clear()},onMouseMove:function(e){this.image&&a.showSimple(this.image.user,{x:e.pageX,y:e.pageY-14})},onMouseLeave:function(e){a.hide()},clear:function(){this.removeChangeListeners(),this.djContext.clearRect(0,0,170,220),this.userImageMap={},this.image=undefined,this.refresh()},removeChangeListeners:function(){for(var e in this.userImageMap)this.userImageMap[e].user.off("change:avatarID",this.onUserChange,this)},onDJUpdate:function(){this.removeChangeListeners(),this.userImageMap={},this.image=undefined,this.refresh(),i.length>0&&this.createUser(i.at(0))},createUser:function(e){e.on("change:avatarID",this.onUserChange,this).on("change:vote",this.onVoteChange,this);var t;t=r.dj;var n=this.userImageMap[e.get("id")]={user:e,avatarID:e.get("avatarID"),props:{x:0,y:0,w:t.w,h:t.h,scale:1,sw:t.sw,ox:0,oy:0,ow:t.w,oh:t.h}};this.avatarImages[e.get("avatarID")]?n.image=this.avatarImages[e.get("avatarID")+"dj"]:this.loadAvatar(n),this.image=this.userImageMap[e.get("id")]},onUserChange:function(e){if(this.userImageMap[e.get("id")]){var t,n=this.userImageMap[e.get("id")];t=r.dj,n.avatarID=e.get("avatarID"),n.props={x:0,y:0,w:t.w,h:t.h,scale:1,sw:t.sw,ox:0,oy:0,ow:t.w,oh:t.h},this.avatarImages[e.get("avatarID")]?(n.image=this.avatarImages[e.get("avatarID")],this.refresh(),s.settings.dancing||this.draw()):this.loadAvatar(n,!0)}},loadAvatar:function(e,t){var n=this,r=new Image;r.onload=function(){n.onAvatarLoaded(this,e,t)},r.src=o.getAvatarUrl(this.avatarTheme,e.user.get("avatarID"),"dj")},onAvatarLoaded:function(e,t,n){t.image=e,this.refresh(),this.draw()},refresh:function(){this.isRendered=!1,this.renderPass=0,this.renderedFrames=new Array(11)},draw:function(){if(!this.isRendered){var e=this.renderFunc();if(!e)this.refresh();else if(!u.isMac||!u.isSafari)++this.renderPass<12?this.renderedFrames[this.frame]=this.djContext.getImageData(0,0,170,220):this.isRendered=!0}else this.update()},update:function(){this.renderedFrames[this.frame]&&this.djContext.putImageData(this.renderedFrames[this.frame],0,0)},setRenderMode:function(e){e?this.renderFunc=this.renderClip:this.renderFunc=this.renderNoClip},renderClip:function(){this.djContext.clearRect(0,0,170,220);var e=!0;return this.image&&(this.image.image&&this.image.image.complete?(this.djContext.save(),this.djContext.beginPath(),this.djContext.moveTo(this.image.props.x,this.image.props.y),this.djContext.lineTo(this.image.props.x+this.image.props.w,this.image.props.y),this.djContext.lineTo(this.image.props.x+this.image.props.w,this.image.props.y+this.image.props.h),this.djContext.lineTo(this.image.props.x,this.image.props.y+this.image.props.h),this.djContext.lineTo(this.image.props.x,this.image.props.y),this.djContext.closePath(),this.djContext.fill(),this.djContext.clip(),this.djContext.drawImage(this.image.image,this.image.props.x-this.image.props.w*this.frame,this.image.props.y,this.image.props.sw,this.image.props.h),this.djContext.restore()):e=!1),e},renderNoClip:function(){this.djContext.clearRect(0,0,170,220);var e=!0;return this.image&&(this.image.image&&this.image.image.complete?(this.djContext.save(),this.djContext.translate(this.image.props.x,this.image.props.y),this.djContext.scale(this.image.props.scale,this.image.props.scale),this.djContext.drawImage(this.image.image,this.image.props.ow*this.frame,0,this.image.props.ow,this.image.props.oh,0,0,this.image.props.ow,this.image.props.oh),this.djContext.restore()):e=!1),e}});return new l}),define("hbs!template/room/DJButton",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div class="left">\n    <i class="icon icon-join-booth"></i>\n</div>\n<span></span>'});return t.registerPartial("template_room_DJButton",n),n}),define("ac785/abf10/e9abd/fa474",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/c672e","ac785/ca252/f89d8","ac785/ca252/ab49c","ac785/ca252/c0f8f","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/ab6db/ffb2a","ac785/f6dac/bf313","ac785/abf10/bc8c0/e31ab","hbs!template/room/DJButton","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=t.View.extend({id:"dj-button",render:function(){return this.$el.html(d).click(e.bind(this.onClick,this)),this.$label=this.$("span"),this.$icon=this.$("i"),n.on("userPlaying:update",this.updateUserPlaying,this).on("djButton:update",this.updateDJButton,this),this.updateDJButton(),this},showSpinner:function(){this.hideSpinner(),this.$icon.hide(),this.spinner=new p({size:p.SMALL}),this.$el.append(this.spinner.$el),this.spinner.render().$el.css("left",36).css("top",31)},hideSpinner:function(){this.spinner&&(this.spinner.remove(),this.spinner=undefined,this.$icon.show())},setMode:function(e){this.mode=e,this.mode=="join"?(this.$icon.removeClass().addClass("icon icon-current-dj-white"),this.$label.text(v.dj.djJoin)):this.mode=="wait"?(this.$icon.removeClass().addClass("icon icon-join-waitlist-big"),this.$label.text(v.dj.waitJoin)):this.mode=="quit"?(this.$icon.removeClass().addClass("icon icon-leave-booth-big"),this.$label.text(v.dj.djLeave)):this.mode=="leave"?(this.$icon.removeClass().addClass("icon icon-leave-waitlist-big"),this.$label.text(v.dj.waitLeave)):this.mode=="full"?(this.$icon.removeClass().addClass("icon icon-waitlist-full-big"),this.$label.text(v.dj.waitFull)):this.mode=="locked"&&(this.$icon.removeClass().addClass("icon icon-booth-locked-big"),this.$label.text(v.dj.boothLocked)),this.$el.removeClass().addClass("is-"+e)},onClick:function(){this.mode=="quit"?n.dispatch(new r(r.CONFIRM,v.alerts.quitDJTitle,v.alerts.quitDJMessage,e.bind(this.onQuitConfirm,this))):this.mode=="leave"?n.dispatch(new r(r.CONFIRM,v.alerts.leaveWaitlistTitle,v.alerts.leaveWaitlistMessage,e.bind(this.onLeaveConfirm,this))):this.onPlayClick()},onPlayClick:function(){var e=0,t=u.find(function(e){return e.get("selected")});f.hasPermission(l.MANAGER)||f.get("permission")==l.DJ?e=0:a.get("boothLocked")&&(e=1),e==0&&o.isFull()&&(e=3),e==0&&(!t||t.get("items").length==0)&&(e=2),e==0?(this.showSpinner(),n.dispatch(new i(i.JOIN)),h.event("DJ","Join")):e==1?(n.trigger("notify","icon-booth-locked",v.alerts.lockedBooth),h.event("DJ","Join","Locked Booth")):e==2?t?(n.trigger("notify","icon-playlist",v.alerts.playlistWithoutMedia,function(){n.trigger("playlist:open")}),h.event("DJ","Join","No Media In Playlist")):(n.trigger("notify","icon-create-playlist",v.alerts.createFirstPlaylist,function(){n.trigger("playlist:first")}),h.event("DJ","Join","No Playlist")):e==3&&(n.trigger("notify","icon-waitlist-full",v.alerts.waitListFull),h.event("DJ","Join","Full Waitlist"))},onQuitConfirm:function(){this.showSpinner(),n.dispatch(new i(i.LEAVE)),h.event("DJ","Leave Booth")},onLeaveConfirm:function(){this.showSpinner(),n.dispatch(new i(i.LEAVE)),h.event("DJ","Leave Waitlist")},updateUserPlaying:function(){this.hideSpinner(),this.updateDJButton()},updateDJButton:function(){var e=o.isFull();a.get("boothLocked")?s.isTheUserPlaying?this.setMode("quit"):o.getUserPosition()>-1?this.setMode("leave"):e?this.setMode("full"):f.get("permission")==l.DJ||f.hasPermission(l.MANAGER)?s.length==0?this.setMode("join"):this.setMode("wait"):this.setMode("locked"):s.isTheUserPlaying?this.setMode("quit"):o.getUserPosition()>-1?this.setMode("leave"):s.length>0?e?this.setMode("full"):this.setMode("wait"):this.setMode("join")}});return m}),define("ac785/e734f/bbe20/b1912",["ac785/e734f/b669d","ac785/c3562/d4511"],function(e,t){var n=e.extend({init:function(){this._super()},execute:function(){t.execute("duration.mismatch",this)},parse:function(e){e.status!=0&&this.onStatusError(e.status)}});return n}),define("hbs!template/room/playback/Playback",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="background"></div>\r\n<div id="no-dj">\r\n    <div class="avatar"></div>\r\n    <div class="message">\r\n        <span class="title">'+a((o=(o=t.playback,o==null||o===!1?o:o.noDJTitle),typeof o===u?o.apply(t):o))+'</span><br/>\r\n        <span class="label"></span>\r\n    </div>\r\n</div>\r\n<div id="playback-container"></div>\r\n<div id="playback-controls">\r\n    <div id="refresh-button">\r\n        <div class="button-background"></div>\r\n        <i class="icon icon-refresh-video"></i>\r\n        <div class="label">\r\n            <span>'+a((o=(o=t.playback,o==null||o===!1?o:o.refresh),typeof o===u?o.apply(t):o))+'</span>\r\n        </div>\r\n    </div>\r\n    <div id="hd-button">\r\n        <div class="button-background"></div>\r\n        <div class="label">\r\n            <span><span class="bold">HD</span>&nbsp; ON</span>\r\n        </div>\r\n        <div class="line"></div>\r\n    </div>\r\n</div>\r\n<div id="playback-buffering"></div>\r\n<div id="playback-block"></div>',s});return t.registerPartial("template_room_playback_Playback",n),n}),define("ac785/abf10/e9abd/ec35c/f802e",["underscore","backbone","swfobject","ac785/bc190/cd0b8","ac785/d94e0/c672e","ac785/d94e0/df73d","ac785/ca252/f89d8","ac785/ca252/c512b","ac785/ca252/ec425","ac785/e734f/bbe20/b1912","ac785/ab6db/ffb2a","ac785/f6dac/abcc8","ac785/f6dac/ffe62","ac785/f6dac/c1354","ac785/f6dac/aa843","ac785/f6dac/bf313","ac785/f6dac/c41ff","ac785/f6dac/d17c3","ac785/abf10/d9a0c/b2027","hbs!template/room/playback/Playback","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E=t.View.extend({id:"playback",template:b(w),initialize:function(){this.player=undefined,this.buffering=!1,this.bufferPerc=0,this.ignoreComplete=!1,this.yto=undefined,this.rnd=new p,this.visualizers=["abstract","balls","hyperspace"],this.ytFrameLoadedBind=e.bind(this.onYTFrameLoaded,this),this.scLoadingBind=e.bind(this.onSCLoading,this),this.playbackCompleteBind=e.bind(this.playbackComplete,this),this.scTimeoutBind=e.bind(this.onSCTimeout,this),this.ytOrigin="http://yt-plg.appspot.com",this.ytSource=undefined,window.addEventListener("message",e.bind(this.rx,this),!1),a.on("change:volume",this.onVolumeChange,this).on("change:media",this.onMediaChange,this).on("change:remaining",this.onRemainingChange,this).on("change:streamDisabled",this.onMediaChange,this),r.on("playback:block",this.block,this).on("playback:unblock",this.unblock,this)},render:function(){this.$el.html(this.template).mouseenter(e.bind(this.onPlaybackEnter,this)).mouseleave(e.bind(this.onPlaybackLeave,this)),this.$container=this.$("#playback-container"),this.$block=this.$("#playback-block"),this.$noDJ=this.$("#no-dj"),this.$noDJAvatar=this.$("#no-dj .avatar"),this.$noDJMessage=this.$("#no-dj .message"),this.$("#no-dj .message .label").html(w.playback.noDJLabel),this.$controls=this.$("#playback-controls"),this.$refresh=this.$("#refresh-button").click(e.bind(this.onRefreshClick,this)),this.$hd=this.$("#hd-button").click(e.bind(this.onHDClick,this)),this.$hdLabel=this.$("#hd-button .label"),this.$buffering=this.$("#playback-buffering"),this.setHD(l.settings.hdVideo),this.onVolumeChange()},block:function(){this.$block.show()},unblock:function(){this.$block.hide()},onVolumeChange:function(){var e=a.get("volume");try{var t=a.get("media");t&&t.get("format")=="2"&&this.player?this.player.setVolume(e):this.tx("setVolume="+e)}catch(n){}},onMediaChange:function(){this.reset();var t=a.get("media");if(t){this.$noDJ.hide();if(!a.get("streamDisabled")){this.ignoreComplete=!0,e.delay(e.bind(this.resetIgnoreComplete,this),1e3);var n=a.get("volume"),i=a.get("elapsed"),s=i<4?0:i;if(t.get("format")==1){this.buffering=!1,this.yto={id:t.get("cid"),volume:n,seek:s,quality:l.settings.hdVideo?"hd720":""};var o;c.isiOS?o="ytiOS2":c.isAndroid?o="yt5":o="yt",window.location.href.indexOf("pepper.plug.dj")>-1?o+="pepper":window.location.href.indexOf("sugar.plug.dj")>-1?o+="sugar":window.location.href.indexOf("http://localhost")>-1&&(o+="local");var u=$('<iframe id="yt-frame" frameborder="0" src="http://yt-plg.appspot.com/'+o+'.html"></iframe>');u.load(this.ytFrameLoadedBind),this.$container.append(u)}else if(t.get("format")==2)if(d.r)if(d.sc){this.$container.empty().append($('<iframe id="yt-frame" frameborder="0" src="/_/'+this.visualizers[this.rnd.integer(0,2)]+'"></iframe>'));var f=this;d.sc.whenStreamingReady(function(){if(t){var e=d.sc.stream(t.get("cid"),{autoPlay:!0,volume:n,position:s*1e3,whileloading:f.scLoadingBind,onfinish:f.playbackCompleteBind,ontimeout:f.scTimeoutBind});f.player=e}})}else this.$container.append($('<img src="http://soundcloud-support.s3.amazonaws.com/images/downtime.png" height="271"/>').css("position","absolute").css("left",46));else r.on("sc:ready",this.onSCReady,this)}}else this.$noDJ.show()},onSCReady:function(){r.off("sc:ready"),this.onMediaChange()},durationUpdate:function(e,t){var n=a.get("media");n&&(n.get("cid")==e&&n.set("duration",t),a.set("duration",t))},reset:function(){this.stop(),this.player=undefined,this.ytSource=undefined,this.yto=undefined,h.currentDialog instanceof y&&h.currentDialog.close()},resetIgnoreComplete:function(){this.ignoreComplete=!1},stop:function(){if(this.player&&!this.yto)try{this.player.destruct()}catch(e){}this.buffering=!1,this.$container.html("")},onPlaybackEnter:function(e){var t=a.get("media");t&&!l.settings.streamDisabled&&(t.get("format")!=1?this.$controls.addClass("no-hd"):(this.$controls.removeClass("no-hd"),l.settings.hdVideo?this.$hdLabel.html('<span><span class="bold">HD</span>&nbsp; ON</span>'):this.$hdLabel.html('<span><span class="bold">HD</span>&nbsp; OFF</span>')),this.$controls.show())},onPlaybackLeave:function(e){a.get("media")&&this.$controls.hide()},onRefreshClick:function(e){a.get("media")&&(a.get("restricted")?a.set({media:a.get("restricted"),restricted:undefined}):this.onMediaChange(),v.event("Playback","Refresh"))},onHDClick:function(e){this.setHD(!l.settings.hdVideo),v.event("Playback","HD Click")},setHD:function(e){var t=a.get("media");e?(l.settings.hdVideo=!0,t&&t.get("format")=="1"&&this.tx("setPlaybackQuality=hd720"),l.saveSettings(),this.$hdLabel.html('<span><span class="bold">HD</span>&nbsp; ON</span>'),this.$hd.removeClass("off")):(l.settings.hdVideo=!1,t&&t.get("format")=="1"&&this.tx("setPlaybackQuality=medium"),l.saveSettings(),this.$hdLabel.html('<span><span class="bold">HD</span>&nbsp; OFF</span>'),this.$hd.addClass("off"))},onSCLoading:function(){var e=~~(this.player.duration/1e3),t=a.get("elapsed");e>=t?(this.buffering=!1,this.bufferPerc=0,this.$buffering.is(":visible")&&this.$buffering.text("").hide()):(this.buffering=!0,this.bufferPerc=~~(e/t*100),this.$buffering.text(w.playback.buffering+this.bufferPerc+"%"),this.$buffering.is(":visible")||this.$buffering.show())},onSCTimeout:function(e){console.log("SCTimeout :: "+e.success+", error type = "+e.error.type)},playbackComplete:function(){this.ignoreComplete||(this.stop(),this.$container.empty().append($('<iframe id="yt-frame" frameborder="0" src="/_/'+(u.get("id")!="tastycat"?"arcs":"tcat")+'"></iframe>')))},setPlayer:function(e){this.player=e,this.onVolumeChange()},onRemainingChange:function(){var e=a.get("media");!e||e.get("format")==1||a.get("remaining")<0?this.$buffering.is(":visible")&&this.$buffering.text("").hide():!this.buffering&&this.$buffering.is(":visible")&&this.$buffering.text("").hide(),o.isTheUserPlaying&&!a.get("durationChecked")&&a.get("media")&&a.get("media").get("format")=="1"&&!a.get("restricted")&&this.player&&this.tx("durationCheck")},durationCheck:function(e){e>0&&a.set({durationChecked:!0,ytDuration:e}),a.get("durationChecked")&&e!=a.get("duration")},onYTPlayerError:function(e){(e=="100"||e=="101"||e=="150"||e=="2"||e=="0")&&r.dispatch(new s(s.SEARCH))},onYTFrameLoaded:function(e){if(this.yto){var t=document.getElementById("yt-frame").contentWindow;t.postMessage(JSON.stringify(this.yto),"http://yt-plg.appspot.com")}},rx:function(e){if(e.origin!==this.ytOrigin)return;if(e.data=="playbackReady")this.ytSource=e.source,this.ytOrigin=e.origin,this.player=!0;else if(e.data.indexOf("onPlayerError")==0)this.onYTPlayerError(e.data.split("=").pop());else if(e.data=="playbackComplete"){this.playbackComplete();if(o.isTheUserPlaying&&!a.get("durationChecked")){var t=!1;a.get("restricted")?a.get("restricted").get("duration")==0&&(t=!0):t=a.get("media")&&a.get("media").get("duration")==0,t&&r.dispatch(new i(i.SKIP))}}else e.data.indexOf("durationCheck")==0&&this.durationCheck(parseInt(e.data.split("=").pop()))},tx:function(e){this.ytSource&&this.ytSource.postMessage(e,this.ytOrigin)}});return new E}),define("ac785/abf10/e9abd/b2c4f",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/f89d8","ac785/ca252/c512b","ac785/ca252/bbd1e","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/ab6db/ffb2a","ac785/f6dac/ffe62","ac785/f6dac/c1354","ac785/abf10/e9abd/a97ff","ac785/abf10/e9abd/a812b","ac785/abf10/e9abd/fa474","ac785/abf10/e9abd/ec35c/f802e","ac785/abf10/e9abd/ea1d8/a04e5","ac785/abf10/e9abd/a6d98"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=n.View.extend({id:"room",initialize:function(){this.playback=v,this.vote=new g,this.djButton=new d,this.booth=p,this.audience=h,this.audienceArray=[],this.audienceIntervalID=0,this.avatarFrame=0,this.random=new c,this.testID=1,this.paused=!1},render:function(){return this.$el.append(this.playback.$el).append(this.djButton.$el).append(this.vote.$el).append(this.audience.$el).append(this.booth.$el),this.playback.render(),this.djButton.render(),this.vote.render(),this.audience.render(),this.booth.render(),l.resize(t.bind(this.onResize,this)),r.on("user:join",this.onUserJoin,this).on("user:leave",this.onUserLeave,this).on("audience:draw",this.drawAudience,this).on("audience:redraw",this.redraw,this).on("audience:test",this.testAddAvatar,this).on("audience:pause",this.onAudiencePause,this).on("audience:stop",this.onAnimateStop,this),i.on("reset",this.onDJUpdate,this).on("toAudience",this.onDJAudience,this),this},drawAudience:function(e){this.audienceArray=e,this.audienceIntervalID&&clearInterval(this.audienceIntervalID),this.audienceArray.length>0&&(this.audienceIntervalID=setInterval(t.bind(this.drawAudienceNext,this),100))},drawAudienceNext:function(){this.audienceArray.length>0?this.audience.addUser(this.audienceArray.shift()):(clearInterval(this.audienceIntervalID),this.onDJUpdate(),u.hasPermission(a.ADMIN)&&console.log("Audience Render Complete :: "+this.audience.gridData.userCount+" avatars"))},onDJUpdate:function(){i.length>0&&this.onUserLeave(i.at(0).get("id"))},onDJAudience:function(e){s.get("users")[e.get("id")]&&this.audience.addUser(e)},clear:function(){this.audience.clear(),this.booth.clear(),m.hide()},redraw:function(){this.clear(),this.drawAudience(o.getAudience(!1)),this.booth.onDJUpdate()},onUserJoin:function(e){this.audience.addUser(e)},onUserLeave:function(e){this.audience.removeUser(e),m.user&&m.user.get("id")==e&&m.hide()},animateAvatars:function(){f.settings.dancing&&!this.paused&&(++this.avatarFrame==11&&(this.avatarFrame=0),this.audience.frame=this.booth.frame=this.avatarFrame,this.audience.draw(),this.booth.draw())},onAudiencePause:function(e){this.paused=e},onAnimateStop:function(){this.avatarFrame=this.audience.frame=this.booth.frame=0,this.audience.draw(),this.booth.draw()},onResize:function(e){this.$el.width(e.availWidth).height(e.height-e.barHeight*2);var t=231+Math.min(50,e.bgTop+216),n=Math.round(t*(484/271));this.playback.$el.css("left",(e.availWidth-this.playback.$el.width())/2),this.playback.$container.width(n).height(t).css("left",(484-n)/2+"px"),this.playback.$noDJ.width(n).height(t).css("left",(484-n)/2+"px");var r=(t-195)/2;this.playback.$noDJAvatar.css("left",(n-this.playback.$noDJAvatar.width())/2+"px").css("top",r+"px"),this.playback.$noDJMessage.css("top",r+105),this.playback.$buffering.css("top",(t-28)/2+"px");var i=e.availWidth/2,s=e.bgTop+664,o=Math.max(0,Math.min(16,422-i));this.djButton.$el.css("left",i+o-159-this.djButton.$el.width()).css("top",s),this.vote.$el.css("left",i-o+159).css("top",s),this.audience.$el.css("left",(e.availWidth-this.audience.$el.width())/2).css("top",e.bgTop+435),this.booth.$el.css("left",(e.availWidth-this.booth.$el.width())/2).css("top",e.bgTop+576)},testAddAvatar:function(e){var t=[];e||(e=1);var n=["animal01","animal02","animal03","animal04","animal05","animal06","animal07","animal08","animal09","animal10","animal11","animal12","animal13","animal14","lucha01","lucha02","lucha03","lucha04","lucha05","lucha06","lucha07","lucha08","monster01","monster02","monster03","monster04","monster05","space01","space02","space03","space04","space05"];for(var r=0;r<e;++r){var i=this.random.integer(0,n.length-1),s=new a({id:"$_"+String(++this.testID),username:String(this.testID)+"_"+n[i],avatarID:n[i],vote:this.random.integer(0,1),listenerPoints:this.random.integer(0,1e3),djPoints:this.random.integer(0,2500),curatorPoints:this.random.integer(0,100)}),o=Math.random();o<.05?s.set("relationship",3):o<.2?s.set("relationship",2):o<.3&&s.set("relationship",1),s.set("vote",1),t.push(s)}this.drawAudience(t)}});return y}),define("hbs!template/room/settings/Settings",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="header">\n    <div class="back">\n        <i class="icon icon-back"></i>\n    </div>\n    <div class="title">\n        <i class="icon icon-settings"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.title),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n</div>\n<div class="container">\n    <div class="section">'+a((o=(o=t.settings,o==null||o===!1?o:o.performance),typeof o===u?o.apply(t):o))+'</div>\n    <div class="item s-dancing">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.dancing),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-avatar">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.avatarRollovers),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-bg">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.bgAnimations),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-fx">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.djFX),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="cap">\n        <span class="title">'+a((o=(o=t.settings,o==null||o===!1?o:o.avatarCap),typeof o===u?o.apply(t):o))+'</span>\n        <div class="counts">\n            <span class="count">1</span>\n            <span class="count">100</span>\n            <span class="count">200</span>\n            <span class="stretch"></span>\n        </div>\n        <div class="slider">\n            <div class="bar"></div>\n            <div class="circle"></div>\n            <div class="hit"></div>\n        </div>\n    </div>\n    <div class="spacer">\n        <div class="divider"></div>\n    </div>\n    <div class="section">'+a((o=(o=t.settings,o==null||o===!1?o:o.behavior),typeof o===u?o.apply(t):o))+'</div>\n    <div class="item s-av">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.audioVideo),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-tt">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.tooltips),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="spacer">\n        <div class="divider"></div>\n    </div>\n    <div class="section">'+a((o=(o=t.settings,o==null||o===!1?o:o.notifications),typeof o===u?o.apply(t):o))+'</div>\n    <div class="item s-dj">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.djAnnouncements),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-score">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.score),typeof o===u?o.apply(t):o))+'</span>\n    </div>\n    <div class="item s-fan">\n        <i class="icon icon-check-blue"></i>\n        <span>'+a((o=(o=t.settings,o==null||o===!1?o:o.fanJoin),typeof o===u?o.apply(t):o))+"</span>\n    </div>\n</div>",s});return t.registerPartial("template_room_settings_Settings",n),n}),define("ac785/abf10/e9abd/e4649/d3977",["backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/ca252/ec425","ac785/ab6db/ffb2a","ac785/f6dac/d17c3","hbs!template/room/settings/Settings","lang/Lang"],function(e,t,n,r,i,s,o,u){var a=e.View.extend({id:"settings",initialize:function(){this.backBind=_.bind(this.onBackClick,this),this.itemBind=_.bind(this.onItemClick,this),this.completeBind=_.bind(this.onComplete,this),this.startBind=_.bind(this.onStart,this),this.moveBind=_.bind(this.onUpdate,this),this.stopBind=_.bind(this.onStop,this),this.showing=!1},render:function(){return this.$el.html(o(u)),t.on("settings:show",this.show,this).on("settings:hide",this.hide,this),this.$(".s-fx").css("display","none"),this},show:function(){this.showing=!0,$("body").append(this.$el.animate({left:0},{easing:"easeInOutExpo",duration:350})),this.$(".item").on("click",this.itemBind),this.$(".back").on("click",this.backBind),this.$hit=this.$(".hit").on("mousedown",this.startBind),this.$circle=this.$(".circle"),this.max=this.$hit.width()-this.$circle.width(),this.$circle.css("left",parseInt(this.$hit.css("left"))+this.max*(i.settings.avatarcap/200)-this.$circle.width()/2),this.update()},onStart:function(e){return this.currentCap=i.settings.avatarcap,this.min=this.$hit.offset().left,t.trigger("playback:block"),$(document).on("mouseup",this.stopBind).on("mousemove",this.moveBind),this.onUpdate(e)},onUpdate:function(e){var t=Math.max(0,Math.min(1,(e.pageX-this.min)/this.max));return this.$circle.css("left",parseInt(this.$hit.css("left"))+this.max*t-this.$circle.width()/2),this.currentCap=Math.max(1,~~(200*t)),e.preventDefault(),e.stopPropagation(),!1},onStop:function(e){return t.trigger("playback:unblock"),$(document).off("mouseup",this.stopBind).off("mousemove",this.moveBind),i.settings.avatarcap=this.currentCap,i.saveSettings(),t.trigger("audience:redraw").trigger("notify","icon-user",u.messages.cap.split("%COUNT%").join(String(i.settings.avatarcap))),e.preventDefault(),e.stopPropagation(),this.currentCap=undefined,!1},hide:function(){this.showing&&(this.$el.animate({left:-this.$el.width()},{easing:"easeInOutExpo",duration:250,complete:this.completeBind}),this.$(".item").off("click",this.itemBind),this.$(".back").off("click",this.backBind),this.$hit&&(this.$hit.off("mousedown",this.startBind),this.$hit=this.$circle=this.min=this.max=undefined))},onItemClick:function(e){var o=$(e.target);if(o.is("i")||o.is("span"))o=o.parent();o.hasClass("s-avatar")?(i.settings.rollovers=!i.settings.rollovers,t.dispatch(new n(n.ALERT,u.alerts.settingsRefreshTitle,u.alerts.settingsRefreshMessage,_.bind(s.forceRefresh,s),!0))):o.hasClass("s-fx")?i.settings.djFX=!i.settings.djFX:o.hasClass("s-dancing")?(i.settings.dancing=!i.settings.dancing,t.trigger("audience:stop")):o.hasClass("s-bg")?(i.settings.bgAnim=!i.settings.bgAnim,t.dispatch(new n(n.ALERT,u.alerts.settingsRefreshTitle,u.alerts.settingsRefreshMessage,_.bind(s.forceRefresh,s),!0))):o.hasClass("s-av")?r.set("streamDisabled",!i.settings.streamDisabled):o.hasClass("s-dj")?i.settings.djAnnounce=!i.settings.djAnnounce:o.hasClass("s-fan")?i.settings.fanJoin=!i.settings.fanJoin:o.hasClass("s-score")?i.settings.score=!i.settings.score:o.hasClass("s-tt")&&(i.settings.tooltips=!i.settings.tooltips),i.saveSettings(),this.update()},update:function(){this.$(".item").removeClass("selected"),i.settings.rollovers&&this.$(".s-avatar").addClass("selected"),i.settings.djFX&&this.$(".s-fx").addClass("selected"),i.settings.dancing&&this.$(".s-dancing").addClass("selected"),i.settings.bgAnim&&this.$(".s-bg").addClass("selected"),i.settings.streamDisabled||this.$(".s-av").addClass("selected"),i.settings.djAnnounce&&this.$(".s-dj").addClass("selected"),i.settings.fanJoin&&this.$(".s-fan").addClass("selected"),i.settings.score&&this.$(".s-score").addClass("selected"),i.settings.tooltips&&this.$(".s-tt").addClass("selected")},onBackClick:function(){this.hide()},onComplete:function(){this.showing=!1,this.$el.remove()}});return a}),define("ac785/ca252/b05c8",["underscore","backbone","ac785/ca252/a1027"],function(e,t,n){var r=t.Collection.extend({model:n,sourceCollection:undefined,lastFilter:undefined,comparator:"uIndex",setSource:function(e){return this.sourceCollection&&this.sourceCollection.off("reset",this.onReset,this).off("add remove change:permission",this.onChange,this),this.sourceCollection=undefined,this.reset(),this.sourceCollection=e.on("reset",this.onReset,this).on("add remove change:permission",this.onChange,this),this.onReset(),this},onChange:function(){this.setFilter(this.lastFilter)},onReset:function(){this.setFilter()},setFilter:function(e){this.lastFilter=e;if(this.sourceCollection&&this.sourceCollection.length>0){var t;e?t=this.sourceCollection.filter(function(t){return t.get("username").toLowerCase().indexOf(e)>-1}):t=this.sourceCollection.toArray();var n=t.length;for(var r=0;r<n;++r)t[r].set("uIndex",r,{silent:!0});this.set(t).sort().trigger("update")}else this.reset().trigger("empty")}});return new r}),define("hbs!template/room/user/BannedUserRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="name">',(o=n.username)?o=o.call(t,{hash:{}}):(o=t.username,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\n<span class="timestamp">',(o=n.timestamp)?o=o.call(t,{hash:{}}):(o=t.timestamp,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\n<span class="label">',(o=n.bannedBy)?o=o.call(t,{hash:{}}):(o=t.bannedBy,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\n<span class="moderator">',(o=n.moderator)?o=o.call(t,{hash:{}}):(o=t.moderator,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\n<span class="unban">',(o=n.unban)?o=o.call(t,{hash:{}}):(o=t.unban,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>",s});return t.registerPartial("template_room_user_BannedUserRow",n),n}),define("ac785/abf10/e9abd/ea1d8/d7823",["backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/e089a","ac785/f6dac/d17c3","hbs!template/room/user/BannedUserRow","lang/Lang"],function(e,t,n,r,i,s,o){var u=e.View.extend({className:"user",events:{click:"onClick",mouseenter:"onEnter",mouseleave:"onLeave"},render:function(){return this.$el.html(s({username:this.model.get("username"),timestamp:i.convertTimestampToReadableDate(this.model.get("timestamp"),!0),moderator:this.model.get("moderator"),bannedBy:o.userList.bannedBy,unban:o.userList.unban})),this},onClick:function(){t.dispatch(new n(n.CONFIRM,o.alerts.unbanConfirm,o.alerts.unbanMessage.split("%NAME%").join(this.model.get("username")),_.bind(this.onConfirm,this)))},onEnter:function(){var e=parseInt(this.model.get("reason"));if(isNaN(e)||e<0||e>4)e=0;e=o.ban["reason"+ ++e],e||(e=o.ban.reason1),t.trigger("tooltip:show",e,this.$el,!0,!0)},onLeave:function(){t.trigger("tooltip:hide")},remove:function(){this._super(),this.off(),this.model=undefined,this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onConfirm:function(){t.dispatch(new r(r.UNBAN,this.model.get("id"),this.model.get("username")))}});return u}),define("ac785/abf10/e9abd/ea1d8/bf966",["underscore","backbone","ac785/ca252/b05c8"],function(e,t,n){var r=t.View.extend({className:"list",RowClass:undefined,collection:n,initialize:function(){this.rows=[],this.count=0},render:function(){this.collection.on("add",this.onAdd,this).on("remove",this.onRemove,this).on("update",this.verifyOrder,this).on("empty",this.clear,this)},remove:function(){this._super(),this.collection.off("add",this.onAdd,this).off("remove",this.onRemove,this).off("update",this.verifyOrder,this).off("empty",this.clear,this),this.clear(),this.off(),this.collection=undefined,this.rows=undefined,this.$el=undefined,this.el=undefined,delete this.collection,delete this.rows,delete this.$el,delete this.el},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();return this.rows.length=0,this.$el.empty(),this},onAdd:function(e,t){var n=new this.RowClass({model:e}),r=t.indexOf(e),i;r>0&&this.rows.length>0&&(i=this.rows[r-1]),i?(i.$el.after(n.$el),this.rows.splice(r,0,n)):(this.$el.prepend(n.$el),this.rows.unshift(n)),n.render()},onRemove:function(e,t,n){this.rows[n.index]&&(this.rows[n.index].remove(),this.rows.splice(n.index,1))},verifyOrder:function(){if(this.count>255)return;var e=this.rows.length;if(e>0){var t,n=-1;for(var r=0;r<e;++r){t=this.rows[r].model.get("uIndex");if(t!=r){n=r;break}}if(n>-1){var i=!1;try{t<this.rows.length&&(t==0?this.$el.prepend(this.rows[n].$el):this.rows[t].$el.before(this.rows[n].$el),this.rows.splice(t,0,this.rows.splice(n,1)[0]),i=!0)}catch(s){console.error(s)}i&&this.verifyOrder()}else this.count=0}else this.count=0}});return r}),define("ac785/abf10/e9abd/ea1d8/da9e0",["ac785/abf10/e9abd/ea1d8/d7823","ac785/abf10/e9abd/ea1d8/bf966"],function(e,t){var n=t.extend({className:"list bans",RowClass:e});return n}),define("hbs!template/room/user/RoomUserRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='<i class="icon icon-chat-',(i=n.rank)?i=i.call(e,{hash:{}}):(i=e.rank,i=typeof i===u?i.apply(e):i),r+=a(i)+'"></i>',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression,f=this;o=n["if"].call(t,t.rank,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;return s+='\n<span class="name">',(o=n.username)?o=o.call(t,{hash:{}}):(o=t.username,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>",s});return t.registerPartial("template_room_user_RoomUserRow",n),n}),define("ac785/abf10/e9abd/ea1d8/cc098",["jquery","backbone","ac785/bc190/cd0b8","ac785/d94e0/a2e23","ac785/ca252/fae6c","ac785/ca252/a1027","hbs!template/room/user/RoomUserRow"],function(e,t,n,r,i,s,o){var u=t.View.extend({events:{click:"onClick"},render:function(){return this.draw(),this.model.on("change:permission",this.draw,this).on("change:username",this.update,this).on("change:vote change:curated",this.vote,this),this},remove:function(){this._super(),this.off(),this.model.off("change:permission",this.draw,this).off("change:username",this.update,this).off("change:vote change:curated",this.vote,this),this.$icon&&this.$icon.remove(),this.$icon=undefined,this.model=undefined,this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onClick:function(){n.dispatch(new r(r.SHOW,this.model,{x:e("#user-lists").offset().left,y:this.$el.offset().top+7},!0))},draw:function(){this.$el.removeClass().addClass("user");var e={username:this.model.get("username")},t=this.model.get("permission");t==s.DJ?e.rank="dj":t==s.BOUNCER?e.rank="bouncer":t==s.MANAGER?e.rank="manager":t==s.COHOST?e.rank="cohost":t==s.HOST?e.rank="host":t==s.VOLUNTEER?e.rank="volunteer":t==s.AMBASSADOR?e.rank="ambassador":t==s.LEADER?e.rank="leader":t==s.ADMIN&&(e.rank="admin"),t==s.DJ?this.$el.addClass("is-dj"):t>s.DJ&&t<s.VOLUNTEER?this.$el.addClass("is-staff"):t>=s.VOLUNTEER&&t<s.ADMIN?this.$el.addClass("is-ambassador"):t==s.ADMIN?this.$el.addClass("is-admin"):this.model.get("id")==i.get("id")&&this.$el.addClass("is-you"),this.$el.html(o(e)),this.vote()},update:function(){this.$(".name").text(this.model.get("username"))},vote:function(){this.model.get("curated")||this.model.get("vote")==1?(this.$icon||(this.$icon=e("<i/>").addClass("icon"),this.$el.append(this.$icon)),this.model.get("curated")?this.$icon.removeClass().addClass("icon icon-curate"):this.$icon.removeClass().addClass("icon icon-woot")):this.$icon&&(this.$icon.remove(),this.$icon=undefined)}});return u}),define("ac785/abf10/e9abd/ea1d8/af50c",["ac785/abf10/e9abd/ea1d8/cc098","ac785/abf10/e9abd/ea1d8/bf966"],function(e,t){var n=t.extend({className:"list room",RowClass:e});return n}),define("hbs!template/room/user/UserLists",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="header">\n    <div class="button room">\n        <i class="icon icon-users"></i>\n    </div>\n    <div class="button staff">\n        <i class="icon icon-staff"></i>\n    </div>\n    <div class="button bans">\n        <i class="icon icon-ban"></i>\n    </div>\n    <div class="divider left"></div>\n    <div class="divider right"></div>\n</div>\n<div class="list-header">\n    <span class="title"></span>\n    <span class="count"></span>\n    <div class="input-background">\n        <input id="user-filter-input" type="text" maxlength="10" placeholder="'+a((o=(o=t.userList,o==null||o===!1?o:o.filter),typeof o===u?o.apply(t):o))+'" data-placeholder="'+a((o=(o=t.userList,o==null||o===!1?o:o.filter),typeof o===u?o.apply(t):o))+'"/>\n    </div>\n    <div class="clear-filter">\n        <i class="icon icon-clear-input"></i>\n    </div>\n</div>',s});return t.registerPartial("template_room_user_UserLists",n),n}),define("ac785/abf10/e9abd/ea1d8/b613b",["underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/a7d9d","ac785/ca252/ccfb5","ac785/ca252/b05c8","ac785/ca252/b61cf","ac785/ca252/fae6c","ac785/ca252/bed74","ac785/ca252/a1027","ac785/f6dac/ffe62","ac785/f6dac/ae2d1","ac785/abf10/e9abd/ea1d8/da9e0","ac785/abf10/e9abd/ea1d8/b0928","ac785/abf10/e9abd/ea1d8/af50c","hbs!template/room/user/UserLists","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=t.View.extend({id:"user-lists",initialize:function(){this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.html(v(m)),this.$title=this.$(".list-header .title"),this.$count=this.$(".list-header .count"),this.$filterInput=this.$("#user-filter-input").keyup(e.bind(this.onKeyUp,this)).focus(e.bind(this.onFocus,this)).blur(e.bind(this.onBlur,this)),this.filterInput=this.$filterInput[0],this.$clearFilter=this.$(".clear-filter").click(e.bind(this.onClearFilterClick,this)),this.$roomButton=this.$(".button.room").on("click",e.bind(this.onRoomClick,this)).on("mouseenter",e.bind(this.onRoomEnter,this)),this.$staffButton=this.$(".button.staff").on("click",e.bind(this.onStaffClick,this)).on("mouseenter",e.bind(this.onStaffEnter,this)),this.$bansButton=this.$(".button.bans").on("click",e.bind(this.onBansClick,this)).on("mouseenter",e.bind(this.onBansEnter,this)),this.$(".button").on("mouseleave",e.bind(this.onHideTooltip,this)),n.on("show:users",this.show,this).on("show:chat show:waitlist",this.hide,this).on("mod:ban",this.onModBan,this),u.on("change:permission",this.checkBanPermission,this),s.on("empty",this.onEmpty,this),this},show:function(){this.$el.show(),this.checkBanPermission(),this.onRoomClick(),l.resize(this.resizeBind)},hide:function(){this.$el.hide(),this.listView&&(this.listView.remove(),this.listView=undefined),s.sourceCollection&&s.sourceCollection.off("add remove reset",this.onCollectionUpdate,this),s.reset(),l.off("resize",this.resizeBind)},checkBanPermission:function(){u.hasPermission(f.MANAGER)?this.$(".button.bans").show():this.$(".button.bans").hide()},onResize:function(e){e=e||l.getSize(),this.$el.height(e.height-e.barHeight*2).css("left",e.availWidth),this.listView&&this.listView.$el&&this.listView.$el.height(e.height-e.barHeight-this.listView.$el.offset().top)},onCollectionUpdate:function(e){this.$count.text(e.length)},onEmpty:function(){this.$count.text(0)},setMode:function(e){this.mode=e,this.listView&&(this.listView.remove(),this.listView=undefined),this.$(".button").removeClass("selected"),this.$(".button."+e).addClass("selected"),this.$count.text(""),this.filterInput.value="",this.$clearFilter.hide(),s.sourceCollection&&s.sourceCollection.off("add remove reset",this.onCollectionUpdate,this)},onModBan:function(){this.mode=="bans"&&n.dispatch(new r(r.BANS))},onRoomClick:function(){this.setMode("room"),this.$title.text(m.userList.roomTitle),this.listView=new d,this.$el.append(this.listView.$el),this.listView.render(),s.setSource(a),this.onResize()},onStaffClick:function(){this.mode!="staff"&&(this.setMode("staff"),this.$title.text(m.userList.staffTitle),this.listView=new p,this.$el.append(this.listView.$el),this.listView.render(),n.dispatch(new r(r.STAFF)),this.onResize())},onBansClick:function(){u.hasPermission(f.MANAGER)&&this.mode!="bans"&&(this.setMode("bans"),this.$title.text(m.userList.bannedTitle),this.listView=new h,this.$el.append(this.listView.$el),this.listView.render(),s.setSource(i.on("add remove reset",this.onCollectionUpdate,this)),n.dispatch(new r(r.BANS)),this.onResize())},onRoomEnter:function(){n.trigger("tooltip:show",m.tooltips.usersRoom,this.$roomButton,!0)},onStaffEnter:function(){n.trigger("tooltip:show",m.tooltips.usersStaff,this.$staffButton,!0)},onBansEnter:function(){n.trigger("tooltip:show",m.tooltips.usersBans,this.$bansButton,!0)},onHideTooltip:function(){n.trigger("tooltip:hide")},onFocus:function(){this.filterInput.placeholder=""},onBlur:function(){this.filterInput.placeholder=m.userList.filter},onKeyUp:function(e){var t;return e?(t=e.which||e.keyCode,t==27&&(this.filterInput.value=""),this.mode!="staff"?s.setFilter(this.filterInput.value.toLowerCase()):o.setFilter(this.filterInput.value.toLowerCase()),this.filterInput.value.length>0?this.$clearFilter.show():this.$clearFilter.hide(),!0):!0},onClearFilterClick:function(){this.filterInput.value="",this.$clearFilter.hide(),this.mode!="staff"?s.setFilter():o.setFilter()}});return g}),define("hbs!template/room/user/WaitListRow",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<i class="icon icon-drag-handle"></i>\n<div class="meta">\n    <span class="position"></span>\n    <span class="name">',(o=n.username)?o=o.call(t,{hash:{}}):(o=t.username,o=typeof o===u?o.apply(t):o),s+=a(o)+'</span>\n</div>\n<i class="icon icon-move-to-top"></i>\n<i class="icon icon-waitlist-remove"></i>',s});return t.registerPartial("template_room_user_WaitListRow",n),n}),define("ac785/abf10/e9abd/ea1d8/b7c61",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/d94e0/fb1a1","ac785/d94e0/e089a","ac785/d94e0/a2e23","ac785/ca252/fae6c","ac785/e734f/aa464/b32f7","ac785/f6dac/bf313","hbs!template/room/user/WaitListRow","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({className:"user",initialize:function(){this.clickBind=t.bind(this.onDJClick,this),this.topBind=t.bind(this.onTopClick,this),this.removeBind=t.bind(this.onRemoveClick,this)},render:function(){return this.$el.html(l({username:this.model.get("username")})),this.$position=this.$(".position"),this.$username=this.$(".name"),this.$top=this.$(".icon-move-to-top"),this.$remove=this.$(".icon-waitlist-remove").on("click",this.removeBind),this.model.on("change:wlIndex",this.onIndex,this).on("change:username",this.onUsername,this),this.model.get("id")==u.get("id")?this.$el.addClass("is-you"):this.$el.removeClass("is-you"),this.onIndex(),this},onIndex:function(){var e=this.model.get("wlIndex");this.$el.attr("data-uid",this.model.get("id")),this.$position.text(e+1),e<1?(this.$el.addClass("locked"),this.$top.off("click",this.topBind)):(this.$el.removeClass("locked").off("click",this.clickBind),this.$top.on("click",this.topBind))},onUsername:function(){this.$name.text(this.model.get("username"))},onDJClick:function(){r.dispatch(new o(o.SHOW,this.model,{x:e("#waitlist").offset().left,y:this.$el.offset().top+11}))},onTopClick:function(){new a(this.model.get("id"),1)},onRemoveClick:function(){r.dispatch(new i(i.CONFIRM,c.alerts.removeDJConfirm,c.alerts.removeDJMessage.split("%NAME%").join(this.model.get("username")),t.bind(this.onConfirm,this)))},onConfirm:function(){f.event("Moderation","Remove DJ"),r.dispatch(new s(s.REMOVE_DJ,this.model.get("id")))},remove:function(){this._super(),this.off(),this.$el.off(),this.$top.off(),this.$remove.off(),this.model.off("change:wlIndex",this.onIndex,this).off("change:username",this.onUsername,this),this.$position=undefined,this.$username=undefined,this.$top=undefined,this.$remove=undefined,this.options=undefined,this.model=undefined,this.$el=undefined,this.el=undefined,this.clickBind=undefined,this.topBind=undefined,this.removeBind=undefined,delete this.$el,delete this.el}});return h}),define("hbs!template/room/user/WaitList",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="header">\n    <span class="title">'+a((o=(o=t.userList,o==null||o===!1?o:o.waitlist),typeof o===u?o.apply(t):o))+'</span>\n    <div class="position">\n        <span class="current"></span><span class="count"></span>\n    </div>\n    <div class="divider"></div>\n</div>\n<div class="list"></div>',s});return t.registerPartial("template_room_user_WaitList",n),n}),define("ac785/abf10/e9abd/ea1d8/f2efb",["jquery-sortable","underscore","backbone","ac785/bc190/cd0b8","ac785/ca252/ab49c","ac785/ca252/c512b","ac785/ca252/fae6c","ac785/ca252/a1027","ac785/e734f/aa464/b32f7","ac785/f6dac/ffe62","ac785/abf10/e9abd/ea1d8/b7c61","hbs!template/room/user/WaitList","lang/Lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({id:"waitlist",initialize:function(){this.rows=[],this.drawBind=t.bind(this.drawRow,this),this.resizeBind=t.bind(this.onResize,this),this.enableBind=t.bind(this.enableSort,this),this.startBind=t.bind(this.onDragStart,this),this.moveBind=t.bind(this.onDragMove,this),this.endBind=t.bind(this.onDragEnd,this),this.sortBind=t.bind(this.onSortUpdate,this),this.mouseBind=t.bind(this.onMouseCheck,this),this.dragIntervalID=0,this.mouseX=undefined,this.mouseY=undefined,this.count=0},render:function(){return this.$el.html(c(h)),this.$count=this.$(".position .count"),this.$current=this.$(".position .current"),this.$list=this.$(".list"),this.$title=this.$(".header .title"),r.on("show:waitlist",this.show,this).on("show:chat show:users",this.hide,this),s.on("change:boothLocked",this.onLockChange,this),this.onLockChange(),this},enableSort:function(){this.$list.sortable("destroy").off(),this.$list.hasClass("manager")&&i.length>1&&this.$list.sortable({forcePlaceholderSize:!0,handle:".icon-drag-handle .meta",items:".user"}).on("dragstart",this.startBind).on("dragmove",this.moveBind).on("dragend",this.endBind).on("sortupdate",this.sortBind)},onDragStart:function(){clearInterval(this.dragIntervalID),this.dragIntervalID=setInterval(this.mouseBind,20)},onDragMove:function(e,t){this.mouseX=t.pageX,this.mouseY=t.pageY},onDragEnd:function(){clearInterval(this.dragIntervalID)},onSortUpdate:function(e,t){var n;try{n=t.item[0].dataset.uid}catch(e){}n&&new a(n,t.newIndex+1)},onMouseCheck:function(){var e=this.$list.offset().top+20,t=this.$list.offset().left+10,n=t+this.$list.width()-5,r=this.$list.scrollTop(),i=this.$list.height()-40,s,o;this.mouseX>=t&&this.mouseX<=n&&(this.mouseY<e?(s=(e-this.mouseY)/1.25,o=Math.max(0,r-s),this.$list.scrollTop(o)):this.mouseY>e+i&&(s=(this.mouseY-(e+i))/1.25,o=Math.min(r+s,this.$list[0].scrollHeight-i),this.$list.scrollTop(o)))},onLockChange:function(){var e=s.get("boothLocked");this.$title.text(e?h.userList.waitlistLocked:h.userList.waitlist);var t=!1;o.hasPermission(u.MANAGER)?t=!0:o.hasPermission(u.BOUNCER)&&(t=!e),t?this.$list.hasClass("bouncer")||this.$list.addClass("bouncer"):this.$list.removeClass("bouncer")},show:function(){this.draw(),this.$el.show(),f.resize(this.resizeBind),i.on("add",this.onAdd,this).on("remove",this.onRemove,this).on("update",this.onUpdate,this),o.on("change:permission",this.onPermissionChange,this),t.defer(this.enableBind)},hide:function(){i.off("add",this.onAdd,this).off("remove",this.onRemove,this).off("update",this.onUpdate,this),o.off("change:permission",this.onPermissionChange,this),f.off("resize",this.resizeBind),this.clear(),this.$el.hide()},updateCount:function(){var e=i.getUserPosition();e>-1?(this.$current.text(e+1),i.length>0?this.$count.text(" / "+i.length):this.$count.empty()):(this.$current.text(i.length),this.$count.empty())},onPermissionChange:function(){i.length>1?this.$list.removeClass("single"):this.$list.addClass("single"),o.hasPermission(u.BOUNCER)?o.hasPermission(u.MANAGER)&&(this.$list.hasClass("manager")||(this.$list.addClass("manager"),this.enableSort())):this.$list.removeClass("manager").removeClass("bouncer"),this.onLockChange()},onResize:function(e){this.$el.height(e.height-e.barHeight*2).css("left",e.availWidth),this.$list.height(e.height-e.barHeight-this.$list.offset().top)},clear:function(){var e=this.rows.length;while(e--)this.rows[e].remove();return this.rows.length=0,this.$list.sortable("destroy"),this.$list.empty(),this},draw:function(){this.clear(),i.length>0&&(i.each(this.drawBind),this.onPermissionChange()),this.updateCount()},drawRow:function(e){var t=new l({model:e});this.$list.append(t.$el),this.rows.push(t),t.render()},onAdd:function(e,t){var n=new l({model:e}),r=t.indexOf(e),i;r>0&&this.rows.length>0&&(i=this.rows[r-1]),i?(i.$el.after(n.$el),this.rows.splice(r,0,n)):(this.$list.prepend(n.$el),this.rows.unshift(n)),n.render()},onRemove:function(e,t,n){this.rows[n.index].remove(),this.rows.splice(n.index,1)},onUpdate:function(){this.updateCount(),this.verifyOrder(),this.onPermissionChange(),t.defer(this.enableBind)},verifyOrder:function(){if(this.count>255)return;var e=this.rows.length;if(e>0){var t,n=-1;for(var r=0;r<e;++r){t=this.rows[r].model.get("wlIndex");if(t!=r){n=r;break}}if(n>-1){var i=!1;try{t<this.rows.length&&(t==0?this.$el.prepend(this.rows[n].$el):this.rows[t].$el.after(this.rows[n].$el),this.rows.splice(t,0,this.rows.splice(n,1)[0]),i=!0)}catch(s){console.error(s)}i&&this.verifyOrder()}else this.count=0}else this.count=0}});return p}),define("hbs!template/store/Header",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<span class="title">'+a((o=(o=t.store,o==null||o===!1?o:o.header),typeof o===u?o.apply(t):o))+'</span>\n<div class="line"></div>',s});return t.registerPartial("template_store_Header",n),n}),define("ac785/abf10/ab6db/e21b7",["backbone","hbs!template/store/Header","lang/Lang"],function(e,t,n){var r=e.View.extend({className:"header",render:function(){return this.$el.html(t(n)),this}});return r}),define("hbs!template/store/Avatar",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="bg"></div>\n<i class="avi avi-',(o=n.id)?o=o.call(t,{hash:{}}):(o=t.id,o=typeof o===u?o.apply(t):o),s+=a(o)+'"></i>\n<div class="state">\n</div>',s});return t.registerPartial("template_store_Avatar",n),n}),define("ac785/abf10/ab6db/d077a",["backbone","ac785/bc190/cd0b8","ac785/d94e0/a461e","hbs!template/store/Avatar"],function(e,t,n,r){var i=e.View.extend({className:"avatar",events:{mouseup:"onRelease"},initialize:function(){this.model.on("change:available change:selected",this.onChange,this)},render:function(){return this.$el.html(r(this.model.toJSON())),this.onChange(this.model),this},onChange:function(e){e.get("selected")?(this.$el.addClass("selected").removeClass("available"),this.$(".state").html('<i class="icon icon-store-unlocked"></i>')):(this.$el.removeClass("selected"),e.get("available")?(this.$el.addClass("available"),this.$(".state").empty()):(this.$el.removeClass("available"),this.$(".state").html('<i class="icon icon-locked"></i>')))},remove:function(){this._super(),this.model&&(this.model.off("change",this.onChange,this),this.model=undefined),this.off(),this.$el=undefined,this.el=undefined,delete this.$el,delete this.el},onRelease:function(){this.model.get("available")&&!this.model.get("selected")&&t.dispatch(new n(n.CHANGE,this.model.get("id")))}});return i}),define("hbs!template/store/Title",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers);var s="",o,u="function",a=this.escapeExpression;return s+='<div class="title">\n    <span>',(o=n.points)?o=o.call(t,{hash:{}}):(o=t.points,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\n</div>",s});return t.registerPartial("template_store_Title",n),n}),define("ac785/abf10/ab6db/fd054",["underscore","backbone","ac785/ca252/a9a95","ac785/abf10/ab6db/d077a","hbs!template/store/Title","lang/Lang"],function(e,t,n,r,i,s){var o=t.View.extend({className:"shop",initialize:function(){this.$container=$("<div/>").addClass("container"),this.drawBind=e.bind(this.onDrawItem,this),this.last=undefined},getTitle:function(e){return i({points:s.store.points.replace("%RANGE%",e)})},getAvatar:function(e){return new r({model:e})},render:function(){return this.$el.append(this.$container),n.each(this.drawBind),this},onDrawItem:function(e){var t=e.get("required");t!=this.last&&(this.$container.append(this.getTitle(t)),this.last=t);var n=this.getAvatar(e);this.$container.append(n.$el),n.render()}});return o}),define("ac785/abf10/ab6db/b0fbc",["underscore","backbone","ac785/bc190/cd0b8","ac785/f6dac/ffe62","ac785/abf10/ab6db/e21b7","ac785/abf10/ab6db/fd054"],function(e,t,n,r,i,s){var o=t.View.extend({id:"store",className:"left-meta",initialize:function(){this.header=new i,this.shop=new s,this.resizeBind=e.bind(this.onResize,this)},render:function(){return this.$el.append(this.header.$el).append(this.shop.$el),this.header.render(),this.shop.render(),r.resize(this.resizeBind),n.on("store:show",this.show,this).on("store:hide",this.hide,this),this.$el.on("scroll",function(){var e=$(this).scrollTop();e>0?($("#store .header").css("position")=="relative"&&$("#store .header").css("position","absolute"),$("#store .header").css("top",e)):$("#store .header").css("position")=="absolute"&&$("#store .header").css("position","relative").css("top","auto")}),this},show:function(){this.$el.is(":visible")||(this.$el.show().scrollTop(0).animate({left:0},250,"easeInOutExpo"),n.trigger("audience:pause",!0))},hide:function(){this.$el.animate({left:-this.$el.width()},250,"easeInOutExpo"),setTimeout(function(){$("#store").hide()},250),n.trigger("audience:pause",!1)},onResize:function(e){this.$el.height(e.height),this.$el.is(":visible")?this.$el.css("left",0):this.$el.css("left",-this.$el.width())}});return o}),define("ac785/abf10/cd14f/e3f7e",["jquery","underscore","backbone","ac785/bc190/cd0b8","ac785/ab6db/ffb2a"],function(e,t,n,r,i){var s=n.View.extend({id:"tooltip",initialize:function(){this.$span=e("<span/>")},render:function(){return this.$el.append(this.$span).append(e("<div/>").addClass("corner")),r.on("tooltip:show",this.show,this).on("tooltip:hide",this.hide,this),this},show:function(t,n,r,s,o){if(i.settings.tooltips||s)o?this.$el.addClass(o):this.$el.removeClass(),this.$span.text(t),e("body").append(this.$el),this.right=r,r?this.$el.addClass("right"):this.$el.removeClass("right"),this.$el.css("top",Math.max(0,n.offset().top-this.$el.height()-15)).css("left",n.offset().left+n.width()/2-(this.right?this.$el.width():0))},hide:function(){this.$span.text(""),this.$el.remove()}});return s}),define("hbs!template/room/RoomBody",["hbs","handlebars"],function(e,t){var n=t.template(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),'<div id="fb-root"></div>\r\n<div id="chat-sound"></div>'});return t.registerPartial("template_room_RoomBody",n),n}),define("ac785/abf10/e9abd/c5ea0",["jquery","underscore","backbone","ac785/f6dac/ffe62","ac785/abf10/d9a0c/eed0c","ac785/abf10/e9abd/eccfb/b59f0","ac785/abf10/e9abd/abc95/fbf80","ac785/abf10/e9abd/feb9f/bbd15","ac785/abf10/e9abd/feb9f/e4737","ac785/abf10/feed7/c3297","ac785/abf10/e9abd/df21d/f56c2","ac785/abf10/e9abd/ea1d8/a04e5","ac785/abf10/e9abd/a0d39","ac785/abf10/e9abd/b2c4f","ac785/abf10/e9abd/e4649/d3977","ac785/abf10/e9abd/ea1d8/b613b","ac785/abf10/e9abd/ea1d8/f2efb","ac785/abf10/ab6db/b0fbc","ac785/abf10/cd14f/e3f7e","hbs!template/room/RoomBody"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){var w=n.View.extend({el:"body",initialize:function(){this.chat=new s,this.userLists=new v,this.waitlist=new m,this.footer=new o,this.header=new u,this.room=new p,this.info=new a,this.lobby=new f,this.dialog=new i,this.store=new g,this.notifications=new l,this.settings=new d,this.tooltip=new y},render:function(){return this.$el.html(b()).append(this.header.$el).append(this.room.$el).append(this.info.$el).append(this.chat.$el).append(this.userLists.$el).append(this.waitlist.$el).append(this.footer.$el).append(this.notifications.$el).append(this.store.$el).append(this.dialog.$el),this.header.render(),this.room.render(),this.info.render(),this.lobby.render(),this.chat.render(),this.userLists.render(),this.waitlist.render(),this.footer.render(),this.notifications.render(),this.store.render(),this.dialog.render(),this.settings.render(),this.tooltip.render(),h.render(),c.render(),h.show(),r.resize(t.bind(this.onResize,this)),this},onResize:function(t){this.$el.css("overflow",t.width<=r.MIN_WIDTH||t.height<=r.MIN_HEIGHT?"auto":"hidden").css("background-position",(t.availWidth-1600)/2+"px  "+t.bgTop+"px"),e(".avail-width").width(t.width),e(".left-meta").width(t.availWidth),this.notifications.$el.css("left",t.availWidth-this.notifications.$el.width()-10),this.footer.$el.css("top",t.height-t.barHeight)}});return w}),function(e){e.easing.jswing=e.easing.swing,e.fn.extend(e.easing,{def:"easeInOutExpo",swing:function(t,n,r,i,s){return e.easing[e.easing.def](t,n,r,i,s)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;o||(o=i*.3*1.5);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return t<1?-0.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n:u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),(t/=i/2)<1?r/2*t*t*(((s*=1.525)+1)*t-s)+n:r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(t,n,r,i,s){return i-e.easing.easeOutBounce(t,s-n,0,i,s)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,i,s){return n<s/2?e.easing.easeInBounce(t,n*2,0,i,s)*.5+r:e.easing.easeOutBounce(t,n*2-s,0,i,s)*.5+i*.5+r}})}(jQuery),define("jquery-easing",["jquery"],function(e){return function(){var t,n;return t||e.$}}(this)),require(["jquery","underscore","backbone","ac785/bc190/b96e1","ac785/bc190/cd0b8","ac785/a53b0/e583a","ac785/c3562/f9d8b","ac785/abf10/e9abd/c5ea0","ac785/f6dac/aa843","jquery-easing"],function(e,t,n,r,i,s,o,u,a,f){if(window.location.href.indexOf("www.plug.dj")==-1){var l=new u;l.render(),a.g(),o.connect(0);var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,h=0,p,d=83;function v(e){e-h>d&&(h=e,l.room.animateAvatars()),c(v)}function m(){c?(c(v),p="raf"):p=setInterval(t.bind(l.room.animateAvatars,l.room),d+1)}m()}else window.location.href="http://plug.dj/"+window.location.href.split("plug.dj/").pop()}),define("room",function(){});